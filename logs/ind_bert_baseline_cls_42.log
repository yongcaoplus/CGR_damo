gn06 0
/ceph/hpc/data/d2023d06-049-users/cgr/output/ind_bert_baseline_cls_seed_42_bs_32
2023-07-10 16:09:55,983 Begins
2023-07-10 16:09:56,025 ------------------------------
2023-07-10 16:09:56,025 text_encoder: bert-base-chinese
2023-07-10 16:09:56,025 output_dir: /ceph/hpc/data/d2023d06-049-users/cgr/output/ind_bert_baseline_cls_seed_42_bs_32
2023-07-10 16:09:56,025 exper_mode: baseline_cls
2023-07-10 16:09:56,025 batch_size_train: 32
2023-07-10 16:09:56,025 batch_size_test: 16
2023-07-10 16:09:56,025 early_stop_thresh: 3
2023-07-10 16:09:56,025 train_file: data/industry/train.jsonl
2023-07-10 16:09:56,025 val_file: data/industry/dev.jsonl
2023-07-10 16:09:56,025 test_file: data/industry/test.jsonl
2023-07-10 16:09:56,025 ------------------------------
2023-07-10 16:09:56,555 | distributed init (rank 0): env://
2023-07-10 16:09:56,556 Added key: store_based_barrier_key:1 to store for rank: 0
2023-07-10 16:09:56,556 Rank 0: Completed store-based barrier for key:store_based_barrier_key:1 with 1 nodes.
2023-07-10 16:09:58,718 Creating Chinese re-ranking dataset
2023-07-10 16:09:59,107 train size: 7359
2023-07-10 16:09:59,165 val size: 2453
2023-07-10 16:09:59,352 test size: 2469
2023-07-10 16:09:59,352 Finished reading dataset.
/ceph/hpc/home/eujongc/anaconda3/envs/latentops/lib/python3.9/site-packages/torch/utils/data/dataloader.py:554: UserWarning: This DataLoader will create 4 worker processes in total. Our suggested max number of worker in current system is 2, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(_create_warning_msg(
2023-07-10 16:09:59,953 Creating model
Some weights of the model checkpoint at bert-base-chinese were not used when initializing BertModel: ['cls.predictions.transform.dense.bias', 'cls.seq_relationship.bias', 'cls.predictions.transform.LayerNorm.weight', 'cls.predictions.bias', 'cls.predictions.transform.LayerNorm.bias', 'bert.pooler.dense.weight', 'cls.predictions.transform.dense.weight', 'bert.pooler.dense.bias', 'cls.predictions.decoder.weight', 'cls.seq_relationship.weight']
- This IS expected if you are initializing BertModel from the checkpoint of a model trained on another task or with another architecture (e.g. initializing a BertForSequenceClassification model from a BertForPreTraining model).
- This IS NOT expected if you are initializing BertModel from the checkpoint of a model that you expect to be exactly identical (initializing a BertForSequenceClassification model from a BertForSequenceClassification model).
2023-07-10 16:10:02,925 =========> We are on baseline_cls mode!
2023-07-10 16:10:02,926 {'Total': 102070784, 'Trainable': 102070784}
2023-07-10 16:10:02,989 Start training
Train Epoch: [0]  [  0/229]  eta: 0:18:45  lr: 0.000050  loss: 4.7922  time: 4.9160  data: 2.5578  max mem: 21216
2023-07-10 16:10:08,006 Reducer buckets have been rebuilt in this iteration.
Train Epoch: [0]  [ 50/229]  eta: 0:03:38  lr: 0.000050  loss: 2.9942  time: 1.1432  data: 0.0001  max mem: 30101
Train Epoch: [0]  [100/229]  eta: 0:02:31  lr: 0.000050  loss: 2.8721  time: 1.1387  data: 0.0001  max mem: 30242
Train Epoch: [0]  [150/229]  eta: 0:01:30  lr: 0.000050  loss: 2.6936  time: 1.0733  data: 0.0001  max mem: 30242
Train Epoch: [0]  [200/229]  eta: 0:00:33  lr: 0.000050  loss: 2.3200  time: 1.1275  data: 0.0001  max mem: 30242
Train Epoch: [0]  [228/229]  eta: 0:00:01  lr: 0.000050  loss: 1.9346  time: 1.1200  data: 0.0001  max mem: 30242
2023-07-10 16:14:22,948 Train Epoch: [0] Total time: 0:04:19 (1.1352 s / it)
2023-07-10 16:14:22,952 Computing features for evaluation...
  0%|          | 0/154 [00:00<?, ?it/s]  1%|          | 1/154 [00:00<00:51,  2.98it/s]  1%|▏         | 2/154 [00:00<00:39,  3.86it/s]  2%|▏         | 3/154 [00:00<00:36,  4.19it/s]  3%|▎         | 4/154 [00:00<00:34,  4.41it/s]  3%|▎         | 5/154 [00:01<00:34,  4.36it/s]  4%|▍         | 6/154 [00:01<00:32,  4.54it/s]  5%|▍         | 7/154 [00:01<00:30,  4.79it/s]  5%|▌         | 8/154 [00:01<00:31,  4.68it/s]  6%|▌         | 9/154 [00:02<00:31,  4.60it/s]  6%|▋         | 10/154 [00:02<00:30,  4.71it/s]  7%|▋         | 11/154 [00:02<00:31,  4.53it/s]  8%|▊         | 12/154 [00:02<00:31,  4.51it/s]  8%|▊         | 13/154 [00:02<00:30,  4.56it/s]  9%|▉         | 14/154 [00:03<00:31,  4.51it/s] 10%|▉         | 15/154 [00:03<00:30,  4.54it/s] 10%|█         | 16/154 [00:03<00:29,  4.73it/s] 11%|█         | 17/154 [00:03<00:29,  4.70it/s] 12%|█▏        | 18/154 [00:03<00:29,  4.69it/s] 12%|█▏        | 19/154 [00:04<00:30,  4.49it/s] 13%|█▎        | 20/154 [00:04<00:29,  4.48it/s] 14%|█▎        | 21/154 [00:04<00:28,  4.68it/s] 14%|█▍        | 22/154 [00:04<00:27,  4.81it/s] 15%|█▍        | 23/154 [00:05<00:26,  4.86it/s] 16%|█▌        | 24/154 [00:05<00:27,  4.81it/s] 16%|█▌        | 25/154 [00:05<00:27,  4.78it/s] 17%|█▋        | 26/154 [00:05<00:27,  4.73it/s] 18%|█▊        | 27/154 [00:05<00:26,  4.81it/s] 18%|█▊        | 28/154 [00:06<00:26,  4.70it/s] 19%|█▉        | 29/154 [00:06<00:26,  4.77it/s] 19%|█▉        | 30/154 [00:06<00:25,  4.83it/s] 20%|██        | 31/154 [00:06<00:25,  4.77it/s] 21%|██        | 32/154 [00:06<00:25,  4.82it/s] 21%|██▏       | 33/154 [00:07<00:25,  4.77it/s] 22%|██▏       | 34/154 [00:07<00:25,  4.65it/s] 23%|██▎       | 35/154 [00:07<00:25,  4.72it/s] 23%|██▎       | 36/154 [00:07<00:25,  4.70it/s] 24%|██▍       | 37/154 [00:08<00:25,  4.66it/s] 25%|██▍       | 38/154 [00:08<00:24,  4.72it/s] 25%|██▌       | 39/154 [00:08<00:24,  4.79it/s] 26%|██▌       | 40/154 [00:08<00:23,  4.76it/s] 27%|██▋       | 41/154 [00:08<00:24,  4.57it/s] 27%|██▋       | 42/154 [00:09<00:24,  4.52it/s] 28%|██▊       | 43/154 [00:09<00:24,  4.50it/s] 29%|██▊       | 44/154 [00:09<00:23,  4.71it/s] 29%|██▉       | 45/154 [00:09<00:23,  4.61it/s] 30%|██▉       | 46/154 [00:09<00:22,  4.73it/s] 31%|███       | 47/154 [00:10<00:22,  4.71it/s] 31%|███       | 48/154 [00:10<00:22,  4.75it/s] 32%|███▏      | 49/154 [00:10<00:22,  4.72it/s] 32%|███▏      | 50/154 [00:10<00:22,  4.63it/s] 33%|███▎      | 51/154 [00:10<00:21,  4.71it/s] 34%|███▍      | 52/154 [00:11<00:22,  4.60it/s] 34%|███▍      | 53/154 [00:11<00:22,  4.57it/s] 35%|███▌      | 54/154 [00:11<00:21,  4.68it/s] 36%|███▌      | 55/154 [00:11<00:21,  4.61it/s] 36%|███▋      | 56/154 [00:12<00:21,  4.56it/s] 37%|███▋      | 57/154 [00:12<00:20,  4.69it/s] 38%|███▊      | 58/154 [00:12<00:20,  4.68it/s] 38%|███▊      | 59/154 [00:12<00:20,  4.72it/s] 39%|███▉      | 60/154 [00:12<00:20,  4.56it/s] 40%|███▉      | 61/154 [00:13<00:20,  4.57it/s] 40%|████      | 62/154 [00:13<00:19,  4.61it/s] 41%|████      | 63/154 [00:13<00:19,  4.61it/s] 42%|████▏     | 64/154 [00:13<00:19,  4.71it/s] 42%|████▏     | 65/154 [00:14<00:19,  4.49it/s] 43%|████▎     | 66/154 [00:14<00:20,  4.38it/s] 44%|████▎     | 67/154 [00:14<00:19,  4.40it/s] 44%|████▍     | 68/154 [00:14<00:18,  4.54it/s] 45%|████▍     | 69/154 [00:14<00:18,  4.57it/s] 45%|████▌     | 70/154 [00:15<00:17,  4.68it/s] 46%|████▌     | 71/154 [00:15<00:17,  4.66it/s] 47%|████▋     | 72/154 [00:15<00:17,  4.59it/s] 47%|████▋     | 73/154 [00:15<00:17,  4.60it/s] 48%|████▊     | 74/154 [00:16<00:17,  4.61it/s] 49%|████▊     | 75/154 [00:16<00:17,  4.61it/s] 49%|████▉     | 76/154 [00:16<00:17,  4.45it/s] 50%|█████     | 77/154 [00:16<00:16,  4.57it/s] 51%|█████     | 78/154 [00:16<00:16,  4.53it/s] 51%|█████▏    | 79/154 [00:17<00:16,  4.61it/s] 52%|█████▏    | 80/154 [00:17<00:16,  4.44it/s] 53%|█████▎    | 81/154 [00:17<00:15,  4.64it/s] 53%|█████▎    | 82/154 [00:17<00:15,  4.73it/s] 54%|█████▍    | 83/154 [00:17<00:15,  4.61it/s] 55%|█████▍    | 84/154 [00:18<00:15,  4.64it/s] 55%|█████▌    | 85/154 [00:18<00:14,  4.81it/s] 56%|█████▌    | 86/154 [00:18<00:14,  4.68it/s] 56%|█████▋    | 87/154 [00:18<00:14,  4.68it/s] 57%|█████▋    | 88/154 [00:19<00:14,  4.53it/s] 58%|█████▊    | 89/154 [00:19<00:14,  4.54it/s] 58%|█████▊    | 90/154 [00:19<00:13,  4.64it/s] 59%|█████▉    | 91/154 [00:19<00:13,  4.64it/s] 60%|█████▉    | 92/154 [00:19<00:14,  4.21it/s] 60%|██████    | 93/154 [00:20<00:14,  4.26it/s] 61%|██████    | 94/154 [00:20<00:14,  4.19it/s] 62%|██████▏   | 95/154 [00:20<00:14,  4.19it/s] 62%|██████▏   | 96/154 [00:20<00:13,  4.20it/s] 63%|██████▎   | 97/154 [00:21<00:13,  4.28it/s] 64%|██████▎   | 98/154 [00:21<00:12,  4.47it/s] 64%|██████▍   | 99/154 [00:21<00:12,  4.40it/s] 65%|██████▍   | 100/154 [00:21<00:12,  4.35it/s] 66%|██████▌   | 101/154 [00:22<00:11,  4.46it/s] 66%|██████▌   | 102/154 [00:22<00:11,  4.60it/s] 67%|██████▋   | 103/154 [00:22<00:11,  4.60it/s] 68%|██████▊   | 104/154 [00:22<00:10,  4.61it/s] 68%|██████▊   | 105/154 [00:22<00:10,  4.62it/s] 69%|██████▉   | 106/154 [00:23<00:10,  4.69it/s] 69%|██████▉   | 107/154 [00:23<00:10,  4.64it/s] 70%|███████   | 108/154 [00:23<00:10,  4.49it/s] 71%|███████   | 109/154 [00:23<00:09,  4.63it/s] 71%|███████▏  | 110/154 [00:24<00:09,  4.48it/s] 72%|███████▏  | 111/154 [00:24<00:09,  4.58it/s] 73%|███████▎  | 112/154 [00:24<00:09,  4.53it/s] 73%|███████▎  | 113/154 [00:24<00:08,  4.57it/s] 74%|███████▍  | 114/154 [00:24<00:08,  4.67it/s] 75%|███████▍  | 115/154 [00:25<00:08,  4.67it/s] 75%|███████▌  | 116/154 [00:25<00:08,  4.69it/s] 76%|███████▌  | 117/154 [00:25<00:07,  4.74it/s] 77%|███████▋  | 118/154 [00:25<00:07,  4.71it/s] 77%|███████▋  | 119/154 [00:25<00:07,  4.77it/s] 78%|███████▊  | 120/154 [00:26<00:06,  4.91it/s] 79%|███████▊  | 121/154 [00:26<00:06,  4.91it/s] 79%|███████▉  | 122/154 [00:26<00:06,  4.91it/s] 80%|███████▉  | 123/154 [00:26<00:06,  4.67it/s] 81%|████████  | 124/154 [00:26<00:06,  4.65it/s] 81%|████████  | 125/154 [00:27<00:06,  4.73it/s] 82%|████████▏ | 126/154 [00:27<00:06,  4.57it/s] 82%|████████▏ | 127/154 [00:27<00:05,  4.59it/s] 83%|████████▎ | 128/154 [00:27<00:06,  4.33it/s] 84%|████████▍ | 129/154 [00:28<00:05,  4.43it/s] 84%|████████▍ | 130/154 [00:28<00:05,  4.48it/s] 85%|████████▌ | 131/154 [00:28<00:05,  4.52it/s] 86%|████████▌ | 132/154 [00:28<00:04,  4.64it/s] 86%|████████▋ | 133/154 [00:28<00:04,  4.58it/s] 87%|████████▋ | 134/154 [00:29<00:04,  4.38it/s] 88%|████████▊ | 135/154 [00:29<00:04,  4.47it/s] 88%|████████▊ | 136/154 [00:29<00:03,  4.65it/s] 89%|████████▉ | 137/154 [00:29<00:03,  4.71it/s] 90%|████████▉ | 138/154 [00:30<00:03,  4.85it/s] 90%|█████████ | 139/154 [00:30<00:03,  4.87it/s] 91%|█████████ | 140/154 [00:30<00:02,  4.73it/s] 92%|█████████▏| 141/154 [00:30<00:02,  4.71it/s] 92%|█████████▏| 142/154 [00:30<00:02,  4.70it/s] 93%|█████████▎| 143/154 [00:31<00:02,  4.70it/s] 94%|█████████▎| 144/154 [00:31<00:02,  4.59it/s] 94%|█████████▍| 145/154 [00:31<00:01,  4.77it/s] 95%|█████████▍| 146/154 [00:31<00:01,  4.73it/s] 95%|█████████▌| 147/154 [00:31<00:01,  4.57it/s] 96%|█████████▌| 148/154 [00:32<00:01,  4.53it/s] 97%|█████████▋| 149/154 [00:32<00:01,  4.67it/s] 97%|█████████▋| 150/154 [00:32<00:00,  4.67it/s] 98%|█████████▊| 151/154 [00:32<00:00,  4.53it/s] 99%|█████████▊| 152/154 [00:33<00:00,  4.73it/s] 99%|█████████▉| 153/154 [00:33<00:00,  4.58it/s]100%|██████████| 154/154 [00:33<00:00,  4.61it/s]
2023-07-10 16:14:58,274 Computing features for evaluation...
  0%|          | 0/155 [00:00<?, ?it/s]/ceph/hpc/home/eujongc/anaconda3/envs/latentops/lib/python3.9/site-packages/torch/utils/data/dataloader.py:554: UserWarning: This DataLoader will create 4 worker processes in total. Our suggested max number of worker in current system is 2, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(_create_warning_msg(
  1%|          | 1/155 [00:00<01:05,  2.34it/s]  1%|▏         | 2/155 [00:00<00:45,  3.36it/s]  2%|▏         | 3/155 [00:00<00:39,  3.87it/s]  3%|▎         | 4/155 [00:01<00:39,  3.78it/s]  3%|▎         | 5/155 [00:01<00:38,  3.93it/s]  4%|▍         | 6/155 [00:01<00:35,  4.22it/s]  5%|▍         | 7/155 [00:01<00:34,  4.30it/s]  5%|▌         | 8/155 [00:01<00:33,  4.42it/s]  6%|▌         | 9/155 [00:02<00:32,  4.48it/s]  6%|▋         | 10/155 [00:02<00:31,  4.55it/s]  7%|▋         | 11/155 [00:02<00:32,  4.42it/s]  8%|▊         | 12/155 [00:02<00:31,  4.51it/s]  8%|▊         | 13/155 [00:03<00:31,  4.46it/s]  9%|▉         | 14/155 [00:03<00:32,  4.38it/s] 10%|▉         | 15/155 [00:03<00:32,  4.27it/s] 10%|█         | 16/155 [00:03<00:30,  4.52it/s] 11%|█         | 17/155 [00:04<00:30,  4.47it/s] 12%|█▏        | 18/155 [00:04<00:31,  4.38it/s] 12%|█▏        | 19/155 [00:04<00:30,  4.53it/s] 13%|█▎        | 20/155 [00:04<00:30,  4.47it/s] 14%|█▎        | 21/155 [00:04<00:29,  4.59it/s] 14%|█▍        | 22/155 [00:05<00:28,  4.75it/s] 15%|█▍        | 23/155 [00:05<00:28,  4.69it/s] 15%|█▌        | 24/155 [00:05<00:28,  4.60it/s] 16%|█▌        | 25/155 [00:05<00:27,  4.68it/s] 17%|█▋        | 26/155 [00:05<00:28,  4.50it/s] 17%|█▋        | 27/155 [00:06<00:28,  4.55it/s] 18%|█▊        | 28/155 [00:06<00:27,  4.64it/s] 19%|█▊        | 29/155 [00:06<00:28,  4.49it/s] 19%|█▉        | 30/155 [00:06<00:28,  4.40it/s] 20%|██        | 31/155 [00:07<00:28,  4.34it/s] 21%|██        | 32/155 [00:07<00:27,  4.50it/s] 21%|██▏       | 33/155 [00:07<00:26,  4.54it/s] 22%|██▏       | 34/155 [00:07<00:26,  4.51it/s] 23%|██▎       | 35/155 [00:07<00:26,  4.48it/s] 23%|██▎       | 36/155 [00:08<00:26,  4.41it/s] 24%|██▍       | 37/155 [00:08<00:27,  4.28it/s] 25%|██▍       | 38/155 [00:08<00:26,  4.38it/s] 25%|██▌       | 39/155 [00:08<00:25,  4.47it/s] 26%|██▌       | 40/155 [00:09<00:24,  4.60it/s] 26%|██▋       | 41/155 [00:09<00:25,  4.46it/s] 27%|██▋       | 42/155 [00:09<00:24,  4.54it/s] 28%|██▊       | 43/155 [00:09<00:24,  4.57it/s] 28%|██▊       | 44/155 [00:09<00:24,  4.53it/s] 29%|██▉       | 45/155 [00:10<00:23,  4.65it/s] 30%|██▉       | 46/155 [00:10<00:24,  4.50it/s] 30%|███       | 47/155 [00:10<00:24,  4.48it/s] 31%|███       | 48/155 [00:10<00:23,  4.46it/s] 32%|███▏      | 49/155 [00:11<00:23,  4.60it/s] 32%|███▏      | 50/155 [00:11<00:23,  4.48it/s] 33%|███▎      | 51/155 [00:11<00:23,  4.46it/s] 34%|███▎      | 52/155 [00:11<00:23,  4.30it/s] 34%|███▍      | 53/155 [00:12<00:23,  4.37it/s] 35%|███▍      | 54/155 [00:12<00:22,  4.54it/s] 35%|███▌      | 55/155 [00:12<00:21,  4.58it/s] 36%|███▌      | 56/155 [00:12<00:21,  4.59it/s] 37%|███▋      | 57/155 [00:12<00:21,  4.52it/s] 37%|███▋      | 58/155 [00:13<00:21,  4.49it/s] 38%|███▊      | 59/155 [00:13<00:21,  4.52it/s] 39%|███▊      | 60/155 [00:13<00:20,  4.65it/s] 39%|███▉      | 61/155 [00:13<00:21,  4.35it/s] 40%|████      | 62/155 [00:14<00:20,  4.46it/s] 41%|████      | 63/155 [00:14<00:20,  4.52it/s] 41%|████▏     | 64/155 [00:14<00:20,  4.53it/s] 42%|████▏     | 65/155 [00:14<00:19,  4.72it/s] 43%|████▎     | 66/155 [00:14<00:19,  4.60it/s] 43%|████▎     | 67/155 [00:15<00:18,  4.69it/s] 44%|████▍     | 68/155 [00:15<00:18,  4.78it/s] 45%|████▍     | 69/155 [00:15<00:18,  4.68it/s] 45%|████▌     | 70/155 [00:15<00:18,  4.61it/s] 46%|████▌     | 71/155 [00:15<00:18,  4.62it/s] 46%|████▋     | 72/155 [00:16<00:19,  4.27it/s] 47%|████▋     | 73/155 [00:16<00:20,  4.05it/s] 48%|████▊     | 74/155 [00:16<00:19,  4.14it/s] 48%|████▊     | 75/155 [00:16<00:18,  4.30it/s] 49%|████▉     | 76/155 [00:17<00:17,  4.39it/s] 50%|████▉     | 77/155 [00:17<00:17,  4.39it/s] 50%|█████     | 78/155 [00:17<00:17,  4.41it/s] 51%|█████     | 79/155 [00:17<00:16,  4.62it/s] 52%|█████▏    | 80/155 [00:17<00:15,  4.79it/s] 52%|█████▏    | 81/155 [00:18<00:16,  4.59it/s] 53%|█████▎    | 82/155 [00:18<00:15,  4.60it/s] 54%|█████▎    | 83/155 [00:18<00:16,  4.41it/s] 54%|█████▍    | 84/155 [00:18<00:15,  4.54it/s] 55%|█████▍    | 85/155 [00:19<00:15,  4.57it/s] 55%|█████▌    | 86/155 [00:19<00:14,  4.60it/s] 56%|█████▌    | 87/155 [00:19<00:14,  4.67it/s] 57%|█████▋    | 88/155 [00:19<00:14,  4.75it/s] 57%|█████▋    | 89/155 [00:19<00:13,  4.88it/s] 58%|█████▊    | 90/155 [00:20<00:13,  4.82it/s] 59%|█████▊    | 91/155 [00:20<00:13,  4.78it/s] 59%|█████▉    | 92/155 [00:20<00:13,  4.82it/s] 60%|██████    | 93/155 [00:20<00:17,  3.60it/s] 61%|██████    | 94/155 [00:21<00:15,  3.89it/s] 61%|██████▏   | 95/155 [00:21<00:14,  4.09it/s] 62%|██████▏   | 96/155 [00:21<00:14,  4.19it/s] 63%|██████▎   | 97/155 [00:21<00:13,  4.39it/s] 63%|██████▎   | 98/155 [00:22<00:12,  4.42it/s] 64%|██████▍   | 99/155 [00:22<00:12,  4.56it/s] 65%|██████▍   | 100/155 [00:22<00:12,  4.51it/s] 65%|██████▌   | 101/155 [00:22<00:11,  4.55it/s] 66%|██████▌   | 102/155 [00:22<00:11,  4.58it/s] 66%|██████▋   | 103/155 [00:23<00:11,  4.45it/s] 67%|██████▋   | 104/155 [00:23<00:11,  4.51it/s] 68%|██████▊   | 105/155 [00:23<00:11,  4.53it/s] 68%|██████▊   | 106/155 [00:23<00:10,  4.51it/s] 69%|██████▉   | 107/155 [00:24<00:10,  4.57it/s] 70%|██████▉   | 108/155 [00:24<00:10,  4.51it/s] 70%|███████   | 109/155 [00:24<00:10,  4.57it/s] 71%|███████   | 110/155 [00:24<00:09,  4.59it/s] 72%|███████▏  | 111/155 [00:24<00:09,  4.77it/s] 72%|███████▏  | 112/155 [00:25<00:09,  4.67it/s] 73%|███████▎  | 113/155 [00:25<00:09,  4.64it/s] 74%|███████▎  | 114/155 [00:25<00:09,  4.44it/s] 74%|███████▍  | 115/155 [00:25<00:09,  4.36it/s] 75%|███████▍  | 116/155 [00:26<00:08,  4.52it/s] 75%|███████▌  | 117/155 [00:26<00:08,  4.49it/s] 76%|███████▌  | 118/155 [00:26<00:07,  4.69it/s] 77%|███████▋  | 119/155 [00:26<00:08,  4.32it/s] 77%|███████▋  | 120/155 [00:26<00:07,  4.41it/s] 78%|███████▊  | 121/155 [00:27<00:07,  4.28it/s] 79%|███████▊  | 122/155 [00:27<00:07,  4.39it/s] 79%|███████▉  | 123/155 [00:27<00:07,  4.46it/s] 80%|████████  | 124/155 [00:27<00:07,  4.36it/s] 81%|████████  | 125/155 [00:28<00:06,  4.55it/s] 81%|████████▏ | 126/155 [00:28<00:06,  4.55it/s] 82%|████████▏ | 127/155 [00:28<00:05,  4.68it/s] 83%|████████▎ | 128/155 [00:28<00:05,  4.53it/s] 83%|████████▎ | 129/155 [00:28<00:05,  4.41it/s] 84%|████████▍ | 130/155 [00:29<00:05,  4.35it/s] 85%|████████▍ | 131/155 [00:29<00:05,  4.25it/s] 85%|████████▌ | 132/155 [00:29<00:05,  4.44it/s] 86%|████████▌ | 133/155 [00:29<00:04,  4.51it/s] 86%|████████▋ | 134/155 [00:30<00:04,  4.42it/s] 87%|████████▋ | 135/155 [00:30<00:04,  4.51it/s] 88%|████████▊ | 136/155 [00:30<00:04,  4.62it/s] 88%|████████▊ | 137/155 [00:30<00:03,  4.72it/s] 89%|████████▉ | 138/155 [00:30<00:03,  4.56it/s] 90%|████████▉ | 139/155 [00:31<00:03,  4.52it/s] 90%|█████████ | 140/155 [00:31<00:03,  4.51it/s] 91%|█████████ | 141/155 [00:31<00:03,  4.48it/s] 92%|█████████▏| 142/155 [00:31<00:02,  4.62it/s] 92%|█████████▏| 143/155 [00:31<00:02,  4.74it/s] 93%|█████████▎| 144/155 [00:32<00:02,  4.48it/s] 94%|█████████▎| 145/155 [00:32<00:02,  4.51it/s] 94%|█████████▍| 146/155 [00:32<00:01,  4.64it/s] 95%|█████████▍| 147/155 [00:32<00:01,  4.64it/s] 95%|█████████▌| 148/155 [00:33<00:01,  4.75it/s] 96%|█████████▌| 149/155 [00:33<00:01,  4.66it/s] 97%|█████████▋| 150/155 [00:33<00:01,  4.72it/s] 97%|█████████▋| 151/155 [00:33<00:00,  4.77it/s] 98%|█████████▊| 152/155 [00:33<00:00,  4.86it/s] 99%|█████████▊| 153/155 [00:34<00:00,  4.90it/s] 99%|█████████▉| 154/155 [00:34<00:00,  4.51it/s]100%|██████████| 155/155 [00:34<00:00,  4.49it/s]
+-------+-----------------------+-------------------+-------------+-------------+-----------+----------+
| epoch |           lr          |     train_loss    | val_top1acc | val_top3acc | val_ndcg1 | val_mrr3 |
+-------+-----------------------+-------------------+-------------+-------------+-----------+----------+
|   0   | 4.999999999999982e-05 | 2.821789560880203 |    34.98    |    67.35    |   59.94   |  49.07   |
+-------+-----------------------+-------------------+-------------+-------------+-----------+----------+
/ceph/hpc/home/eujongc/anaconda3/envs/latentops/lib/python3.9/site-packages/torch/utils/data/dataloader.py:554: UserWarning: This DataLoader will create 4 worker processes in total. Our suggested max number of worker in current system is 2, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(_create_warning_msg(
Train Epoch: [1]  [  0/229]  eta: 0:05:23  lr: 0.000050  loss: 2.4128  time: 1.4118  data: 0.1259  max mem: 30242
Train Epoch: [1]  [ 50/229]  eta: 0:03:19  lr: 0.000050  loss: 1.7244  time: 1.0792  data: 0.0001  max mem: 30242
Train Epoch: [1]  [100/229]  eta: 0:02:24  lr: 0.000050  loss: 1.8161  time: 1.1165  data: 0.0001  max mem: 30242
Train Epoch: [1]  [150/229]  eta: 0:01:27  lr: 0.000050  loss: 1.6181  time: 1.1117  data: 0.0001  max mem: 30242
Train Epoch: [1]  [200/229]  eta: 0:00:32  lr: 0.000050  loss: 1.6128  time: 1.1859  data: 0.0001  max mem: 30242
Train Epoch: [1]  [228/229]  eta: 0:00:01  lr: 0.000050  loss: 0.9472  time: 1.0947  data: 0.0001  max mem: 30242
2023-07-10 16:19:48,878 Train Epoch: [1] Total time: 0:04:15 (1.1162 s / it)
2023-07-10 16:19:48,882 Computing features for evaluation...
  0%|          | 0/154 [00:00<?, ?it/s]  1%|          | 1/154 [00:00<00:51,  2.96it/s]  1%|▏         | 2/154 [00:00<00:39,  3.85it/s]  2%|▏         | 3/154 [00:00<00:36,  4.19it/s]  3%|▎         | 4/154 [00:00<00:33,  4.41it/s]  3%|▎         | 5/154 [00:01<00:34,  4.36it/s]  4%|▍         | 6/154 [00:01<00:32,  4.55it/s]  5%|▍         | 7/154 [00:01<00:30,  4.79it/s]  5%|▌         | 8/154 [00:01<00:31,  4.69it/s]  6%|▌         | 9/154 [00:02<00:31,  4.60it/s]  6%|▋         | 10/154 [00:02<00:30,  4.71it/s]  7%|▋         | 11/154 [00:02<00:31,  4.53it/s]  8%|▊         | 12/154 [00:02<00:31,  4.51it/s]  8%|▊         | 13/154 [00:02<00:30,  4.56it/s]  9%|▉         | 14/154 [00:03<00:30,  4.52it/s] 10%|▉         | 15/154 [00:03<00:30,  4.54it/s] 10%|█         | 16/154 [00:03<00:29,  4.73it/s] 11%|█         | 17/154 [00:03<00:29,  4.70it/s] 12%|█▏        | 18/154 [00:03<00:28,  4.69it/s] 12%|█▏        | 19/154 [00:04<00:29,  4.51it/s] 13%|█▎        | 20/154 [00:04<00:29,  4.50it/s] 14%|█▎        | 21/154 [00:04<00:28,  4.69it/s] 14%|█▍        | 22/154 [00:04<00:27,  4.82it/s] 15%|█▍        | 23/154 [00:05<00:26,  4.87it/s] 16%|█▌        | 24/154 [00:05<00:27,  4.81it/s] 16%|█▌        | 25/154 [00:05<00:26,  4.78it/s] 17%|█▋        | 26/154 [00:05<00:32,  3.89it/s] 18%|█▊        | 27/154 [00:06<00:30,  4.17it/s] 18%|█▊        | 28/154 [00:06<00:29,  4.25it/s] 19%|█▉        | 29/154 [00:06<00:28,  4.44it/s] 19%|█▉        | 30/154 [00:06<00:27,  4.59it/s] 20%|██        | 31/154 [00:06<00:26,  4.61it/s] 21%|██        | 32/154 [00:07<00:25,  4.70it/s] 21%|██▏       | 33/154 [00:07<00:25,  4.69it/s] 22%|██▏       | 34/154 [00:07<00:26,  4.60it/s] 23%|██▎       | 35/154 [00:07<00:25,  4.68it/s] 23%|██▎       | 36/154 [00:07<00:25,  4.68it/s] 24%|██▍       | 37/154 [00:08<00:25,  4.65it/s] 25%|██▍       | 38/154 [00:08<00:24,  4.72it/s] 25%|██▌       | 39/154 [00:08<00:23,  4.79it/s] 26%|██▌       | 40/154 [00:08<00:23,  4.76it/s] 27%|██▋       | 41/154 [00:09<00:24,  4.57it/s] 27%|██▋       | 42/154 [00:09<00:24,  4.52it/s] 28%|██▊       | 43/154 [00:09<00:24,  4.50it/s] 29%|██▊       | 44/154 [00:09<00:23,  4.72it/s] 29%|██▉       | 45/154 [00:09<00:23,  4.62it/s] 30%|██▉       | 46/154 [00:10<00:22,  4.73it/s] 31%|███       | 47/154 [00:10<00:22,  4.72it/s] 31%|███       | 48/154 [00:10<00:22,  4.76it/s] 32%|███▏      | 49/154 [00:10<00:22,  4.72it/s] 32%|███▏      | 50/154 [00:10<00:22,  4.63it/s] 33%|███▎      | 51/154 [00:11<00:21,  4.72it/s] 34%|███▍      | 52/154 [00:11<00:22,  4.61it/s] 34%|███▍      | 53/154 [00:11<00:22,  4.58it/s] 35%|███▌      | 54/154 [00:11<00:21,  4.69it/s] 36%|███▌      | 55/154 [00:12<00:21,  4.62it/s] 36%|███▋      | 56/154 [00:12<00:21,  4.56it/s] 37%|███▋      | 57/154 [00:12<00:20,  4.69it/s] 38%|███▊      | 58/154 [00:12<00:20,  4.68it/s] 38%|███▊      | 59/154 [00:12<00:20,  4.73it/s] 39%|███▉      | 60/154 [00:13<00:20,  4.56it/s] 40%|███▉      | 61/154 [00:13<00:20,  4.58it/s] 40%|████      | 62/154 [00:13<00:19,  4.61it/s] 41%|████      | 63/154 [00:13<00:19,  4.61it/s] 42%|████▏     | 64/154 [00:13<00:19,  4.71it/s] 42%|████▏     | 65/154 [00:14<00:19,  4.48it/s] 43%|████▎     | 66/154 [00:14<00:20,  4.38it/s] 44%|████▎     | 67/154 [00:14<00:19,  4.39it/s] 44%|████▍     | 68/154 [00:14<00:18,  4.54it/s] 45%|████▍     | 69/154 [00:15<00:18,  4.57it/s] 45%|████▌     | 70/154 [00:15<00:17,  4.68it/s] 46%|████▌     | 71/154 [00:15<00:17,  4.66it/s] 47%|████▋     | 72/154 [00:15<00:17,  4.59it/s] 47%|████▋     | 73/154 [00:15<00:17,  4.60it/s] 48%|████▊     | 74/154 [00:16<00:17,  4.61it/s] 49%|████▊     | 75/154 [00:16<00:17,  4.60it/s] 49%|████▉     | 76/154 [00:16<00:17,  4.44it/s] 50%|█████     | 77/154 [00:16<00:16,  4.57it/s] 51%|█████     | 78/154 [00:17<00:16,  4.52it/s] 51%|█████▏    | 79/154 [00:17<00:16,  4.60it/s] 52%|█████▏    | 80/154 [00:17<00:16,  4.42it/s] 53%|█████▎    | 81/154 [00:17<00:15,  4.63it/s] 53%|█████▎    | 82/154 [00:17<00:15,  4.72it/s] 54%|█████▍    | 83/154 [00:18<00:15,  4.60it/s] 55%|█████▍    | 84/154 [00:18<00:15,  4.64it/s] 55%|█████▌    | 85/154 [00:18<00:14,  4.81it/s] 56%|█████▌    | 86/154 [00:18<00:14,  4.69it/s] 56%|█████▋    | 87/154 [00:18<00:14,  4.68it/s] 57%|█████▋    | 88/154 [00:19<00:14,  4.53it/s] 58%|█████▊    | 89/154 [00:19<00:14,  4.54it/s] 58%|█████▊    | 90/154 [00:19<00:13,  4.65it/s] 59%|█████▉    | 91/154 [00:19<00:13,  4.65it/s] 60%|█████▉    | 92/154 [00:20<00:14,  4.22it/s] 60%|██████    | 93/154 [00:20<00:14,  4.27it/s] 61%|██████    | 94/154 [00:20<00:14,  4.20it/s] 62%|██████▏   | 95/154 [00:20<00:14,  4.20it/s] 62%|██████▏   | 96/154 [00:21<00:13,  4.21it/s] 63%|██████▎   | 97/154 [00:21<00:13,  4.28it/s] 64%|██████▎   | 98/154 [00:21<00:12,  4.47it/s] 64%|██████▍   | 99/154 [00:21<00:12,  4.40it/s] 65%|██████▍   | 100/154 [00:21<00:12,  4.35it/s] 66%|██████▌   | 101/154 [00:22<00:11,  4.46it/s] 66%|██████▌   | 102/154 [00:22<00:11,  4.60it/s] 67%|██████▋   | 103/154 [00:22<00:11,  4.60it/s] 68%|██████▊   | 104/154 [00:22<00:10,  4.61it/s] 68%|██████▊   | 105/154 [00:23<00:10,  4.63it/s] 69%|██████▉   | 106/154 [00:23<00:10,  4.70it/s] 69%|██████▉   | 107/154 [00:23<00:10,  4.65it/s] 70%|███████   | 108/154 [00:23<00:10,  4.49it/s] 71%|███████   | 109/154 [00:23<00:09,  4.63it/s] 71%|███████▏  | 110/154 [00:24<00:09,  4.48it/s] 72%|███████▏  | 111/154 [00:24<00:09,  4.59it/s] 73%|███████▎  | 112/154 [00:24<00:09,  4.53it/s] 73%|███████▎  | 113/154 [00:24<00:08,  4.57it/s] 74%|███████▍  | 114/154 [00:24<00:08,  4.66it/s] 75%|███████▍  | 115/154 [00:25<00:08,  4.67it/s] 75%|███████▌  | 116/154 [00:25<00:08,  4.68it/s] 76%|███████▌  | 117/154 [00:25<00:07,  4.74it/s] 77%|███████▋  | 118/154 [00:25<00:07,  4.70it/s] 77%|███████▋  | 119/154 [00:26<00:07,  4.77it/s] 78%|███████▊  | 120/154 [00:26<00:06,  4.91it/s] 79%|███████▊  | 121/154 [00:26<00:06,  4.91it/s] 79%|███████▉  | 122/154 [00:26<00:06,  4.92it/s] 80%|███████▉  | 123/154 [00:26<00:06,  4.67it/s] 81%|████████  | 124/154 [00:27<00:06,  4.65it/s] 81%|████████  | 125/154 [00:27<00:06,  4.74it/s] 82%|████████▏ | 126/154 [00:27<00:06,  4.57it/s] 82%|████████▏ | 127/154 [00:27<00:05,  4.60it/s] 83%|████████▎ | 128/154 [00:28<00:06,  4.33it/s] 84%|████████▍ | 129/154 [00:28<00:05,  4.43it/s] 84%|████████▍ | 130/154 [00:28<00:05,  4.48it/s] 85%|████████▌ | 131/154 [00:28<00:05,  4.53it/s] 86%|████████▌ | 132/154 [00:28<00:04,  4.65it/s] 86%|████████▋ | 133/154 [00:29<00:04,  4.59it/s] 87%|████████▋ | 134/154 [00:29<00:04,  4.39it/s] 88%|████████▊ | 135/154 [00:29<00:04,  4.48it/s] 88%|████████▊ | 136/154 [00:29<00:03,  4.66it/s] 89%|████████▉ | 137/154 [00:29<00:03,  4.71it/s] 90%|████████▉ | 138/154 [00:30<00:03,  4.86it/s] 90%|█████████ | 139/154 [00:30<00:03,  4.87it/s] 91%|█████████ | 140/154 [00:30<00:02,  4.72it/s] 92%|█████████▏| 141/154 [00:30<00:02,  4.71it/s] 92%|█████████▏| 142/154 [00:30<00:02,  4.70it/s] 93%|█████████▎| 143/154 [00:31<00:02,  4.70it/s] 94%|█████████▎| 144/154 [00:31<00:02,  4.60it/s] 94%|█████████▍| 145/154 [00:31<00:01,  4.77it/s] 95%|█████████▍| 146/154 [00:31<00:01,  4.74it/s] 95%|█████████▌| 147/154 [00:32<00:01,  4.57it/s] 96%|█████████▌| 148/154 [00:32<00:01,  4.53it/s] 97%|█████████▋| 149/154 [00:32<00:01,  4.67it/s] 97%|█████████▋| 150/154 [00:32<00:00,  4.67it/s] 98%|█████████▊| 151/154 [00:32<00:00,  4.53it/s] 99%|█████████▊| 152/154 [00:33<00:00,  4.73it/s] 99%|█████████▉| 153/154 [00:33<00:00,  4.58it/s]100%|██████████| 154/154 [00:33<00:00,  4.59it/s]
2023-07-10 16:20:23,804 Computing features for evaluation...
  0%|          | 0/155 [00:00<?, ?it/s]/ceph/hpc/home/eujongc/anaconda3/envs/latentops/lib/python3.9/site-packages/torch/utils/data/dataloader.py:554: UserWarning: This DataLoader will create 4 worker processes in total. Our suggested max number of worker in current system is 2, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(_create_warning_msg(
  1%|          | 1/155 [00:00<00:50,  3.07it/s]  1%|▏         | 2/155 [00:00<00:38,  3.93it/s]  2%|▏         | 3/155 [00:00<00:35,  4.26it/s]  3%|▎         | 4/155 [00:01<00:37,  4.00it/s]  3%|▎         | 5/155 [00:01<00:36,  4.08it/s]  4%|▍         | 6/155 [00:01<00:34,  4.33it/s]  5%|▍         | 7/155 [00:01<00:33,  4.38it/s]  5%|▌         | 8/155 [00:01<00:32,  4.48it/s]  6%|▌         | 9/155 [00:02<00:32,  4.53it/s]  6%|▋         | 10/155 [00:02<00:31,  4.58it/s]  7%|▋         | 11/155 [00:02<00:32,  4.44it/s]  8%|▊         | 12/155 [00:02<00:31,  4.52it/s]  8%|▊         | 13/155 [00:02<00:31,  4.48it/s]  9%|▉         | 14/155 [00:03<00:32,  4.40it/s] 10%|▉         | 15/155 [00:03<00:32,  4.28it/s] 10%|█         | 16/155 [00:03<00:30,  4.53it/s] 11%|█         | 17/155 [00:03<00:30,  4.48it/s] 12%|█▏        | 18/155 [00:04<00:31,  4.39it/s] 12%|█▏        | 19/155 [00:04<00:29,  4.54it/s] 13%|█▎        | 20/155 [00:04<00:30,  4.48it/s] 14%|█▎        | 21/155 [00:04<00:29,  4.61it/s] 14%|█▍        | 22/155 [00:04<00:27,  4.78it/s] 15%|█▍        | 23/155 [00:05<00:27,  4.72it/s] 15%|█▌        | 24/155 [00:05<00:28,  4.63it/s] 16%|█▌        | 25/155 [00:05<00:27,  4.72it/s] 17%|█▋        | 26/155 [00:05<00:28,  4.54it/s] 17%|█▋        | 27/155 [00:06<00:27,  4.58it/s] 18%|█▊        | 28/155 [00:06<00:27,  4.67it/s] 19%|█▊        | 29/155 [00:06<00:27,  4.53it/s] 19%|█▉        | 30/155 [00:06<00:28,  4.42it/s] 20%|██        | 31/155 [00:06<00:28,  4.36it/s] 21%|██        | 32/155 [00:07<00:27,  4.52it/s] 21%|██▏       | 33/155 [00:07<00:26,  4.56it/s] 22%|██▏       | 34/155 [00:07<00:26,  4.52it/s] 23%|██▎       | 35/155 [00:07<00:26,  4.49it/s] 23%|██▎       | 36/155 [00:08<00:26,  4.42it/s] 24%|██▍       | 37/155 [00:08<00:27,  4.28it/s] 25%|██▍       | 38/155 [00:08<00:26,  4.39it/s] 25%|██▌       | 39/155 [00:08<00:25,  4.47it/s] 26%|██▌       | 40/155 [00:08<00:24,  4.61it/s] 26%|██▋       | 41/155 [00:09<00:25,  4.47it/s] 27%|██▋       | 42/155 [00:09<00:24,  4.54it/s] 28%|██▊       | 43/155 [00:09<00:24,  4.57it/s] 28%|██▊       | 44/155 [00:09<00:24,  4.54it/s] 29%|██▉       | 45/155 [00:10<00:23,  4.66it/s] 30%|██▉       | 46/155 [00:10<00:24,  4.51it/s] 30%|███       | 47/155 [00:10<00:24,  4.49it/s] 31%|███       | 48/155 [00:10<00:23,  4.47it/s] 32%|███▏      | 49/155 [00:10<00:23,  4.60it/s] 32%|███▏      | 50/155 [00:11<00:23,  4.50it/s] 33%|███▎      | 51/155 [00:11<00:23,  4.47it/s] 34%|███▎      | 52/155 [00:11<00:23,  4.31it/s] 34%|███▍      | 53/155 [00:11<00:23,  4.38it/s] 35%|███▍      | 54/155 [00:12<00:22,  4.55it/s] 35%|███▌      | 55/155 [00:12<00:21,  4.59it/s] 36%|███▌      | 56/155 [00:12<00:21,  4.60it/s] 37%|███▋      | 57/155 [00:12<00:21,  4.52it/s] 37%|███▋      | 58/155 [00:12<00:21,  4.49it/s] 38%|███▊      | 59/155 [00:13<00:21,  4.52it/s] 39%|███▊      | 60/155 [00:13<00:20,  4.65it/s] 39%|███▉      | 61/155 [00:13<00:21,  4.34it/s] 40%|████      | 62/155 [00:13<00:20,  4.44it/s] 41%|████      | 63/155 [00:14<00:20,  4.51it/s] 41%|████▏     | 64/155 [00:14<00:20,  4.51it/s] 42%|████▏     | 65/155 [00:14<00:19,  4.70it/s] 43%|████▎     | 66/155 [00:14<00:19,  4.59it/s] 43%|████▎     | 67/155 [00:14<00:18,  4.68it/s] 44%|████▍     | 68/155 [00:15<00:18,  4.78it/s] 45%|████▍     | 69/155 [00:15<00:18,  4.69it/s] 45%|████▌     | 70/155 [00:15<00:18,  4.61it/s] 46%|████▌     | 71/155 [00:15<00:18,  4.62it/s] 46%|████▋     | 72/155 [00:16<00:19,  4.28it/s] 47%|████▋     | 73/155 [00:16<00:20,  4.06it/s] 48%|████▊     | 74/155 [00:16<00:19,  4.15it/s] 48%|████▊     | 75/155 [00:16<00:18,  4.30it/s] 49%|████▉     | 76/155 [00:16<00:17,  4.40it/s] 50%|████▉     | 77/155 [00:17<00:17,  4.39it/s] 50%|█████     | 78/155 [00:17<00:17,  4.41it/s] 51%|█████     | 79/155 [00:17<00:16,  4.63it/s] 52%|█████▏    | 80/155 [00:17<00:15,  4.80it/s] 52%|█████▏    | 81/155 [00:18<00:16,  4.60it/s] 53%|█████▎    | 82/155 [00:18<00:15,  4.61it/s] 54%|█████▎    | 83/155 [00:18<00:16,  4.42it/s] 54%|█████▍    | 84/155 [00:18<00:15,  4.55it/s] 55%|█████▍    | 85/155 [00:18<00:15,  4.57it/s] 55%|█████▌    | 86/155 [00:19<00:14,  4.61it/s] 56%|█████▌    | 87/155 [00:19<00:14,  4.68it/s] 57%|█████▋    | 88/155 [00:19<00:14,  4.76it/s] 57%|█████▋    | 89/155 [00:19<00:13,  4.89it/s] 58%|█████▊    | 90/155 [00:19<00:13,  4.83it/s] 59%|█████▊    | 91/155 [00:20<00:13,  4.79it/s] 59%|█████▉    | 92/155 [00:20<00:13,  4.84it/s] 60%|██████    | 93/155 [00:20<00:12,  4.92it/s] 61%|██████    | 94/155 [00:20<00:12,  4.89it/s] 61%|██████▏   | 95/155 [00:21<00:12,  4.82it/s] 62%|██████▏   | 96/155 [00:21<00:12,  4.70it/s] 63%|██████▎   | 97/155 [00:21<00:12,  4.77it/s] 63%|██████▎   | 98/155 [00:21<00:12,  4.68it/s] 64%|██████▍   | 99/155 [00:21<00:11,  4.75it/s] 65%|██████▍   | 100/155 [00:22<00:11,  4.64it/s] 65%|██████▌   | 101/155 [00:22<00:11,  4.64it/s] 66%|██████▌   | 102/155 [00:22<00:11,  4.65it/s] 66%|██████▋   | 103/155 [00:22<00:11,  4.49it/s] 67%|██████▋   | 104/155 [00:22<00:11,  4.53it/s] 68%|██████▊   | 105/155 [00:23<00:10,  4.56it/s] 68%|██████▊   | 106/155 [00:23<00:10,  4.53it/s] 69%|██████▉   | 107/155 [00:23<00:10,  4.58it/s] 70%|██████▉   | 108/155 [00:23<00:10,  4.53it/s] 70%|███████   | 109/155 [00:24<00:10,  4.59it/s] 71%|███████   | 110/155 [00:24<00:09,  4.61it/s] 72%|███████▏  | 111/155 [00:24<00:09,  4.78it/s] 72%|███████▏  | 112/155 [00:24<00:09,  4.68it/s] 73%|███████▎  | 113/155 [00:24<00:09,  4.65it/s] 74%|███████▎  | 114/155 [00:25<00:09,  4.45it/s] 74%|███████▍  | 115/155 [00:25<00:09,  4.36it/s] 75%|███████▍  | 116/155 [00:25<00:08,  4.52it/s] 75%|███████▌  | 117/155 [00:25<00:08,  4.49it/s] 76%|███████▌  | 118/155 [00:26<00:07,  4.69it/s] 77%|███████▋  | 119/155 [00:26<00:08,  4.32it/s] 77%|███████▋  | 120/155 [00:26<00:07,  4.42it/s] 78%|███████▊  | 121/155 [00:26<00:07,  4.29it/s] 79%|███████▊  | 122/155 [00:26<00:07,  4.40it/s] 79%|███████▉  | 123/155 [00:27<00:07,  4.47it/s] 80%|████████  | 124/155 [00:27<00:07,  4.37it/s] 81%|████████  | 125/155 [00:27<00:06,  4.55it/s] 81%|████████▏ | 126/155 [00:27<00:06,  4.56it/s] 82%|████████▏ | 127/155 [00:28<00:05,  4.69it/s] 83%|████████▎ | 128/155 [00:28<00:05,  4.53it/s] 83%|████████▎ | 129/155 [00:28<00:05,  4.41it/s] 84%|████████▍ | 130/155 [00:28<00:05,  4.35it/s] 85%|████████▍ | 131/155 [00:29<00:05,  4.25it/s] 85%|████████▌ | 132/155 [00:29<00:05,  4.44it/s] 86%|████████▌ | 133/155 [00:29<00:04,  4.51it/s] 86%|████████▋ | 134/155 [00:29<00:04,  4.42it/s] 87%|████████▋ | 135/155 [00:29<00:04,  4.52it/s] 88%|████████▊ | 136/155 [00:30<00:04,  4.62it/s] 88%|████████▊ | 137/155 [00:30<00:03,  4.72it/s] 89%|████████▉ | 138/155 [00:30<00:03,  4.57it/s] 90%|████████▉ | 139/155 [00:30<00:03,  4.53it/s] 90%|█████████ | 140/155 [00:30<00:03,  4.51it/s] 91%|█████████ | 141/155 [00:31<00:03,  4.48it/s] 92%|█████████▏| 142/155 [00:31<00:02,  4.62it/s] 92%|█████████▏| 143/155 [00:31<00:02,  4.74it/s] 93%|█████████▎| 144/155 [00:31<00:02,  4.48it/s] 94%|█████████▎| 145/155 [00:32<00:02,  4.51it/s] 94%|█████████▍| 146/155 [00:32<00:01,  4.63it/s] 95%|█████████▍| 147/155 [00:32<00:01,  4.64it/s] 95%|█████████▌| 148/155 [00:32<00:01,  4.74it/s] 96%|█████████▌| 149/155 [00:32<00:01,  4.66it/s] 97%|█████████▋| 150/155 [00:33<00:01,  4.71it/s] 97%|█████████▋| 151/155 [00:33<00:00,  4.77it/s] 98%|█████████▊| 152/155 [00:33<00:00,  4.86it/s] 99%|█████████▊| 153/155 [00:33<00:00,  4.90it/s] 99%|█████████▉| 154/155 [00:33<00:00,  4.50it/s]100%|██████████| 155/155 [00:34<00:00,  4.54it/s]
+-------+-----------------------+--------------------+-------------+-------------+-----------+----------+
| epoch |           lr          |     train_loss     | val_top1acc | val_top3acc | val_ndcg1 | val_mrr3 |
+-------+-----------------------+--------------------+-------------+-------------+-----------+----------+
|   0   | 4.999999999999982e-05 | 2.821789560880203  |    34.98    |    67.35    |   59.94   |  49.07   |
|   1   | 4.995165484649251e-05 | 1.6432694615755539 |    59.23    |    84.22    |   77.79   |  70.30   |
+-------+-----------------------+--------------------+-------------+-------------+-----------+----------+
/ceph/hpc/home/eujongc/anaconda3/envs/latentops/lib/python3.9/site-packages/torch/utils/data/dataloader.py:554: UserWarning: This DataLoader will create 4 worker processes in total. Our suggested max number of worker in current system is 2, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(_create_warning_msg(
Train Epoch: [2]  [  0/229]  eta: 0:04:26  lr: 0.000050  loss: 1.1571  time: 1.1649  data: 0.1279  max mem: 30242
Train Epoch: [2]  [ 50/229]  eta: 0:03:20  lr: 0.000050  loss: 0.9896  time: 1.1186  data: 0.0001  max mem: 30242
Train Epoch: [2]  [100/229]  eta: 0:02:23  lr: 0.000050  loss: 1.1279  time: 1.1104  data: 0.0001  max mem: 30242
Train Epoch: [2]  [150/229]  eta: 0:01:28  lr: 0.000050  loss: 0.9544  time: 1.1208  data: 0.0001  max mem: 30242
Train Epoch: [2]  [200/229]  eta: 0:00:32  lr: 0.000050  loss: 0.8609  time: 1.1186  data: 0.0001  max mem: 30242
Train Epoch: [2]  [228/229]  eta: 0:00:01  lr: 0.000050  loss: 1.0970  time: 1.1375  data: 0.0001  max mem: 30242
2023-07-10 16:25:15,527 Train Epoch: [2] Total time: 0:04:17 (1.1228 s / it)
2023-07-10 16:25:15,530 Computing features for evaluation...
  0%|          | 0/154 [00:00<?, ?it/s]  1%|          | 1/154 [00:00<00:51,  3.00it/s]  1%|▏         | 2/154 [00:00<00:39,  3.87it/s]  2%|▏         | 3/154 [00:00<00:35,  4.21it/s]  3%|▎         | 4/154 [00:00<00:33,  4.42it/s]  3%|▎         | 5/154 [00:01<00:34,  4.37it/s]  4%|▍         | 6/154 [00:01<00:32,  4.55it/s]  5%|▍         | 7/154 [00:01<00:30,  4.79it/s]  5%|▌         | 8/154 [00:01<00:31,  4.68it/s]  6%|▌         | 9/154 [00:02<00:31,  4.60it/s]  6%|▋         | 10/154 [00:02<00:30,  4.71it/s]  7%|▋         | 11/154 [00:02<00:31,  4.53it/s]  8%|▊         | 12/154 [00:02<00:31,  4.50it/s]  8%|▊         | 13/154 [00:02<00:30,  4.55it/s]  9%|▉         | 14/154 [00:03<00:31,  4.51it/s] 10%|▉         | 15/154 [00:03<00:30,  4.54it/s] 10%|█         | 16/154 [00:03<00:29,  4.73it/s] 11%|█         | 17/154 [00:03<00:29,  4.69it/s] 12%|█▏        | 18/154 [00:03<00:29,  4.68it/s] 12%|█▏        | 19/154 [00:04<00:29,  4.50it/s] 13%|█▎        | 20/154 [00:04<00:29,  4.49it/s] 14%|█▎        | 21/154 [00:04<00:28,  4.69it/s] 14%|█▍        | 22/154 [00:04<00:27,  4.82it/s] 15%|█▍        | 23/154 [00:05<00:26,  4.86it/s] 16%|█▌        | 24/154 [00:05<00:27,  4.81it/s] 16%|█▌        | 25/154 [00:05<00:26,  4.78it/s] 17%|█▋        | 26/154 [00:05<00:27,  4.74it/s] 18%|█▊        | 27/154 [00:05<00:26,  4.82it/s] 18%|█▊        | 28/154 [00:06<00:26,  4.70it/s] 19%|█▉        | 29/154 [00:06<00:26,  4.77it/s] 19%|█▉        | 30/154 [00:06<00:25,  4.84it/s] 20%|██        | 31/154 [00:06<00:25,  4.78it/s] 21%|██        | 32/154 [00:06<00:25,  4.83it/s] 21%|██▏       | 33/154 [00:07<00:25,  4.78it/s] 22%|██▏       | 34/154 [00:07<00:25,  4.65it/s] 23%|██▎       | 35/154 [00:07<00:25,  4.72it/s] 23%|██▎       | 36/154 [00:07<00:25,  4.71it/s] 24%|██▍       | 37/154 [00:07<00:25,  4.67it/s] 25%|██▍       | 38/154 [00:08<00:24,  4.73it/s] 25%|██▌       | 39/154 [00:08<00:23,  4.80it/s] 26%|██▌       | 40/154 [00:08<00:23,  4.76it/s] 27%|██▋       | 41/154 [00:08<00:24,  4.57it/s] 27%|██▋       | 42/154 [00:09<00:24,  4.52it/s] 28%|██▊       | 43/154 [00:09<00:24,  4.50it/s] 29%|██▊       | 44/154 [00:09<00:23,  4.72it/s] 29%|██▉       | 45/154 [00:09<00:23,  4.62it/s] 30%|██▉       | 46/154 [00:09<00:22,  4.73it/s] 31%|███       | 47/154 [00:10<00:22,  4.72it/s] 31%|███       | 48/154 [00:10<00:22,  4.76it/s] 32%|███▏      | 49/154 [00:10<00:22,  4.72it/s] 32%|███▏      | 50/154 [00:10<00:22,  4.63it/s] 33%|███▎      | 51/154 [00:10<00:21,  4.72it/s] 34%|███▍      | 52/154 [00:11<00:22,  4.61it/s] 34%|███▍      | 53/154 [00:11<00:22,  4.58it/s] 35%|███▌      | 54/154 [00:11<00:21,  4.69it/s] 36%|███▌      | 55/154 [00:11<00:21,  4.62it/s] 36%|███▋      | 56/154 [00:12<00:21,  4.57it/s] 37%|███▋      | 57/154 [00:12<00:20,  4.69it/s] 38%|███▊      | 58/154 [00:12<00:20,  4.69it/s] 38%|███▊      | 59/154 [00:12<00:20,  4.74it/s] 39%|███▉      | 60/154 [00:12<00:20,  4.57it/s] 40%|███▉      | 61/154 [00:13<00:20,  4.58it/s] 40%|████      | 62/154 [00:13<00:19,  4.61it/s] 41%|████      | 63/154 [00:13<00:19,  4.63it/s] 42%|████▏     | 64/154 [00:13<00:19,  4.72it/s] 42%|████▏     | 65/154 [00:14<00:19,  4.50it/s] 43%|████▎     | 66/154 [00:14<00:20,  4.39it/s] 44%|████▎     | 67/154 [00:14<00:19,  4.40it/s] 44%|████▍     | 68/154 [00:14<00:18,  4.54it/s] 45%|████▍     | 69/154 [00:14<00:18,  4.58it/s] 45%|████▌     | 70/154 [00:15<00:17,  4.69it/s] 46%|████▌     | 71/154 [00:15<00:17,  4.67it/s] 47%|████▋     | 72/154 [00:15<00:17,  4.60it/s] 47%|████▋     | 73/154 [00:15<00:17,  4.61it/s] 48%|████▊     | 74/154 [00:15<00:17,  4.62it/s] 49%|████▊     | 75/154 [00:16<00:17,  4.62it/s] 49%|████▉     | 76/154 [00:16<00:17,  4.45it/s] 50%|█████     | 77/154 [00:16<00:16,  4.58it/s] 51%|█████     | 78/154 [00:16<00:16,  4.53it/s] 51%|█████▏    | 79/154 [00:17<00:16,  4.62it/s] 52%|█████▏    | 80/154 [00:17<00:16,  4.45it/s] 53%|█████▎    | 81/154 [00:17<00:15,  4.64it/s] 53%|█████▎    | 82/154 [00:17<00:15,  4.73it/s] 54%|█████▍    | 83/154 [00:17<00:15,  4.61it/s] 55%|█████▍    | 84/154 [00:18<00:15,  4.65it/s] 55%|█████▌    | 85/154 [00:18<00:14,  4.82it/s] 56%|█████▌    | 86/154 [00:18<00:14,  4.69it/s] 56%|█████▋    | 87/154 [00:18<00:14,  4.68it/s] 57%|█████▋    | 88/154 [00:19<00:14,  4.53it/s] 58%|█████▊    | 89/154 [00:19<00:14,  4.55it/s] 58%|█████▊    | 90/154 [00:19<00:13,  4.66it/s] 59%|█████▉    | 91/154 [00:19<00:13,  4.66it/s] 60%|█████▉    | 92/154 [00:19<00:14,  4.21it/s] 60%|██████    | 93/154 [00:20<00:14,  4.26it/s] 61%|██████    | 94/154 [00:20<00:14,  4.19it/s] 62%|██████▏   | 95/154 [00:20<00:14,  4.19it/s] 62%|██████▏   | 96/154 [00:20<00:13,  4.20it/s] 63%|██████▎   | 97/154 [00:21<00:13,  4.28it/s] 64%|██████▎   | 98/154 [00:21<00:12,  4.47it/s] 64%|██████▍   | 99/154 [00:21<00:12,  4.40it/s] 65%|██████▍   | 100/154 [00:21<00:12,  4.36it/s] 66%|██████▌   | 101/154 [00:22<00:11,  4.46it/s] 66%|██████▌   | 102/154 [00:22<00:11,  4.60it/s] 67%|██████▋   | 103/154 [00:22<00:11,  4.60it/s] 68%|██████▊   | 104/154 [00:22<00:10,  4.61it/s] 68%|██████▊   | 105/154 [00:22<00:10,  4.62it/s] 69%|██████▉   | 106/154 [00:23<00:10,  4.70it/s] 69%|██████▉   | 107/154 [00:23<00:10,  4.64it/s] 70%|███████   | 108/154 [00:23<00:10,  4.49it/s] 71%|███████   | 109/154 [00:23<00:09,  4.63it/s] 71%|███████▏  | 110/154 [00:23<00:09,  4.48it/s] 72%|███████▏  | 111/154 [00:24<00:09,  4.58it/s] 73%|███████▎  | 112/154 [00:24<00:09,  4.53it/s] 73%|███████▎  | 113/154 [00:24<00:08,  4.57it/s] 74%|███████▍  | 114/154 [00:24<00:08,  4.67it/s] 75%|███████▍  | 115/154 [00:25<00:08,  4.67it/s] 75%|███████▌  | 116/154 [00:25<00:08,  4.69it/s] 76%|███████▌  | 117/154 [00:25<00:07,  4.74it/s] 77%|███████▋  | 118/154 [00:25<00:07,  4.70it/s] 77%|███████▋  | 119/154 [00:25<00:07,  4.77it/s] 78%|███████▊  | 120/154 [00:26<00:06,  4.91it/s] 79%|███████▊  | 121/154 [00:26<00:06,  4.91it/s] 79%|███████▉  | 122/154 [00:26<00:06,  4.92it/s] 80%|███████▉  | 123/154 [00:26<00:06,  4.67it/s] 81%|████████  | 124/154 [00:26<00:06,  4.65it/s] 81%|████████  | 125/154 [00:27<00:06,  4.74it/s] 82%|████████▏ | 126/154 [00:27<00:06,  4.56it/s] 82%|████████▏ | 127/154 [00:27<00:05,  4.59it/s] 83%|████████▎ | 128/154 [00:27<00:06,  4.33it/s] 84%|████████▍ | 129/154 [00:28<00:05,  4.43it/s] 84%|████████▍ | 130/154 [00:28<00:05,  4.48it/s] 85%|████████▌ | 131/154 [00:28<00:05,  4.52it/s] 86%|████████▌ | 132/154 [00:28<00:04,  4.64it/s] 86%|████████▋ | 133/154 [00:28<00:04,  4.58it/s] 87%|████████▋ | 134/154 [00:29<00:04,  4.38it/s] 88%|████████▊ | 135/154 [00:29<00:04,  4.47it/s] 88%|████████▊ | 136/154 [00:29<00:03,  4.65it/s] 89%|████████▉ | 137/154 [00:29<00:03,  4.71it/s] 90%|████████▉ | 138/154 [00:29<00:03,  4.85it/s] 90%|█████████ | 139/154 [00:30<00:03,  4.87it/s] 91%|█████████ | 140/154 [00:30<00:02,  4.72it/s] 92%|█████████▏| 141/154 [00:30<00:02,  4.71it/s] 92%|█████████▏| 142/154 [00:30<00:02,  4.70it/s] 93%|█████████▎| 143/154 [00:31<00:02,  4.69it/s] 94%|█████████▎| 144/154 [00:31<00:02,  4.58it/s] 94%|█████████▍| 145/154 [00:31<00:01,  4.76it/s] 95%|█████████▍| 146/154 [00:31<00:01,  4.73it/s] 95%|█████████▌| 147/154 [00:31<00:01,  4.57it/s] 96%|█████████▌| 148/154 [00:32<00:01,  4.53it/s] 97%|█████████▋| 149/154 [00:32<00:01,  4.67it/s] 97%|█████████▋| 150/154 [00:32<00:00,  4.67it/s] 98%|█████████▊| 151/154 [00:32<00:00,  4.53it/s] 99%|█████████▊| 152/154 [00:32<00:00,  4.73it/s] 99%|█████████▉| 153/154 [00:33<00:00,  4.58it/s]100%|██████████| 154/154 [00:33<00:00,  4.61it/s]
2023-07-10 16:25:50,343 Computing features for evaluation...
  0%|          | 0/155 [00:00<?, ?it/s]/ceph/hpc/home/eujongc/anaconda3/envs/latentops/lib/python3.9/site-packages/torch/utils/data/dataloader.py:554: UserWarning: This DataLoader will create 4 worker processes in total. Our suggested max number of worker in current system is 2, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(_create_warning_msg(
  1%|          | 1/155 [00:00<00:49,  3.11it/s]  1%|▏         | 2/155 [00:00<00:38,  3.95it/s]  2%|▏         | 3/155 [00:00<00:35,  4.28it/s]  3%|▎         | 4/155 [00:01<00:37,  4.01it/s]  3%|▎         | 5/155 [00:01<00:36,  4.09it/s]  4%|▍         | 6/155 [00:01<00:34,  4.34it/s]  5%|▍         | 7/155 [00:01<00:33,  4.39it/s]  5%|▌         | 8/155 [00:01<00:32,  4.48it/s]  6%|▌         | 9/155 [00:02<00:32,  4.52it/s]  6%|▋         | 10/155 [00:02<00:31,  4.58it/s]  7%|▋         | 11/155 [00:02<00:32,  4.44it/s]  8%|▊         | 12/155 [00:02<00:31,  4.53it/s]  8%|▊         | 13/155 [00:02<00:31,  4.48it/s]  9%|▉         | 14/155 [00:03<00:32,  4.40it/s] 10%|▉         | 15/155 [00:03<00:32,  4.28it/s] 10%|█         | 16/155 [00:03<00:37,  3.75it/s] 11%|█         | 17/155 [00:04<00:35,  3.92it/s] 12%|█▏        | 18/155 [00:04<00:34,  4.00it/s] 12%|█▏        | 19/155 [00:04<00:32,  4.24it/s] 13%|█▎        | 20/155 [00:04<00:31,  4.27it/s] 14%|█▎        | 21/155 [00:04<00:30,  4.45it/s] 14%|█▍        | 22/155 [00:05<00:28,  4.65it/s] 15%|█▍        | 23/155 [00:05<00:28,  4.63it/s] 15%|█▌        | 24/155 [00:05<00:28,  4.57it/s] 16%|█▌        | 25/155 [00:05<00:27,  4.67it/s] 17%|█▋        | 26/155 [00:06<00:28,  4.51it/s] 17%|█▋        | 27/155 [00:06<00:28,  4.56it/s] 18%|█▊        | 28/155 [00:06<00:27,  4.65it/s] 19%|█▊        | 29/155 [00:06<00:27,  4.51it/s] 19%|█▉        | 30/155 [00:06<00:28,  4.41it/s] 20%|██        | 31/155 [00:07<00:28,  4.35it/s] 21%|██        | 32/155 [00:07<00:27,  4.51it/s] 21%|██▏       | 33/155 [00:07<00:26,  4.56it/s] 22%|██▏       | 34/155 [00:07<00:26,  4.52it/s] 23%|██▎       | 35/155 [00:08<00:26,  4.49it/s] 23%|██▎       | 36/155 [00:08<00:26,  4.42it/s] 24%|██▍       | 37/155 [00:08<00:27,  4.28it/s] 25%|██▍       | 38/155 [00:08<00:26,  4.39it/s] 25%|██▌       | 39/155 [00:08<00:25,  4.47it/s] 26%|██▌       | 40/155 [00:09<00:24,  4.61it/s] 26%|██▋       | 41/155 [00:09<00:25,  4.47it/s] 27%|██▋       | 42/155 [00:09<00:24,  4.55it/s] 28%|██▊       | 43/155 [00:09<00:24,  4.58it/s] 28%|██▊       | 44/155 [00:10<00:24,  4.54it/s] 29%|██▉       | 45/155 [00:10<00:23,  4.67it/s] 30%|██▉       | 46/155 [00:10<00:24,  4.51it/s] 30%|███       | 47/155 [00:10<00:24,  4.49it/s] 31%|███       | 48/155 [00:10<00:23,  4.47it/s] 32%|███▏      | 49/155 [00:11<00:23,  4.61it/s] 32%|███▏      | 50/155 [00:11<00:23,  4.50it/s] 33%|███▎      | 51/155 [00:11<00:23,  4.47it/s] 34%|███▎      | 52/155 [00:11<00:23,  4.31it/s] 34%|███▍      | 53/155 [00:12<00:23,  4.38it/s] 35%|███▍      | 54/155 [00:12<00:22,  4.55it/s] 35%|███▌      | 55/155 [00:12<00:21,  4.59it/s] 36%|███▌      | 56/155 [00:12<00:21,  4.60it/s] 37%|███▋      | 57/155 [00:12<00:21,  4.54it/s] 37%|███▋      | 58/155 [00:13<00:21,  4.50it/s] 38%|███▊      | 59/155 [00:13<00:21,  4.52it/s] 39%|███▊      | 60/155 [00:13<00:20,  4.66it/s] 39%|███▉      | 61/155 [00:13<00:21,  4.36it/s] 40%|████      | 62/155 [00:14<00:20,  4.47it/s] 41%|████      | 63/155 [00:14<00:20,  4.54it/s] 41%|████▏     | 64/155 [00:14<00:20,  4.55it/s] 42%|████▏     | 65/155 [00:14<00:19,  4.73it/s] 43%|████▎     | 66/155 [00:14<00:19,  4.61it/s] 43%|████▎     | 67/155 [00:15<00:18,  4.69it/s] 44%|████▍     | 68/155 [00:15<00:18,  4.79it/s] 45%|████▍     | 69/155 [00:15<00:18,  4.69it/s] 45%|████▌     | 70/155 [00:15<00:18,  4.61it/s] 46%|████▌     | 71/155 [00:15<00:18,  4.62it/s] 46%|████▋     | 72/155 [00:16<00:19,  4.28it/s] 47%|████▋     | 73/155 [00:16<00:20,  4.05it/s] 48%|████▊     | 74/155 [00:16<00:19,  4.14it/s] 48%|████▊     | 75/155 [00:16<00:18,  4.30it/s] 49%|████▉     | 76/155 [00:17<00:17,  4.39it/s] 50%|████▉     | 77/155 [00:17<00:17,  4.39it/s] 50%|█████     | 78/155 [00:17<00:17,  4.42it/s] 51%|█████     | 79/155 [00:17<00:16,  4.63it/s] 52%|█████▏    | 80/155 [00:17<00:15,  4.80it/s] 52%|█████▏    | 81/155 [00:18<00:16,  4.59it/s] 53%|█████▎    | 82/155 [00:18<00:15,  4.61it/s] 54%|█████▎    | 83/155 [00:18<00:16,  4.42it/s] 54%|█████▍    | 84/155 [00:18<00:15,  4.54it/s] 55%|█████▍    | 85/155 [00:19<00:15,  4.57it/s] 55%|█████▌    | 86/155 [00:19<00:14,  4.61it/s] 56%|█████▌    | 87/155 [00:19<00:14,  4.68it/s] 57%|█████▋    | 88/155 [00:19<00:14,  4.76it/s] 57%|█████▋    | 89/155 [00:19<00:13,  4.89it/s] 58%|█████▊    | 90/155 [00:20<00:13,  4.83it/s] 59%|█████▊    | 91/155 [00:20<00:13,  4.79it/s] 59%|█████▉    | 92/155 [00:20<00:13,  4.83it/s] 60%|██████    | 93/155 [00:20<00:12,  4.92it/s] 61%|██████    | 94/155 [00:20<00:12,  4.88it/s] 61%|██████▏   | 95/155 [00:21<00:12,  4.80it/s] 62%|██████▏   | 96/155 [00:21<00:12,  4.68it/s] 63%|██████▎   | 97/155 [00:21<00:12,  4.74it/s] 63%|██████▎   | 98/155 [00:21<00:12,  4.65it/s] 64%|██████▍   | 99/155 [00:22<00:11,  4.72it/s] 65%|██████▍   | 100/155 [00:22<00:11,  4.61it/s] 65%|██████▌   | 101/155 [00:22<00:11,  4.62it/s] 66%|██████▌   | 102/155 [00:22<00:11,  4.63it/s] 66%|██████▋   | 103/155 [00:22<00:11,  4.48it/s] 67%|██████▋   | 104/155 [00:23<00:11,  4.53it/s] 68%|██████▊   | 105/155 [00:23<00:10,  4.55it/s] 68%|██████▊   | 106/155 [00:23<00:10,  4.52it/s] 69%|██████▉   | 107/155 [00:23<00:10,  4.58it/s] 70%|██████▉   | 108/155 [00:24<00:10,  4.52it/s] 70%|███████   | 109/155 [00:24<00:10,  4.59it/s] 71%|███████   | 110/155 [00:24<00:09,  4.60it/s] 72%|███████▏  | 111/155 [00:24<00:09,  4.78it/s] 72%|███████▏  | 112/155 [00:24<00:09,  4.67it/s] 73%|███████▎  | 113/155 [00:25<00:09,  4.65it/s] 74%|███████▎  | 114/155 [00:25<00:09,  4.45it/s] 74%|███████▍  | 115/155 [00:25<00:09,  4.36it/s] 75%|███████▍  | 116/155 [00:25<00:08,  4.52it/s] 75%|███████▌  | 117/155 [00:25<00:08,  4.49it/s] 76%|███████▌  | 118/155 [00:26<00:07,  4.68it/s] 77%|███████▋  | 119/155 [00:26<00:08,  4.31it/s] 77%|███████▋  | 120/155 [00:26<00:07,  4.41it/s] 78%|███████▊  | 121/155 [00:26<00:07,  4.28it/s] 79%|███████▊  | 122/155 [00:27<00:07,  4.39it/s] 79%|███████▉  | 123/155 [00:27<00:07,  4.46it/s] 80%|████████  | 124/155 [00:27<00:07,  4.36it/s] 81%|████████  | 125/155 [00:27<00:06,  4.55it/s] 81%|████████▏ | 126/155 [00:28<00:06,  4.55it/s] 82%|████████▏ | 127/155 [00:28<00:05,  4.68it/s] 83%|████████▎ | 128/155 [00:28<00:05,  4.53it/s] 83%|████████▎ | 129/155 [00:28<00:05,  4.41it/s] 84%|████████▍ | 130/155 [00:28<00:05,  4.35it/s] 85%|████████▍ | 131/155 [00:29<00:05,  4.25it/s] 85%|████████▌ | 132/155 [00:29<00:05,  4.44it/s] 86%|████████▌ | 133/155 [00:29<00:04,  4.52it/s] 86%|████████▋ | 134/155 [00:29<00:04,  4.42it/s] 87%|████████▋ | 135/155 [00:30<00:04,  4.52it/s] 88%|████████▊ | 136/155 [00:30<00:04,  4.62it/s] 88%|████████▊ | 137/155 [00:30<00:03,  4.72it/s] 89%|████████▉ | 138/155 [00:30<00:03,  4.56it/s] 90%|████████▉ | 139/155 [00:30<00:03,  4.52it/s] 90%|█████████ | 140/155 [00:31<00:03,  4.51it/s] 91%|█████████ | 141/155 [00:31<00:03,  4.48it/s] 92%|█████████▏| 142/155 [00:31<00:02,  4.61it/s] 92%|█████████▏| 143/155 [00:31<00:02,  4.73it/s] 93%|█████████▎| 144/155 [00:31<00:02,  4.48it/s] 94%|█████████▎| 145/155 [00:32<00:02,  4.51it/s] 94%|█████████▍| 146/155 [00:32<00:01,  4.63it/s] 95%|█████████▍| 147/155 [00:32<00:01,  4.64it/s] 95%|█████████▌| 148/155 [00:32<00:01,  4.74it/s] 96%|█████████▌| 149/155 [00:33<00:01,  4.66it/s] 97%|█████████▋| 150/155 [00:33<00:01,  4.72it/s] 97%|█████████▋| 151/155 [00:33<00:00,  4.77it/s] 98%|█████████▊| 152/155 [00:33<00:00,  4.86it/s] 99%|█████████▊| 153/155 [00:33<00:00,  4.90it/s] 99%|█████████▉| 154/155 [00:34<00:00,  4.50it/s]100%|██████████| 155/155 [00:34<00:00,  4.52it/s]
+-------+------------------------+--------------------+-------------+-------------+-----------+----------+
| epoch |           lr           |     train_loss     | val_top1acc | val_top3acc | val_ndcg1 | val_mrr3 |
+-------+------------------------+--------------------+-------------+-------------+-----------+----------+
|   0   | 4.999999999999982e-05  | 2.821789560880203  |    34.98    |    67.35    |   59.94   |  49.07   |
|   1   | 4.995165484649251e-05  | 1.6432694615755539 |    59.23    |    84.22    |   77.79   |  70.30   |
|   2   | 4.9806810182204925e-05 | 1.0274988912599055 |    62.82    |    87.69    |   80.37   |  73.81   |
+-------+------------------------+--------------------+-------------+-------------+-----------+----------+
/ceph/hpc/home/eujongc/anaconda3/envs/latentops/lib/python3.9/site-packages/torch/utils/data/dataloader.py:554: UserWarning: This DataLoader will create 4 worker processes in total. Our suggested max number of worker in current system is 2, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(_create_warning_msg(
Train Epoch: [3]  [  0/229]  eta: 0:04:39  lr: 0.000050  loss: 0.5515  time: 1.2209  data: 0.1208  max mem: 30242
Train Epoch: [3]  [ 50/229]  eta: 0:03:18  lr: 0.000050  loss: 0.7648  time: 1.1057  data: 0.0001  max mem: 30242
Train Epoch: [3]  [100/229]  eta: 0:02:22  lr: 0.000050  loss: 0.9080  time: 1.1188  data: 0.0001  max mem: 30242
Train Epoch: [3]  [150/229]  eta: 0:01:27  lr: 0.000050  loss: 0.3472  time: 1.1205  data: 0.0001  max mem: 30242
Train Epoch: [3]  [200/229]  eta: 0:00:32  lr: 0.000050  loss: 0.5033  time: 1.1317  data: 0.0001  max mem: 30242
Train Epoch: [3]  [228/229]  eta: 0:00:01  lr: 0.000050  loss: 0.7636  time: 1.1208  data: 0.0001  max mem: 30242
2023-07-10 16:30:40,302 Train Epoch: [3] Total time: 0:04:15 (1.1144 s / it)
2023-07-10 16:30:40,305 Computing features for evaluation...
  0%|          | 0/154 [00:00<?, ?it/s]  1%|          | 1/154 [00:00<00:50,  3.01it/s]  1%|▏         | 2/154 [00:00<00:39,  3.87it/s]  2%|▏         | 3/154 [00:00<00:35,  4.21it/s]  3%|▎         | 4/154 [00:00<00:33,  4.42it/s]  3%|▎         | 5/154 [00:01<00:34,  4.36it/s]  4%|▍         | 6/154 [00:01<00:32,  4.55it/s]  5%|▍         | 7/154 [00:01<00:30,  4.80it/s]  5%|▌         | 8/154 [00:01<00:31,  4.69it/s]  6%|▌         | 9/154 [00:02<00:31,  4.60it/s]  6%|▋         | 10/154 [00:02<00:30,  4.71it/s]  7%|▋         | 11/154 [00:02<00:31,  4.53it/s]  8%|▊         | 12/154 [00:02<00:31,  4.51it/s]  8%|▊         | 13/154 [00:02<00:30,  4.56it/s]  9%|▉         | 14/154 [00:03<00:30,  4.52it/s] 10%|▉         | 15/154 [00:03<00:30,  4.55it/s] 10%|█         | 16/154 [00:03<00:29,  4.73it/s] 11%|█         | 17/154 [00:03<00:29,  4.70it/s] 12%|█▏        | 18/154 [00:03<00:28,  4.69it/s] 12%|█▏        | 19/154 [00:04<00:29,  4.51it/s] 13%|█▎        | 20/154 [00:04<00:29,  4.50it/s] 14%|█▎        | 21/154 [00:04<00:28,  4.69it/s] 14%|█▍        | 22/154 [00:04<00:27,  4.82it/s] 15%|█▍        | 23/154 [00:05<00:26,  4.87it/s] 16%|█▌        | 24/154 [00:05<00:27,  4.81it/s] 16%|█▌        | 25/154 [00:05<00:26,  4.79it/s] 17%|█▋        | 26/154 [00:05<00:26,  4.74it/s] 18%|█▊        | 27/154 [00:05<00:26,  4.82it/s] 18%|█▊        | 28/154 [00:06<00:26,  4.70it/s] 19%|█▉        | 29/154 [00:06<00:26,  4.78it/s] 19%|█▉        | 30/154 [00:06<00:25,  4.84it/s] 20%|██        | 31/154 [00:06<00:25,  4.78it/s] 21%|██        | 32/154 [00:06<00:25,  4.83it/s] 21%|██▏       | 33/154 [00:07<00:25,  4.78it/s] 22%|██▏       | 34/154 [00:07<00:25,  4.65it/s] 23%|██▎       | 35/154 [00:07<00:25,  4.73it/s] 23%|██▎       | 36/154 [00:07<00:25,  4.71it/s] 24%|██▍       | 37/154 [00:07<00:25,  4.66it/s] 25%|██▍       | 38/154 [00:08<00:24,  4.72it/s] 25%|██▌       | 39/154 [00:08<00:23,  4.80it/s] 26%|██▌       | 40/154 [00:08<00:23,  4.77it/s] 27%|██▋       | 41/154 [00:08<00:24,  4.58it/s] 27%|██▋       | 42/154 [00:09<00:24,  4.52it/s] 28%|██▊       | 43/154 [00:09<00:24,  4.50it/s] 29%|██▊       | 44/154 [00:09<00:23,  4.72it/s] 29%|██▉       | 45/154 [00:09<00:23,  4.62it/s] 30%|██▉       | 46/154 [00:09<00:22,  4.74it/s] 31%|███       | 47/154 [00:10<00:22,  4.72it/s] 31%|███       | 48/154 [00:10<00:22,  4.76it/s] 32%|███▏      | 49/154 [00:10<00:22,  4.72it/s] 32%|███▏      | 50/154 [00:10<00:22,  4.63it/s] 33%|███▎      | 51/154 [00:10<00:21,  4.72it/s] 34%|███▍      | 52/154 [00:11<00:22,  4.60it/s] 34%|███▍      | 53/154 [00:11<00:22,  4.58it/s] 35%|███▌      | 54/154 [00:11<00:21,  4.69it/s] 36%|███▌      | 55/154 [00:11<00:21,  4.62it/s] 36%|███▋      | 56/154 [00:12<00:21,  4.57it/s] 37%|███▋      | 57/154 [00:12<00:20,  4.70it/s] 38%|███▊      | 58/154 [00:12<00:20,  4.68it/s] 38%|███▊      | 59/154 [00:12<00:20,  4.73it/s] 39%|███▉      | 60/154 [00:12<00:20,  4.56it/s] 40%|███▉      | 61/154 [00:13<00:20,  4.58it/s] 40%|████      | 62/154 [00:13<00:19,  4.62it/s] 41%|████      | 63/154 [00:13<00:19,  4.62it/s] 42%|████▏     | 64/154 [00:13<00:19,  4.71it/s] 42%|████▏     | 65/154 [00:14<00:19,  4.50it/s] 43%|████▎     | 66/154 [00:14<00:20,  4.39it/s] 44%|████▎     | 67/154 [00:14<00:19,  4.40it/s] 44%|████▍     | 68/154 [00:14<00:18,  4.54it/s] 45%|████▍     | 69/154 [00:14<00:18,  4.57it/s] 45%|████▌     | 70/154 [00:15<00:17,  4.68it/s] 46%|████▌     | 71/154 [00:15<00:17,  4.67it/s] 47%|████▋     | 72/154 [00:15<00:17,  4.60it/s] 47%|████▋     | 73/154 [00:15<00:17,  4.61it/s] 48%|████▊     | 74/154 [00:15<00:17,  4.61it/s] 49%|████▊     | 75/154 [00:16<00:17,  4.61it/s] 49%|████▉     | 76/154 [00:16<00:17,  4.45it/s] 50%|█████     | 77/154 [00:16<00:16,  4.58it/s] 51%|█████     | 78/154 [00:16<00:16,  4.54it/s] 51%|█████▏    | 79/154 [00:17<00:16,  4.62it/s] 52%|█████▏    | 80/154 [00:17<00:16,  4.44it/s] 53%|█████▎    | 81/154 [00:17<00:15,  4.64it/s] 53%|█████▎    | 82/154 [00:17<00:15,  4.74it/s] 54%|█████▍    | 83/154 [00:17<00:15,  4.62it/s] 55%|█████▍    | 84/154 [00:18<00:15,  4.66it/s] 55%|█████▌    | 85/154 [00:18<00:14,  4.83it/s] 56%|█████▌    | 86/154 [00:18<00:14,  4.70it/s] 56%|█████▋    | 87/154 [00:18<00:14,  4.69it/s] 57%|█████▋    | 88/154 [00:19<00:14,  4.54it/s] 58%|█████▊    | 89/154 [00:19<00:14,  4.55it/s] 58%|█████▊    | 90/154 [00:19<00:13,  4.66it/s] 59%|█████▉    | 91/154 [00:19<00:13,  4.66it/s] 60%|█████▉    | 92/154 [00:19<00:14,  4.22it/s] 60%|██████    | 93/154 [00:20<00:14,  4.26it/s] 61%|██████    | 94/154 [00:20<00:14,  4.20it/s] 62%|██████▏   | 95/154 [00:20<00:14,  4.20it/s] 62%|██████▏   | 96/154 [00:20<00:13,  4.21it/s] 63%|██████▎   | 97/154 [00:21<00:13,  4.28it/s] 64%|██████▎   | 98/154 [00:21<00:12,  4.47it/s] 64%|██████▍   | 99/154 [00:21<00:12,  4.41it/s] 65%|██████▍   | 100/154 [00:21<00:12,  4.36it/s] 66%|██████▌   | 101/154 [00:22<00:11,  4.46it/s] 66%|██████▌   | 102/154 [00:22<00:11,  4.61it/s] 67%|██████▋   | 103/154 [00:22<00:11,  4.61it/s] 68%|██████▊   | 104/154 [00:22<00:10,  4.62it/s] 68%|██████▊   | 105/154 [00:22<00:10,  4.63it/s] 69%|██████▉   | 106/154 [00:23<00:10,  4.70it/s] 69%|██████▉   | 107/154 [00:23<00:10,  4.65it/s] 70%|███████   | 108/154 [00:23<00:10,  4.49it/s] 71%|███████   | 109/154 [00:23<00:09,  4.63it/s] 71%|███████▏  | 110/154 [00:23<00:09,  4.49it/s] 72%|███████▏  | 111/154 [00:24<00:09,  4.59it/s] 73%|███████▎  | 112/154 [00:24<00:09,  4.54it/s] 73%|███████▎  | 113/154 [00:24<00:08,  4.57it/s] 74%|███████▍  | 114/154 [00:24<00:08,  4.67it/s] 75%|███████▍  | 115/154 [00:25<00:08,  4.67it/s] 75%|███████▌  | 116/154 [00:25<00:08,  4.69it/s] 76%|███████▌  | 117/154 [00:25<00:07,  4.74it/s] 77%|███████▋  | 118/154 [00:25<00:07,  4.70it/s] 77%|███████▋  | 119/154 [00:25<00:07,  4.77it/s] 78%|███████▊  | 120/154 [00:26<00:06,  4.91it/s] 79%|███████▊  | 121/154 [00:26<00:06,  4.91it/s] 79%|███████▉  | 122/154 [00:26<00:06,  4.92it/s] 80%|███████▉  | 123/154 [00:26<00:06,  4.67it/s] 81%|████████  | 124/154 [00:26<00:06,  4.66it/s] 81%|████████  | 125/154 [00:27<00:06,  4.74it/s] 82%|████████▏ | 126/154 [00:27<00:06,  4.58it/s] 82%|████████▏ | 127/154 [00:27<00:05,  4.59it/s] 83%|████████▎ | 128/154 [00:27<00:06,  4.33it/s] 84%|████████▍ | 129/154 [00:28<00:05,  4.43it/s] 84%|████████▍ | 130/154 [00:28<00:05,  4.48it/s] 85%|████████▌ | 131/154 [00:28<00:05,  4.52it/s] 86%|████████▌ | 132/154 [00:28<00:04,  4.65it/s] 86%|████████▋ | 133/154 [00:28<00:04,  4.58it/s] 87%|████████▋ | 134/154 [00:29<00:04,  4.38it/s] 88%|████████▊ | 135/154 [00:29<00:04,  4.47it/s] 88%|████████▊ | 136/154 [00:29<00:03,  4.65it/s] 89%|████████▉ | 137/154 [00:29<00:03,  4.71it/s] 90%|████████▉ | 138/154 [00:29<00:03,  4.85it/s] 90%|█████████ | 139/154 [00:30<00:03,  4.87it/s] 91%|█████████ | 140/154 [00:30<00:02,  4.73it/s] 92%|█████████▏| 141/154 [00:30<00:02,  4.71it/s] 92%|█████████▏| 142/154 [00:30<00:02,  4.70it/s] 93%|█████████▎| 143/154 [00:31<00:02,  4.70it/s] 94%|█████████▎| 144/154 [00:31<00:02,  4.59it/s] 94%|█████████▍| 145/154 [00:31<00:01,  4.77it/s] 95%|█████████▍| 146/154 [00:31<00:01,  4.73it/s] 95%|█████████▌| 147/154 [00:31<00:01,  4.57it/s] 96%|█████████▌| 148/154 [00:32<00:01,  4.53it/s] 97%|█████████▋| 149/154 [00:32<00:01,  4.67it/s] 97%|█████████▋| 150/154 [00:32<00:00,  4.67it/s] 98%|█████████▊| 151/154 [00:32<00:00,  4.53it/s] 99%|█████████▊| 152/154 [00:32<00:00,  4.73it/s] 99%|█████████▉| 153/154 [00:33<00:00,  4.58it/s]100%|██████████| 154/154 [00:33<00:00,  4.62it/s]
2023-07-10 16:31:15,066 Computing features for evaluation...
  0%|          | 0/155 [00:00<?, ?it/s]/ceph/hpc/home/eujongc/anaconda3/envs/latentops/lib/python3.9/site-packages/torch/utils/data/dataloader.py:554: UserWarning: This DataLoader will create 4 worker processes in total. Our suggested max number of worker in current system is 2, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(_create_warning_msg(
  1%|          | 1/155 [00:00<00:49,  3.10it/s]  1%|▏         | 2/155 [00:00<00:38,  3.94it/s]  2%|▏         | 3/155 [00:00<00:35,  4.27it/s]  3%|▎         | 4/155 [00:01<00:37,  4.00it/s]  3%|▎         | 5/155 [00:01<00:36,  4.09it/s]  4%|▍         | 6/155 [00:01<00:34,  4.34it/s]  5%|▍         | 7/155 [00:01<00:33,  4.38it/s]  5%|▌         | 8/155 [00:01<00:32,  4.48it/s]  6%|▌         | 9/155 [00:02<00:32,  4.52it/s]  6%|▋         | 10/155 [00:02<00:31,  4.58it/s]  7%|▋         | 11/155 [00:02<00:32,  4.44it/s]  8%|▊         | 12/155 [00:02<00:31,  4.53it/s]  8%|▊         | 13/155 [00:02<00:31,  4.48it/s]  9%|▉         | 14/155 [00:03<00:32,  4.39it/s] 10%|▉         | 15/155 [00:03<00:32,  4.28it/s] 10%|█         | 16/155 [00:03<00:30,  4.53it/s] 11%|█         | 17/155 [00:03<00:30,  4.48it/s] 12%|█▏        | 18/155 [00:04<00:31,  4.39it/s] 12%|█▏        | 19/155 [00:04<00:29,  4.54it/s] 13%|█▎        | 20/155 [00:04<00:30,  4.48it/s] 14%|█▎        | 21/155 [00:04<00:29,  4.61it/s] 14%|█▍        | 22/155 [00:04<00:27,  4.77it/s] 15%|█▍        | 23/155 [00:05<00:28,  4.71it/s] 15%|█▌        | 24/155 [00:05<00:28,  4.62it/s] 16%|█▌        | 25/155 [00:05<00:27,  4.71it/s] 17%|█▋        | 26/155 [00:05<00:28,  4.53it/s] 17%|█▋        | 27/155 [00:06<00:27,  4.57it/s] 18%|█▊        | 28/155 [00:06<00:27,  4.66it/s] 19%|█▊        | 29/155 [00:06<00:27,  4.52it/s] 19%|█▉        | 30/155 [00:06<00:28,  4.42it/s] 20%|██        | 31/155 [00:06<00:28,  4.36it/s] 21%|██        | 32/155 [00:07<00:27,  4.52it/s] 21%|██▏       | 33/155 [00:07<00:26,  4.56it/s] 22%|██▏       | 34/155 [00:07<00:26,  4.52it/s] 23%|██▎       | 35/155 [00:07<00:26,  4.49it/s] 23%|██▎       | 36/155 [00:08<00:26,  4.42it/s] 24%|██▍       | 37/155 [00:08<00:27,  4.28it/s] 25%|██▍       | 38/155 [00:08<00:26,  4.39it/s] 25%|██▌       | 39/155 [00:08<00:25,  4.47it/s] 26%|██▌       | 40/155 [00:08<00:24,  4.61it/s] 26%|██▋       | 41/155 [00:09<00:25,  4.47it/s] 27%|██▋       | 42/155 [00:09<00:24,  4.55it/s] 28%|██▊       | 43/155 [00:09<00:24,  4.58it/s] 28%|██▊       | 44/155 [00:09<00:24,  4.54it/s] 29%|██▉       | 45/155 [00:10<00:23,  4.66it/s] 30%|██▉       | 46/155 [00:10<00:24,  4.51it/s] 30%|███       | 47/155 [00:10<00:24,  4.49it/s] 31%|███       | 48/155 [00:10<00:23,  4.48it/s] 32%|███▏      | 49/155 [00:10<00:23,  4.61it/s] 32%|███▏      | 50/155 [00:11<00:23,  4.49it/s] 33%|███▎      | 51/155 [00:11<00:23,  4.47it/s] 34%|███▎      | 52/155 [00:11<00:23,  4.31it/s] 34%|███▍      | 53/155 [00:11<00:23,  4.38it/s] 35%|███▍      | 54/155 [00:12<00:22,  4.55it/s] 35%|███▌      | 55/155 [00:12<00:21,  4.59it/s] 36%|███▌      | 56/155 [00:12<00:21,  4.60it/s] 37%|███▋      | 57/155 [00:12<00:21,  4.54it/s] 37%|███▋      | 58/155 [00:12<00:21,  4.50it/s] 38%|███▊      | 59/155 [00:13<00:21,  4.53it/s] 39%|███▊      | 60/155 [00:13<00:20,  4.66it/s] 39%|███▉      | 61/155 [00:13<00:21,  4.36it/s] 40%|████      | 62/155 [00:13<00:20,  4.47it/s] 41%|████      | 63/155 [00:14<00:20,  4.54it/s] 41%|████▏     | 64/155 [00:14<00:20,  4.54it/s] 42%|████▏     | 65/155 [00:14<00:19,  4.72it/s] 43%|████▎     | 66/155 [00:14<00:19,  4.60it/s] 43%|████▎     | 67/155 [00:14<00:18,  4.69it/s] 44%|████▍     | 68/155 [00:15<00:18,  4.78it/s] 45%|████▍     | 69/155 [00:15<00:18,  4.69it/s] 45%|████▌     | 70/155 [00:15<00:18,  4.61it/s] 46%|████▌     | 71/155 [00:15<00:18,  4.62it/s] 46%|████▋     | 72/155 [00:16<00:19,  4.28it/s] 47%|████▋     | 73/155 [00:16<00:20,  4.05it/s] 48%|████▊     | 74/155 [00:16<00:19,  4.14it/s] 48%|████▊     | 75/155 [00:16<00:18,  4.30it/s] 49%|████▉     | 76/155 [00:16<00:17,  4.40it/s] 50%|████▉     | 77/155 [00:17<00:17,  4.39it/s] 50%|█████     | 78/155 [00:17<00:17,  4.42it/s] 51%|█████     | 79/155 [00:17<00:16,  4.62it/s] 52%|█████▏    | 80/155 [00:17<00:15,  4.80it/s] 52%|█████▏    | 81/155 [00:18<00:16,  4.59it/s] 53%|█████▎    | 82/155 [00:18<00:15,  4.61it/s] 54%|█████▎    | 83/155 [00:18<00:16,  4.42it/s] 54%|█████▍    | 84/155 [00:18<00:15,  4.54it/s] 55%|█████▍    | 85/155 [00:18<00:15,  4.57it/s] 55%|█████▌    | 86/155 [00:19<00:14,  4.61it/s] 56%|█████▌    | 87/155 [00:19<00:14,  4.68it/s] 57%|█████▋    | 88/155 [00:19<00:14,  4.76it/s] 57%|█████▋    | 89/155 [00:19<00:13,  4.89it/s] 58%|█████▊    | 90/155 [00:19<00:13,  4.83it/s] 59%|█████▊    | 91/155 [00:20<00:13,  4.79it/s] 59%|█████▉    | 92/155 [00:20<00:13,  4.84it/s] 60%|██████    | 93/155 [00:20<00:12,  4.92it/s] 61%|██████    | 94/155 [00:20<00:12,  4.89it/s] 61%|██████▏   | 95/155 [00:21<00:12,  4.82it/s] 62%|██████▏   | 96/155 [00:21<00:12,  4.70it/s] 63%|██████▎   | 97/155 [00:21<00:12,  4.77it/s] 63%|██████▎   | 98/155 [00:21<00:12,  4.67it/s] 64%|██████▍   | 99/155 [00:21<00:11,  4.75it/s] 65%|██████▍   | 100/155 [00:22<00:11,  4.64it/s] 65%|██████▌   | 101/155 [00:22<00:11,  4.64it/s] 66%|██████▌   | 102/155 [00:22<00:11,  4.64it/s] 66%|██████▋   | 103/155 [00:22<00:11,  4.49it/s] 67%|██████▋   | 104/155 [00:22<00:11,  4.53it/s] 68%|██████▊   | 105/155 [00:23<00:10,  4.56it/s] 68%|██████▊   | 106/155 [00:23<00:10,  4.52it/s] 69%|██████▉   | 107/155 [00:23<00:10,  4.58it/s] 70%|██████▉   | 108/155 [00:23<00:10,  4.53it/s] 70%|███████   | 109/155 [00:24<00:10,  4.59it/s] 71%|███████   | 110/155 [00:24<00:09,  4.61it/s] 72%|███████▏  | 111/155 [00:24<00:09,  4.78it/s] 72%|███████▏  | 112/155 [00:24<00:09,  4.68it/s] 73%|███████▎  | 113/155 [00:24<00:09,  4.65it/s] 74%|███████▎  | 114/155 [00:25<00:09,  4.44it/s] 74%|███████▍  | 115/155 [00:25<00:09,  4.36it/s] 75%|███████▍  | 116/155 [00:25<00:08,  4.52it/s] 75%|███████▌  | 117/155 [00:25<00:08,  4.49it/s] 76%|███████▌  | 118/155 [00:26<00:07,  4.69it/s] 77%|███████▋  | 119/155 [00:26<00:08,  4.32it/s] 77%|███████▋  | 120/155 [00:26<00:07,  4.41it/s] 78%|███████▊  | 121/155 [00:26<00:07,  4.29it/s] 79%|███████▊  | 122/155 [00:26<00:07,  4.40it/s] 79%|███████▉  | 123/155 [00:27<00:07,  4.47it/s] 80%|████████  | 124/155 [00:27<00:07,  4.37it/s] 81%|████████  | 125/155 [00:27<00:06,  4.55it/s] 81%|████████▏ | 126/155 [00:27<00:06,  4.56it/s] 82%|████████▏ | 127/155 [00:28<00:05,  4.68it/s] 83%|████████▎ | 128/155 [00:28<00:05,  4.52it/s] 83%|████████▎ | 129/155 [00:28<00:05,  4.41it/s] 84%|████████▍ | 130/155 [00:28<00:05,  4.34it/s] 85%|████████▍ | 131/155 [00:29<00:05,  4.24it/s] 85%|████████▌ | 132/155 [00:29<00:05,  4.42it/s] 86%|████████▌ | 133/155 [00:29<00:04,  4.49it/s] 86%|████████▋ | 134/155 [00:29<00:04,  4.39it/s] 87%|████████▋ | 135/155 [00:29<00:04,  4.49it/s] 88%|████████▊ | 136/155 [00:30<00:04,  4.60it/s] 88%|████████▊ | 137/155 [00:30<00:03,  4.70it/s] 89%|████████▉ | 138/155 [00:30<00:03,  4.55it/s] 90%|████████▉ | 139/155 [00:30<00:03,  4.52it/s] 90%|█████████ | 140/155 [00:30<00:03,  4.51it/s] 91%|█████████ | 141/155 [00:31<00:03,  4.48it/s] 92%|█████████▏| 142/155 [00:31<00:02,  4.62it/s] 92%|█████████▏| 143/155 [00:31<00:02,  4.74it/s] 93%|█████████▎| 144/155 [00:31<00:02,  4.48it/s] 94%|█████████▎| 145/155 [00:32<00:02,  4.51it/s] 94%|█████████▍| 146/155 [00:32<00:01,  4.63it/s] 95%|█████████▍| 147/155 [00:32<00:01,  4.64it/s] 95%|█████████▌| 148/155 [00:32<00:01,  4.74it/s] 96%|█████████▌| 149/155 [00:32<00:01,  4.65it/s] 97%|█████████▋| 150/155 [00:33<00:01,  4.71it/s] 97%|█████████▋| 151/155 [00:33<00:00,  4.77it/s] 98%|█████████▊| 152/155 [00:33<00:00,  4.86it/s] 99%|█████████▊| 153/155 [00:33<00:00,  4.89it/s] 99%|█████████▉| 154/155 [00:33<00:00,  4.50it/s]100%|██████████| 155/155 [00:34<00:00,  4.54it/s]
+-------+------------------------+--------------------+-------------+-------------+-----------+----------+
| epoch |           lr           |     train_loss     | val_top1acc | val_top3acc | val_ndcg1 | val_mrr3 |
+-------+------------------------+--------------------+-------------+-------------+-----------+----------+
|   0   | 4.999999999999982e-05  | 2.821789560880203  |    34.98    |    67.35    |   59.94   |  49.07   |
|   1   | 4.995165484649251e-05  | 1.6432694615755539 |    59.23    |    84.22    |   77.79   |  70.30   |
|   2   | 4.9806810182204925e-05 | 1.0274988912599055 |    62.82    |    87.69    |   80.37   |  73.81   |
|   3   | 4.9566037642853115e-05 | 0.6505238582994219 |    64.90    |    88.54    |   81.42   |  75.51   |
+-------+------------------------+--------------------+-------------+-------------+-----------+----------+
/ceph/hpc/home/eujongc/anaconda3/envs/latentops/lib/python3.9/site-packages/torch/utils/data/dataloader.py:554: UserWarning: This DataLoader will create 4 worker processes in total. Our suggested max number of worker in current system is 2, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(_create_warning_msg(
Train Epoch: [4]  [  0/229]  eta: 0:04:32  lr: 0.000049  loss: 0.6576  time: 1.1919  data: 0.1325  max mem: 30242
Train Epoch: [4]  [ 50/229]  eta: 0:03:18  lr: 0.000049  loss: 0.2763  time: 1.1063  data: 0.0001  max mem: 30242
Train Epoch: [4]  [100/229]  eta: 0:02:23  lr: 0.000049  loss: 0.3958  time: 1.1063  data: 0.0001  max mem: 30242
Train Epoch: [4]  [150/229]  eta: 0:01:28  lr: 0.000049  loss: 0.5366  time: 1.1428  data: 0.0001  max mem: 30242
Train Epoch: [4]  [200/229]  eta: 0:00:32  lr: 0.000049  loss: 0.4106  time: 1.0929  data: 0.0001  max mem: 30242
Train Epoch: [4]  [228/229]  eta: 0:00:01  lr: 0.000049  loss: 0.3418  time: 1.1306  data: 0.0001  max mem: 30242
2023-07-10 16:36:05,563 Train Epoch: [4] Total time: 0:04:15 (1.1174 s / it)
2023-07-10 16:36:05,567 Computing features for evaluation...
  0%|          | 0/154 [00:00<?, ?it/s]  1%|          | 1/154 [00:00<00:51,  2.98it/s]  1%|▏         | 2/154 [00:00<00:39,  3.86it/s]  2%|▏         | 3/154 [00:00<00:35,  4.20it/s]  3%|▎         | 4/154 [00:00<00:33,  4.42it/s]  3%|▎         | 5/154 [00:01<00:34,  4.36it/s]  4%|▍         | 6/154 [00:01<00:32,  4.54it/s]  5%|▍         | 7/154 [00:01<00:30,  4.78it/s]  5%|▌         | 8/154 [00:01<00:31,  4.68it/s]  6%|▌         | 9/154 [00:02<00:31,  4.59it/s]  6%|▋         | 10/154 [00:02<00:30,  4.71it/s]  7%|▋         | 11/154 [00:02<00:31,  4.52it/s]  8%|▊         | 12/154 [00:02<00:31,  4.50it/s]  8%|▊         | 13/154 [00:02<00:30,  4.55it/s]  9%|▉         | 14/154 [00:03<00:31,  4.51it/s] 10%|▉         | 15/154 [00:03<00:30,  4.54it/s] 10%|█         | 16/154 [00:03<00:29,  4.73it/s] 11%|█         | 17/154 [00:03<00:29,  4.69it/s] 12%|█▏        | 18/154 [00:03<00:29,  4.68it/s] 12%|█▏        | 19/154 [00:04<00:29,  4.50it/s] 13%|█▎        | 20/154 [00:04<00:29,  4.49it/s] 14%|█▎        | 21/154 [00:04<00:28,  4.69it/s] 14%|█▍        | 22/154 [00:04<00:27,  4.82it/s] 15%|█▍        | 23/154 [00:05<00:26,  4.87it/s] 16%|█▌        | 24/154 [00:05<00:26,  4.82it/s] 16%|█▌        | 25/154 [00:05<00:26,  4.79it/s] 17%|█▋        | 26/154 [00:05<00:27,  4.74it/s] 18%|█▊        | 27/154 [00:05<00:26,  4.82it/s] 18%|█▊        | 28/154 [00:06<00:26,  4.71it/s] 19%|█▉        | 29/154 [00:06<00:26,  4.78it/s] 19%|█▉        | 30/154 [00:06<00:25,  4.84it/s] 20%|██        | 31/154 [00:06<00:25,  4.78it/s] 21%|██        | 32/154 [00:06<00:25,  4.82it/s] 21%|██▏       | 33/154 [00:07<00:25,  4.78it/s] 22%|██▏       | 34/154 [00:07<00:25,  4.65it/s] 23%|██▎       | 35/154 [00:07<00:25,  4.73it/s] 23%|██▎       | 36/154 [00:07<00:25,  4.71it/s] 24%|██▍       | 37/154 [00:07<00:25,  4.66it/s] 25%|██▍       | 38/154 [00:08<00:24,  4.72it/s] 25%|██▌       | 39/154 [00:08<00:23,  4.80it/s] 26%|██▌       | 40/154 [00:08<00:23,  4.77it/s] 27%|██▋       | 41/154 [00:08<00:24,  4.58it/s] 27%|██▋       | 42/154 [00:09<00:24,  4.53it/s] 28%|██▊       | 43/154 [00:09<00:24,  4.50it/s] 29%|██▊       | 44/154 [00:09<00:23,  4.72it/s] 29%|██▉       | 45/154 [00:09<00:23,  4.62it/s] 30%|██▉       | 46/154 [00:09<00:22,  4.74it/s] 31%|███       | 47/154 [00:10<00:22,  4.72it/s] 31%|███       | 48/154 [00:10<00:22,  4.76it/s] 32%|███▏      | 49/154 [00:10<00:22,  4.72it/s] 32%|███▏      | 50/154 [00:10<00:22,  4.63it/s] 33%|███▎      | 51/154 [00:10<00:21,  4.72it/s] 34%|███▍      | 52/154 [00:11<00:22,  4.61it/s] 34%|███▍      | 53/154 [00:11<00:22,  4.58it/s] 35%|███▌      | 54/154 [00:11<00:21,  4.69it/s] 36%|███▌      | 55/154 [00:11<00:21,  4.62it/s] 36%|███▋      | 56/154 [00:12<00:21,  4.57it/s] 37%|███▋      | 57/154 [00:12<00:20,  4.70it/s] 38%|███▊      | 58/154 [00:12<00:20,  4.68it/s] 38%|███▊      | 59/154 [00:12<00:20,  4.73it/s] 39%|███▉      | 60/154 [00:12<00:20,  4.57it/s] 40%|███▉      | 61/154 [00:13<00:20,  4.58it/s] 40%|████      | 62/154 [00:13<00:19,  4.62it/s] 41%|████      | 63/154 [00:13<00:19,  4.63it/s] 42%|████▏     | 64/154 [00:13<00:19,  4.71it/s] 42%|████▏     | 65/154 [00:14<00:19,  4.49it/s] 43%|████▎     | 66/154 [00:14<00:20,  4.39it/s] 44%|████▎     | 67/154 [00:14<00:19,  4.40it/s] 44%|████▍     | 68/154 [00:14<00:18,  4.55it/s] 45%|████▍     | 69/154 [00:14<00:18,  4.57it/s] 45%|████▌     | 70/154 [00:15<00:17,  4.69it/s] 46%|████▌     | 71/154 [00:15<00:17,  4.67it/s] 47%|████▋     | 72/154 [00:15<00:17,  4.60it/s] 47%|████▋     | 73/154 [00:15<00:17,  4.61it/s] 48%|████▊     | 74/154 [00:15<00:17,  4.62it/s] 49%|████▊     | 75/154 [00:16<00:17,  4.61it/s] 49%|████▉     | 76/154 [00:16<00:17,  4.45it/s] 50%|█████     | 77/154 [00:16<00:16,  4.58it/s] 51%|█████     | 78/154 [00:16<00:16,  4.54it/s] 51%|█████▏    | 79/154 [00:17<00:16,  4.62it/s] 52%|█████▏    | 80/154 [00:17<00:19,  3.70it/s] 53%|█████▎    | 81/154 [00:17<00:18,  4.05it/s] 53%|█████▎    | 82/154 [00:17<00:16,  4.28it/s] 54%|█████▍    | 83/154 [00:18<00:16,  4.31it/s] 55%|█████▍    | 84/154 [00:18<00:15,  4.43it/s] 55%|█████▌    | 85/154 [00:18<00:14,  4.65it/s] 56%|█████▌    | 86/154 [00:18<00:14,  4.58it/s] 56%|█████▋    | 87/154 [00:18<00:14,  4.60it/s] 57%|█████▋    | 88/154 [00:19<00:14,  4.49it/s] 58%|█████▊    | 89/154 [00:19<00:14,  4.51it/s] 58%|█████▊    | 90/154 [00:19<00:13,  4.63it/s] 59%|█████▉    | 91/154 [00:19<00:13,  4.64it/s] 60%|█████▉    | 92/154 [00:20<00:14,  4.21it/s] 60%|██████    | 93/154 [00:20<00:14,  4.26it/s] 61%|██████    | 94/154 [00:20<00:14,  4.20it/s] 62%|██████▏   | 95/154 [00:20<00:14,  4.21it/s] 62%|██████▏   | 96/154 [00:21<00:13,  4.22it/s] 63%|██████▎   | 97/154 [00:21<00:13,  4.28it/s] 64%|██████▎   | 98/154 [00:21<00:12,  4.47it/s] 64%|██████▍   | 99/154 [00:21<00:12,  4.41it/s] 65%|██████▍   | 100/154 [00:21<00:12,  4.36it/s] 66%|██████▌   | 101/154 [00:22<00:11,  4.47it/s] 66%|██████▌   | 102/154 [00:22<00:11,  4.61it/s] 67%|██████▋   | 103/154 [00:22<00:11,  4.61it/s] 68%|██████▊   | 104/154 [00:22<00:10,  4.62it/s] 68%|██████▊   | 105/154 [00:23<00:10,  4.63it/s] 69%|██████▉   | 106/154 [00:23<00:10,  4.71it/s] 69%|██████▉   | 107/154 [00:23<00:10,  4.65it/s] 70%|███████   | 108/154 [00:23<00:10,  4.49it/s] 71%|███████   | 109/154 [00:23<00:09,  4.63it/s] 71%|███████▏  | 110/154 [00:24<00:09,  4.49it/s] 72%|███████▏  | 111/154 [00:24<00:09,  4.59it/s] 73%|███████▎  | 112/154 [00:24<00:09,  4.54it/s] 73%|███████▎  | 113/154 [00:24<00:08,  4.58it/s] 74%|███████▍  | 114/154 [00:24<00:08,  4.68it/s] 75%|███████▍  | 115/154 [00:25<00:08,  4.68it/s] 75%|███████▌  | 116/154 [00:25<00:08,  4.70it/s] 76%|███████▌  | 117/154 [00:25<00:07,  4.75it/s] 77%|███████▋  | 118/154 [00:25<00:07,  4.71it/s] 77%|███████▋  | 119/154 [00:26<00:07,  4.78it/s] 78%|███████▊  | 120/154 [00:26<00:06,  4.92it/s] 79%|███████▊  | 121/154 [00:26<00:06,  4.92it/s] 79%|███████▉  | 122/154 [00:26<00:06,  4.93it/s] 80%|███████▉  | 123/154 [00:26<00:06,  4.68it/s] 81%|████████  | 124/154 [00:27<00:06,  4.66it/s] 81%|████████  | 125/154 [00:27<00:06,  4.74it/s] 82%|████████▏ | 126/154 [00:27<00:06,  4.58it/s] 82%|████████▏ | 127/154 [00:27<00:05,  4.60it/s] 83%|████████▎ | 128/154 [00:27<00:06,  4.33it/s] 84%|████████▍ | 129/154 [00:28<00:05,  4.43it/s] 84%|████████▍ | 130/154 [00:28<00:05,  4.48it/s] 85%|████████▌ | 131/154 [00:28<00:05,  4.53it/s] 86%|████████▌ | 132/154 [00:28<00:04,  4.65it/s] 86%|████████▋ | 133/154 [00:29<00:04,  4.59it/s] 87%|████████▋ | 134/154 [00:29<00:04,  4.39it/s] 88%|████████▊ | 135/154 [00:29<00:04,  4.48it/s] 88%|████████▊ | 136/154 [00:29<00:03,  4.66it/s] 89%|████████▉ | 137/154 [00:29<00:03,  4.72it/s] 90%|████████▉ | 138/154 [00:30<00:03,  4.86it/s] 90%|█████████ | 139/154 [00:30<00:03,  4.87it/s] 91%|█████████ | 140/154 [00:30<00:02,  4.73it/s] 92%|█████████▏| 141/154 [00:30<00:02,  4.72it/s] 92%|█████████▏| 142/154 [00:30<00:02,  4.71it/s] 93%|█████████▎| 143/154 [00:31<00:02,  4.71it/s] 94%|█████████▎| 144/154 [00:31<00:02,  4.60it/s] 94%|█████████▍| 145/154 [00:31<00:01,  4.78it/s] 95%|█████████▍| 146/154 [00:31<00:01,  4.74it/s] 95%|█████████▌| 147/154 [00:32<00:01,  4.58it/s] 96%|█████████▌| 148/154 [00:32<00:01,  4.53it/s] 97%|█████████▋| 149/154 [00:32<00:01,  4.68it/s] 97%|█████████▋| 150/154 [00:32<00:00,  4.68it/s] 98%|█████████▊| 151/154 [00:32<00:00,  4.54it/s] 99%|█████████▊| 152/154 [00:33<00:00,  4.74it/s] 99%|█████████▉| 153/154 [00:33<00:00,  4.58it/s]100%|██████████| 154/154 [00:33<00:00,  4.60it/s]
+-------+------------------------+---------------------+-------------+-------------+-----------+----------+
| epoch |           lr           |      train_loss     | val_top1acc | val_top3acc | val_ndcg1 | val_mrr3 |
+-------+------------------------+---------------------+-------------+-------------+-----------+----------+
|   0   | 4.999999999999982e-05  |  2.821789560880203  |    34.98    |    67.35    |   59.94   |  49.07   |
|   1   | 4.995165484649251e-05  |  1.6432694615755539 |    59.23    |    84.22    |   77.79   |  70.30   |
|   2   | 4.9806810182204925e-05 |  1.0274988912599055 |    62.82    |    87.69    |   80.37   |  73.81   |
|   3   | 4.9566037642853115e-05 |  0.6505238582994219 |    64.90    |    88.54    |   81.42   |  75.51   |
|   4   | 4.923028744765154e-05  | 0.42758957355173394 |    64.33    |    87.93    |   81.29   |  74.93   |
+-------+------------------------+---------------------+-------------+-------------+-----------+----------+
/ceph/hpc/home/eujongc/anaconda3/envs/latentops/lib/python3.9/site-packages/torch/utils/data/dataloader.py:554: UserWarning: This DataLoader will create 4 worker processes in total. Our suggested max number of worker in current system is 2, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(_create_warning_msg(
Train Epoch: [5]  [  0/229]  eta: 0:04:05  lr: 0.000049  loss: 0.2554  time: 1.0741  data: 0.1032  max mem: 30242
Train Epoch: [5]  [ 50/229]  eta: 0:03:21  lr: 0.000049  loss: 0.2184  time: 1.1359  data: 0.0001  max mem: 30242
Train Epoch: [5]  [100/229]  eta: 0:02:23  lr: 0.000049  loss: 0.2677  time: 1.1167  data: 0.0001  max mem: 30242
Train Epoch: [5]  [150/229]  eta: 0:01:27  lr: 0.000049  loss: 0.2258  time: 1.1339  data: 0.0001  max mem: 30242
Train Epoch: [5]  [200/229]  eta: 0:00:32  lr: 0.000049  loss: 0.3768  time: 1.1171  data: 0.0001  max mem: 30242
Train Epoch: [5]  [228/229]  eta: 0:00:01  lr: 0.000049  loss: 0.3669  time: 1.1148  data: 0.0001  max mem: 30242
2023-07-10 16:40:55,219 Train Epoch: [5] Total time: 0:04:15 (1.1165 s / it)
2023-07-10 16:40:55,222 Computing features for evaluation...
  0%|          | 0/154 [00:00<?, ?it/s]  1%|          | 1/154 [00:00<00:51,  2.98it/s]  1%|▏         | 2/154 [00:00<00:39,  3.86it/s]  2%|▏         | 3/154 [00:00<00:35,  4.20it/s]  3%|▎         | 4/154 [00:00<00:33,  4.42it/s]  3%|▎         | 5/154 [00:01<00:34,  4.36it/s]  4%|▍         | 6/154 [00:01<00:32,  4.54it/s]  5%|▍         | 7/154 [00:01<00:30,  4.79it/s]  5%|▌         | 8/154 [00:01<00:31,  4.68it/s]  6%|▌         | 9/154 [00:02<00:31,  4.60it/s]  6%|▋         | 10/154 [00:02<00:30,  4.71it/s]  7%|▋         | 11/154 [00:02<00:31,  4.52it/s]  8%|▊         | 12/154 [00:02<00:31,  4.50it/s]  8%|▊         | 13/154 [00:02<00:30,  4.55it/s]  9%|▉         | 14/154 [00:03<00:37,  3.74it/s] 10%|▉         | 15/154 [00:03<00:35,  3.97it/s] 10%|█         | 16/154 [00:03<00:32,  4.28it/s] 11%|█         | 17/154 [00:03<00:31,  4.38it/s] 12%|█▏        | 18/154 [00:04<00:30,  4.46it/s] 12%|█▏        | 19/154 [00:04<00:30,  4.36it/s] 13%|█▎        | 20/154 [00:04<00:30,  4.39it/s] 14%|█▎        | 21/154 [00:04<00:28,  4.61it/s] 14%|█▍        | 22/154 [00:04<00:27,  4.76it/s] 15%|█▍        | 23/154 [00:05<00:27,  4.83it/s] 16%|█▌        | 24/154 [00:05<00:27,  4.79it/s] 16%|█▌        | 25/154 [00:05<00:27,  4.77it/s] 17%|█▋        | 26/154 [00:05<00:27,  4.73it/s] 18%|█▊        | 27/154 [00:06<00:26,  4.81it/s] 18%|█▊        | 28/154 [00:06<00:26,  4.70it/s] 19%|█▉        | 29/154 [00:06<00:26,  4.78it/s] 19%|█▉        | 30/154 [00:06<00:25,  4.84it/s] 20%|██        | 31/154 [00:06<00:25,  4.78it/s] 21%|██        | 32/154 [00:07<00:25,  4.83it/s] 21%|██▏       | 33/154 [00:07<00:25,  4.78it/s] 22%|██▏       | 34/154 [00:07<00:25,  4.66it/s] 23%|██▎       | 35/154 [00:07<00:25,  4.73it/s] 23%|██▎       | 36/154 [00:07<00:25,  4.71it/s] 24%|██▍       | 37/154 [00:08<00:25,  4.66it/s] 25%|██▍       | 38/154 [00:08<00:24,  4.73it/s] 25%|██▌       | 39/154 [00:08<00:23,  4.80it/s] 26%|██▌       | 40/154 [00:08<00:23,  4.77it/s] 27%|██▋       | 41/154 [00:09<00:24,  4.58it/s] 27%|██▋       | 42/154 [00:09<00:24,  4.53it/s] 28%|██▊       | 43/154 [00:09<00:24,  4.51it/s] 29%|██▊       | 44/154 [00:09<00:23,  4.73it/s] 29%|██▉       | 45/154 [00:09<00:23,  4.62it/s] 30%|██▉       | 46/154 [00:10<00:22,  4.73it/s] 31%|███       | 47/154 [00:10<00:22,  4.72it/s] 31%|███       | 48/154 [00:10<00:22,  4.76it/s] 32%|███▏      | 49/154 [00:10<00:22,  4.72it/s] 32%|███▏      | 50/154 [00:10<00:22,  4.63it/s] 33%|███▎      | 51/154 [00:11<00:21,  4.71it/s] 34%|███▍      | 52/154 [00:11<00:22,  4.60it/s] 34%|███▍      | 53/154 [00:11<00:22,  4.57it/s] 35%|███▌      | 54/154 [00:11<00:21,  4.69it/s] 36%|███▌      | 55/154 [00:12<00:21,  4.62it/s] 36%|███▋      | 56/154 [00:12<00:21,  4.56it/s] 37%|███▋      | 57/154 [00:12<00:20,  4.69it/s] 38%|███▊      | 58/154 [00:12<00:20,  4.68it/s] 38%|███▊      | 59/154 [00:12<00:20,  4.73it/s] 39%|███▉      | 60/154 [00:13<00:20,  4.57it/s] 40%|███▉      | 61/154 [00:13<00:20,  4.58it/s] 40%|████      | 62/154 [00:13<00:19,  4.61it/s] 41%|████      | 63/154 [00:13<00:19,  4.62it/s] 42%|████▏     | 64/154 [00:13<00:19,  4.72it/s] 42%|████▏     | 65/154 [00:14<00:19,  4.49it/s] 43%|████▎     | 66/154 [00:14<00:20,  4.39it/s] 44%|████▎     | 67/154 [00:14<00:19,  4.39it/s] 44%|████▍     | 68/154 [00:14<00:18,  4.54it/s] 45%|████▍     | 69/154 [00:15<00:18,  4.57it/s] 45%|████▌     | 70/154 [00:15<00:17,  4.69it/s] 46%|████▌     | 71/154 [00:15<00:17,  4.67it/s] 47%|████▋     | 72/154 [00:15<00:17,  4.60it/s] 47%|████▋     | 73/154 [00:15<00:17,  4.61it/s] 48%|████▊     | 74/154 [00:16<00:17,  4.62it/s] 49%|████▊     | 75/154 [00:16<00:17,  4.62it/s] 49%|████▉     | 76/154 [00:16<00:17,  4.45it/s] 50%|█████     | 77/154 [00:16<00:16,  4.58it/s] 51%|█████     | 78/154 [00:17<00:16,  4.53it/s] 51%|█████▏    | 79/154 [00:17<00:16,  4.62it/s] 52%|█████▏    | 80/154 [00:17<00:16,  4.44it/s] 53%|█████▎    | 81/154 [00:17<00:15,  4.65it/s] 53%|█████▎    | 82/154 [00:17<00:15,  4.73it/s] 54%|█████▍    | 83/154 [00:18<00:15,  4.61it/s] 55%|█████▍    | 84/154 [00:18<00:15,  4.65it/s] 55%|█████▌    | 85/154 [00:18<00:14,  4.82it/s] 56%|█████▌    | 86/154 [00:18<00:14,  4.70it/s] 56%|█████▋    | 87/154 [00:18<00:14,  4.68it/s] 57%|█████▋    | 88/154 [00:19<00:14,  4.54it/s] 58%|█████▊    | 89/154 [00:19<00:14,  4.54it/s] 58%|█████▊    | 90/154 [00:19<00:13,  4.65it/s] 59%|█████▉    | 91/154 [00:19<00:13,  4.66it/s] 60%|█████▉    | 92/154 [00:20<00:14,  4.22it/s] 60%|██████    | 93/154 [00:20<00:14,  4.27it/s] 61%|██████    | 94/154 [00:20<00:14,  4.20it/s] 62%|██████▏   | 95/154 [00:20<00:14,  4.21it/s] 62%|██████▏   | 96/154 [00:21<00:13,  4.22it/s] 63%|██████▎   | 97/154 [00:21<00:13,  4.29it/s] 64%|██████▎   | 98/154 [00:21<00:12,  4.48it/s] 64%|██████▍   | 99/154 [00:21<00:12,  4.41it/s] 65%|██████▍   | 100/154 [00:21<00:12,  4.36it/s] 66%|██████▌   | 101/154 [00:22<00:11,  4.46it/s] 66%|██████▌   | 102/154 [00:22<00:11,  4.60it/s] 67%|██████▋   | 103/154 [00:22<00:11,  4.60it/s] 68%|██████▊   | 104/154 [00:22<00:10,  4.62it/s] 68%|██████▊   | 105/154 [00:23<00:10,  4.63it/s] 69%|██████▉   | 106/154 [00:23<00:10,  4.70it/s] 69%|██████▉   | 107/154 [00:23<00:10,  4.65it/s] 70%|███████   | 108/154 [00:23<00:10,  4.49it/s] 71%|███████   | 109/154 [00:23<00:09,  4.63it/s] 71%|███████▏  | 110/154 [00:24<00:09,  4.49it/s] 72%|███████▏  | 111/154 [00:24<00:09,  4.59it/s] 73%|███████▎  | 112/154 [00:24<00:09,  4.54it/s] 73%|███████▎  | 113/154 [00:24<00:08,  4.58it/s] 74%|███████▍  | 114/154 [00:24<00:08,  4.68it/s] 75%|███████▍  | 115/154 [00:25<00:08,  4.69it/s] 75%|███████▌  | 116/154 [00:25<00:08,  4.70it/s] 76%|███████▌  | 117/154 [00:25<00:07,  4.75it/s] 77%|███████▋  | 118/154 [00:25<00:07,  4.71it/s] 77%|███████▋  | 119/154 [00:26<00:07,  4.78it/s] 78%|███████▊  | 120/154 [00:26<00:06,  4.92it/s] 79%|███████▊  | 121/154 [00:26<00:06,  4.92it/s] 79%|███████▉  | 122/154 [00:26<00:06,  4.93it/s] 80%|███████▉  | 123/154 [00:26<00:06,  4.68it/s] 81%|████████  | 124/154 [00:27<00:06,  4.66it/s] 81%|████████  | 125/154 [00:27<00:06,  4.74it/s] 82%|████████▏ | 126/154 [00:27<00:06,  4.57it/s] 82%|████████▏ | 127/154 [00:27<00:05,  4.61it/s] 83%|████████▎ | 128/154 [00:27<00:05,  4.34it/s] 84%|████████▍ | 129/154 [00:28<00:05,  4.44it/s] 84%|████████▍ | 130/154 [00:28<00:05,  4.48it/s] 85%|████████▌ | 131/154 [00:28<00:05,  4.53it/s] 86%|████████▌ | 132/154 [00:28<00:04,  4.66it/s] 86%|████████▋ | 133/154 [00:29<00:04,  4.59it/s] 87%|████████▋ | 134/154 [00:29<00:04,  4.39it/s] 88%|████████▊ | 135/154 [00:29<00:04,  4.48it/s] 88%|████████▊ | 136/154 [00:29<00:03,  4.67it/s] 89%|████████▉ | 137/154 [00:29<00:03,  4.72it/s] 90%|████████▉ | 138/154 [00:30<00:03,  4.87it/s] 90%|█████████ | 139/154 [00:30<00:03,  4.87it/s] 91%|█████████ | 140/154 [00:30<00:02,  4.73it/s] 92%|█████████▏| 141/154 [00:30<00:02,  4.72it/s] 92%|█████████▏| 142/154 [00:30<00:02,  4.71it/s] 93%|█████████▎| 143/154 [00:31<00:02,  4.71it/s] 94%|█████████▎| 144/154 [00:31<00:02,  4.60it/s] 94%|█████████▍| 145/154 [00:31<00:01,  4.78it/s] 95%|█████████▍| 146/154 [00:31<00:01,  4.74it/s] 95%|█████████▌| 147/154 [00:32<00:01,  4.58it/s] 96%|█████████▌| 148/154 [00:32<00:01,  4.54it/s] 97%|█████████▋| 149/154 [00:32<00:01,  4.68it/s] 97%|█████████▋| 150/154 [00:32<00:00,  4.68it/s] 98%|█████████▊| 151/154 [00:32<00:00,  4.54it/s] 99%|█████████▊| 152/154 [00:33<00:00,  4.74it/s] 99%|█████████▉| 153/154 [00:33<00:00,  4.59it/s]100%|██████████| 154/154 [00:33<00:00,  4.60it/s]
+-------+------------------------+---------------------+-------------+-------------+-----------+----------+
| epoch |           lr           |      train_loss     | val_top1acc | val_top3acc | val_ndcg1 | val_mrr3 |
+-------+------------------------+---------------------+-------------+-------------+-----------+----------+
|   0   | 4.999999999999982e-05  |  2.821789560880203  |    34.98    |    67.35    |   59.94   |  49.07   |
|   1   | 4.995165484649251e-05  |  1.6432694615755539 |    59.23    |    84.22    |   77.79   |  70.30   |
|   2   | 4.9806810182204925e-05 |  1.0274988912599055 |    62.82    |    87.69    |   80.37   |  73.81   |
|   3   | 4.9566037642853115e-05 |  0.6505238582994219 |    64.90    |    88.54    |   81.42   |  75.51   |
|   4   | 4.923028744765154e-05  | 0.42758957355173394 |    64.33    |    87.93    |   81.29   |  74.93   |
|   5   | 4.880088464923109e-05  | 0.30189239523296274 |    63.92    |    89.52    |   81.53   |  75.43   |
+-------+------------------------+---------------------+-------------+-------------+-----------+----------+
/ceph/hpc/home/eujongc/anaconda3/envs/latentops/lib/python3.9/site-packages/torch/utils/data/dataloader.py:554: UserWarning: This DataLoader will create 4 worker processes in total. Our suggested max number of worker in current system is 2, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(_create_warning_msg(
Train Epoch: [6]  [  0/229]  eta: 0:04:43  lr: 0.000048  loss: 0.2399  time: 1.2376  data: 0.1052  max mem: 30242
Train Epoch: [6]  [ 50/229]  eta: 0:03:18  lr: 0.000048  loss: 0.1149  time: 1.1067  data: 0.0001  max mem: 30242
Train Epoch: [6]  [100/229]  eta: 0:02:23  lr: 0.000048  loss: 0.1570  time: 1.1165  data: 0.0001  max mem: 30242
Train Epoch: [6]  [150/229]  eta: 0:01:27  lr: 0.000048  loss: 0.2449  time: 1.0968  data: 0.0001  max mem: 30242
Train Epoch: [6]  [200/229]  eta: 0:00:32  lr: 0.000048  loss: 0.1233  time: 1.0887  data: 0.0001  max mem: 30242
Train Epoch: [6]  [228/229]  eta: 0:00:01  lr: 0.000048  loss: 0.1050  time: 1.1135  data: 0.0001  max mem: 30242
2023-07-10 16:45:44,766 Train Epoch: [6] Total time: 0:04:15 (1.1161 s / it)
2023-07-10 16:45:44,769 Computing features for evaluation...
  0%|          | 0/154 [00:00<?, ?it/s]  1%|          | 1/154 [00:00<00:52,  2.90it/s]  1%|▏         | 2/154 [00:00<00:40,  3.80it/s]  2%|▏         | 3/154 [00:00<00:36,  4.16it/s]  3%|▎         | 4/154 [00:00<00:34,  4.39it/s]  3%|▎         | 5/154 [00:01<00:34,  4.34it/s]  4%|▍         | 6/154 [00:01<00:32,  4.53it/s]  5%|▍         | 7/154 [00:01<00:30,  4.78it/s]  5%|▌         | 8/154 [00:01<00:31,  4.68it/s]  6%|▌         | 9/154 [00:02<00:31,  4.60it/s]  6%|▋         | 10/154 [00:02<00:30,  4.71it/s]  7%|▋         | 11/154 [00:02<00:31,  4.53it/s]  8%|▊         | 12/154 [00:02<00:31,  4.50it/s]  8%|▊         | 13/154 [00:02<00:30,  4.56it/s]  9%|▉         | 14/154 [00:03<00:31,  4.52it/s] 10%|▉         | 15/154 [00:03<00:30,  4.54it/s] 10%|█         | 16/154 [00:03<00:29,  4.73it/s] 11%|█         | 17/154 [00:03<00:29,  4.69it/s] 12%|█▏        | 18/154 [00:03<00:28,  4.69it/s] 12%|█▏        | 19/154 [00:04<00:29,  4.51it/s] 13%|█▎        | 20/154 [00:04<00:29,  4.50it/s] 14%|█▎        | 21/154 [00:04<00:28,  4.69it/s] 14%|█▍        | 22/154 [00:04<00:27,  4.82it/s] 15%|█▍        | 23/154 [00:05<00:26,  4.87it/s] 16%|█▌        | 24/154 [00:05<00:27,  4.81it/s] 16%|█▌        | 25/154 [00:05<00:26,  4.78it/s] 17%|█▋        | 26/154 [00:05<00:27,  4.74it/s] 18%|█▊        | 27/154 [00:05<00:26,  4.82it/s] 18%|█▊        | 28/154 [00:06<00:26,  4.70it/s] 19%|█▉        | 29/154 [00:06<00:26,  4.78it/s] 19%|█▉        | 30/154 [00:06<00:25,  4.84it/s] 20%|██        | 31/154 [00:06<00:25,  4.78it/s] 21%|██        | 32/154 [00:06<00:25,  4.82it/s] 21%|██▏       | 33/154 [00:07<00:25,  4.77it/s] 22%|██▏       | 34/154 [00:07<00:25,  4.65it/s] 23%|██▎       | 35/154 [00:07<00:25,  4.72it/s] 23%|██▎       | 36/154 [00:07<00:25,  4.71it/s] 24%|██▍       | 37/154 [00:08<00:25,  4.67it/s] 25%|██▍       | 38/154 [00:08<00:24,  4.73it/s] 25%|██▌       | 39/154 [00:08<00:23,  4.80it/s] 26%|██▌       | 40/154 [00:08<00:23,  4.77it/s] 27%|██▋       | 41/154 [00:08<00:24,  4.58it/s] 27%|██▋       | 42/154 [00:09<00:24,  4.53it/s] 28%|██▊       | 43/154 [00:09<00:24,  4.51it/s] 29%|██▊       | 44/154 [00:09<00:23,  4.72it/s] 29%|██▉       | 45/154 [00:09<00:23,  4.62it/s] 30%|██▉       | 46/154 [00:09<00:22,  4.74it/s] 31%|███       | 47/154 [00:10<00:22,  4.73it/s] 31%|███       | 48/154 [00:10<00:22,  4.77it/s] 32%|███▏      | 49/154 [00:10<00:22,  4.72it/s] 32%|███▏      | 50/154 [00:10<00:22,  4.63it/s] 33%|███▎      | 51/154 [00:10<00:21,  4.72it/s] 34%|███▍      | 52/154 [00:11<00:22,  4.61it/s] 34%|███▍      | 53/154 [00:11<00:22,  4.58it/s] 35%|███▌      | 54/154 [00:11<00:21,  4.69it/s] 36%|███▌      | 55/154 [00:11<00:21,  4.61it/s] 36%|███▋      | 56/154 [00:12<00:21,  4.57it/s] 37%|███▋      | 57/154 [00:12<00:20,  4.70it/s] 38%|███▊      | 58/154 [00:12<00:20,  4.68it/s] 38%|███▊      | 59/154 [00:12<00:20,  4.73it/s] 39%|███▉      | 60/154 [00:12<00:20,  4.56it/s] 40%|███▉      | 61/154 [00:13<00:20,  4.58it/s] 40%|████      | 62/154 [00:13<00:19,  4.61it/s] 41%|████      | 63/154 [00:13<00:19,  4.63it/s] 42%|████▏     | 64/154 [00:13<00:19,  4.72it/s] 42%|████▏     | 65/154 [00:14<00:19,  4.49it/s] 43%|████▎     | 66/154 [00:14<00:20,  4.39it/s] 44%|████▎     | 67/154 [00:14<00:19,  4.40it/s] 44%|████▍     | 68/154 [00:14<00:18,  4.55it/s] 45%|████▍     | 69/154 [00:14<00:18,  4.58it/s] 45%|████▌     | 70/154 [00:15<00:17,  4.69it/s] 46%|████▌     | 71/154 [00:15<00:17,  4.66it/s] 47%|████▋     | 72/154 [00:15<00:17,  4.60it/s] 47%|████▋     | 73/154 [00:15<00:17,  4.61it/s] 48%|████▊     | 74/154 [00:16<00:17,  4.62it/s] 49%|████▊     | 75/154 [00:16<00:17,  4.61it/s] 49%|████▉     | 76/154 [00:16<00:17,  4.45it/s] 50%|█████     | 77/154 [00:16<00:16,  4.58it/s] 51%|█████     | 78/154 [00:16<00:16,  4.53it/s] 51%|█████▏    | 79/154 [00:17<00:16,  4.62it/s] 52%|█████▏    | 80/154 [00:17<00:16,  4.44it/s] 53%|█████▎    | 81/154 [00:17<00:15,  4.64it/s] 53%|█████▎    | 82/154 [00:17<00:15,  4.73it/s] 54%|█████▍    | 83/154 [00:17<00:15,  4.62it/s] 55%|█████▍    | 84/154 [00:18<00:15,  4.66it/s] 55%|█████▌    | 85/154 [00:18<00:14,  4.82it/s] 56%|█████▌    | 86/154 [00:18<00:14,  4.69it/s] 56%|█████▋    | 87/154 [00:18<00:14,  4.68it/s] 57%|█████▋    | 88/154 [00:19<00:14,  4.54it/s] 58%|█████▊    | 89/154 [00:19<00:14,  4.55it/s] 58%|█████▊    | 90/154 [00:19<00:13,  4.65it/s] 59%|█████▉    | 91/154 [00:19<00:13,  4.66it/s] 60%|█████▉    | 92/154 [00:19<00:14,  4.22it/s] 60%|██████    | 93/154 [00:20<00:14,  4.27it/s] 61%|██████    | 94/154 [00:20<00:14,  4.20it/s] 62%|██████▏   | 95/154 [00:20<00:14,  4.20it/s] 62%|██████▏   | 96/154 [00:20<00:13,  4.21it/s] 63%|██████▎   | 97/154 [00:21<00:13,  4.28it/s] 64%|██████▎   | 98/154 [00:21<00:12,  4.47it/s] 64%|██████▍   | 99/154 [00:21<00:12,  4.40it/s] 65%|██████▍   | 100/154 [00:21<00:12,  4.35it/s] 66%|██████▌   | 101/154 [00:22<00:11,  4.46it/s] 66%|██████▌   | 102/154 [00:22<00:11,  4.60it/s] 67%|██████▋   | 103/154 [00:22<00:11,  4.59it/s] 68%|██████▊   | 104/154 [00:22<00:10,  4.61it/s] 68%|██████▊   | 105/154 [00:22<00:10,  4.62it/s] 69%|██████▉   | 106/154 [00:23<00:10,  4.69it/s] 69%|██████▉   | 107/154 [00:23<00:10,  4.64it/s] 70%|███████   | 108/154 [00:23<00:10,  4.48it/s] 71%|███████   | 109/154 [00:23<00:09,  4.62it/s] 71%|███████▏  | 110/154 [00:23<00:09,  4.47it/s] 72%|███████▏  | 111/154 [00:24<00:09,  4.58it/s] 73%|███████▎  | 112/154 [00:24<00:09,  4.53it/s] 73%|███████▎  | 113/154 [00:24<00:08,  4.56it/s] 74%|███████▍  | 114/154 [00:24<00:08,  4.66it/s] 75%|███████▍  | 115/154 [00:25<00:08,  4.67it/s] 75%|███████▌  | 116/154 [00:25<00:08,  4.69it/s] 76%|███████▌  | 117/154 [00:25<00:07,  4.74it/s] 77%|███████▋  | 118/154 [00:25<00:07,  4.70it/s] 77%|███████▋  | 119/154 [00:25<00:07,  4.78it/s] 78%|███████▊  | 120/154 [00:26<00:06,  4.92it/s] 79%|███████▊  | 121/154 [00:26<00:06,  4.92it/s] 79%|███████▉  | 122/154 [00:26<00:06,  4.93it/s] 80%|███████▉  | 123/154 [00:26<00:06,  4.68it/s] 81%|████████  | 124/154 [00:26<00:06,  4.66it/s] 81%|████████  | 125/154 [00:27<00:06,  4.75it/s] 82%|████████▏ | 126/154 [00:27<00:06,  4.58it/s] 82%|████████▏ | 127/154 [00:27<00:05,  4.61it/s] 83%|████████▎ | 128/154 [00:27<00:05,  4.33it/s] 84%|████████▍ | 129/154 [00:28<00:05,  4.44it/s] 84%|████████▍ | 130/154 [00:28<00:05,  4.49it/s] 85%|████████▌ | 131/154 [00:28<00:05,  4.53it/s] 86%|████████▌ | 132/154 [00:28<00:04,  4.66it/s] 86%|████████▋ | 133/154 [00:28<00:04,  4.59it/s] 87%|████████▋ | 134/154 [00:29<00:04,  4.39it/s] 88%|████████▊ | 135/154 [00:29<00:04,  4.48it/s] 88%|████████▊ | 136/154 [00:29<00:03,  4.67it/s] 89%|████████▉ | 137/154 [00:29<00:03,  4.72it/s] 90%|████████▉ | 138/154 [00:29<00:03,  4.87it/s] 90%|█████████ | 139/154 [00:30<00:03,  4.88it/s] 91%|█████████ | 140/154 [00:30<00:02,  4.73it/s] 92%|█████████▏| 141/154 [00:30<00:02,  4.72it/s] 92%|█████████▏| 142/154 [00:30<00:02,  4.71it/s] 93%|█████████▎| 143/154 [00:31<00:02,  4.71it/s] 94%|█████████▎| 144/154 [00:31<00:02,  4.60it/s] 94%|█████████▍| 145/154 [00:31<00:01,  4.78it/s] 95%|█████████▍| 146/154 [00:31<00:01,  4.74it/s] 95%|█████████▌| 147/154 [00:31<00:01,  4.58it/s] 96%|█████████▌| 148/154 [00:32<00:01,  4.54it/s] 97%|█████████▋| 149/154 [00:32<00:01,  4.68it/s] 97%|█████████▋| 150/154 [00:32<00:00,  4.68it/s] 98%|█████████▊| 151/154 [00:32<00:00,  4.53it/s] 99%|█████████▊| 152/154 [00:32<00:00,  4.74it/s] 99%|█████████▉| 153/154 [00:33<00:00,  4.59it/s]100%|██████████| 154/154 [00:33<00:00,  4.61it/s]
2023-07-10 16:46:18,596 Early stopping at epoch 6
2023-07-10 16:46:18,596 Training time 0:36:15
+-------+------------------------+---------------------+-------------+-------------+-----------+----------+
| epoch |           lr           |      train_loss     | val_top1acc | val_top3acc | val_ndcg1 | val_mrr3 |
+-------+------------------------+---------------------+-------------+-------------+-----------+----------+
|   0   | 4.999999999999982e-05  |  2.821789560880203  |    34.98    |    67.35    |   59.94   |  49.07   |
|   1   | 4.995165484649251e-05  |  1.6432694615755539 |    59.23    |    84.22    |   77.79   |  70.30   |
|   2   | 4.9806810182204925e-05 |  1.0274988912599055 |    62.82    |    87.69    |   80.37   |  73.81   |
|   3   | 4.9566037642853115e-05 |  0.6505238582994219 |    64.90    |    88.54    |   81.42   |  75.51   |
|   4   | 4.923028744765154e-05  | 0.42758957355173394 |    64.33    |    87.93    |   81.29   |  74.93   |
|   5   | 4.880088464923109e-05  | 0.30189239523296274 |    63.92    |    89.52    |   81.53   |  75.43   |
|   6   | 4.8279523904262044e-05 |  0.2206032029454755 |    64.53    |    88.67    |   81.31   |  75.38   |
+-------+------------------------+---------------------+-------------+-------------+-----------+----------+
+-------+--------------+--------------+------------+-----------+
| epoch | test_top1acc | test_top3acc | test_ndcg1 | test_mrr3 |
+-------+--------------+--------------+------------+-----------+
|   0   |    34.99     |    67.52     |   60.29    |   48.99   |
|   1   |    58.73     |    85.05     |   77.77    |   70.50   |
|   2   |    62.86     |    87.20     |   80.51    |   73.85   |
|   3   |    64.12     |    88.66     |   81.35    |   75.04   |
+-------+--------------+--------------+------------+-----------+
