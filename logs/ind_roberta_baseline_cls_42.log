gn55 0
/ceph/hpc/data/d2023d06-049-users/cgr/output/ind_roberta_baseline_cls_seed_42_bs_32
2023-07-10 16:10:32,396 Begins
2023-07-10 16:10:32,423 ------------------------------
2023-07-10 16:10:32,423 text_encoder: clue/roberta_chinese_base
2023-07-10 16:10:32,423 output_dir: /ceph/hpc/data/d2023d06-049-users/cgr/output/ind_roberta_baseline_cls_seed_42_bs_32
2023-07-10 16:10:32,423 exper_mode: baseline_cls
2023-07-10 16:10:32,423 batch_size_train: 32
2023-07-10 16:10:32,423 batch_size_test: 16
2023-07-10 16:10:32,423 early_stop_thresh: 3
2023-07-10 16:10:32,423 train_file: data/industry/train.jsonl
2023-07-10 16:10:32,423 val_file: data/industry/dev.jsonl
2023-07-10 16:10:32,423 test_file: data/industry/test.jsonl
2023-07-10 16:10:32,423 ------------------------------
2023-07-10 16:10:32,869 | distributed init (rank 0): env://
2023-07-10 16:10:32,871 Added key: store_based_barrier_key:1 to store for rank: 0
2023-07-10 16:10:32,871 Rank 0: Completed store-based barrier for key:store_based_barrier_key:1 with 1 nodes.
2023-07-10 16:10:34,299 Creating Chinese re-ranking dataset
2023-07-10 16:10:34,677 train size: 7359
2023-07-10 16:10:34,728 val size: 2453
2023-07-10 16:10:34,913 test size: 2469
2023-07-10 16:10:34,913 Finished reading dataset.
/ceph/hpc/home/eujongc/anaconda3/envs/latentops/lib/python3.9/site-packages/torch/utils/data/dataloader.py:554: UserWarning: This DataLoader will create 4 worker processes in total. Our suggested max number of worker in current system is 2, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(_create_warning_msg(
The tokenizer class you load from this checkpoint is not the same type as the class this function is called from. It may result in unexpected tokenization. 
The tokenizer class you load from this checkpoint is 'RobertaTokenizer'. 
The class this function is called from is 'BertTokenizer'.
2023-07-10 16:10:35,336 Creating model
You are using a model of type roberta to instantiate a model of type bert. This is not supported for all configurations of models and can yield errors.
Some weights of the model checkpoint at clue/roberta_chinese_base were not used when initializing BertModel: ['cls.predictions.transform.dense.bias', 'cls.predictions.transform.LayerNorm.weight', 'cls.seq_relationship.weight', 'cls.predictions.decoder.weight', 'bert.pooler.dense.weight', 'cls.predictions.transform.dense.weight', 'cls.predictions.transform.LayerNorm.bias', 'cls.predictions.decoder.bias', 'bert.pooler.dense.bias', 'cls.seq_relationship.bias', 'cls.predictions.bias']
- This IS expected if you are initializing BertModel from the checkpoint of a model trained on another task or with another architecture (e.g. initializing a BertForSequenceClassification model from a BertForPreTraining model).
- This IS NOT expected if you are initializing BertModel from the checkpoint of a model that you expect to be exactly identical (initializing a BertForSequenceClassification model from a BertForSequenceClassification model).
2023-07-10 16:10:36,840 =========> We are on baseline_cls mode!
2023-07-10 16:10:36,842 {'Total': 102070784, 'Trainable': 102070784}
2023-07-10 16:10:36,907 Start training
Train Epoch: [0]  [  0/229]  eta: 0:18:15  lr: 0.000010  loss: 3.6999  time: 4.7848  data: 2.7819  max mem: 21216
2023-07-10 16:10:41,822 Reducer buckets have been rebuilt in this iteration.
Train Epoch: [0]  [ 50/229]  eta: 0:03:43  lr: 0.000010  loss: 2.6746  time: 1.1735  data: 0.0001  max mem: 30101
Train Epoch: [0]  [100/229]  eta: 0:02:35  lr: 0.000010  loss: 2.0723  time: 1.1696  data: 0.0001  max mem: 30242
Train Epoch: [0]  [150/229]  eta: 0:01:32  lr: 0.000010  loss: 1.9047  time: 1.1027  data: 0.0001  max mem: 30242
Train Epoch: [0]  [200/229]  eta: 0:00:33  lr: 0.000010  loss: 1.6365  time: 1.1600  data: 0.0001  max mem: 30242
Train Epoch: [0]  [228/229]  eta: 0:00:01  lr: 0.000010  loss: 1.6515  time: 1.1517  data: 0.0001  max mem: 30242
2023-07-10 16:15:03,818 Train Epoch: [0] Total time: 0:04:26 (1.1655 s / it)
2023-07-10 16:15:03,822 Computing features for evaluation...

  0%|          | 0/154 [00:00<?, ?it/s]
  1%|          | 1/154 [00:00<00:51,  2.98it/s]
  1%|▏         | 2/154 [00:00<00:40,  3.72it/s]
  2%|▏         | 3/154 [00:00<00:37,  3.99it/s]
  3%|▎         | 4/154 [00:01<00:36,  4.15it/s]
  3%|▎         | 5/154 [00:01<00:36,  4.09it/s]
  4%|▍         | 6/154 [00:01<00:34,  4.25it/s]
  5%|▍         | 7/154 [00:01<00:32,  4.46it/s]
  5%|▌         | 8/154 [00:01<00:33,  4.37it/s]
  6%|▌         | 9/154 [00:02<00:33,  4.29it/s]
  6%|▋         | 10/154 [00:02<00:32,  4.38it/s]
  7%|▋         | 11/154 [00:02<00:33,  4.22it/s]
  8%|▊         | 12/154 [00:02<00:33,  4.20it/s]
  8%|▊         | 13/154 [00:03<00:33,  4.25it/s]
  9%|▉         | 14/154 [00:03<00:33,  4.21it/s]
 10%|▉         | 15/154 [00:03<00:32,  4.24it/s]
 10%|█         | 16/154 [00:03<00:31,  4.35it/s]
 11%|█         | 17/154 [00:04<00:31,  4.34it/s]
 12%|█▏        | 18/154 [00:04<00:31,  4.34it/s]
 12%|█▏        | 19/154 [00:04<00:32,  4.19it/s]
 13%|█▎        | 20/154 [00:04<00:32,  4.18it/s]
 14%|█▎        | 21/154 [00:04<00:30,  4.31it/s]
 14%|█▍        | 22/154 [00:05<00:29,  4.43it/s]
 15%|█▍        | 23/154 [00:05<00:29,  4.49it/s]
 16%|█▌        | 24/154 [00:05<00:29,  4.45it/s]
 16%|█▌        | 25/154 [00:05<00:29,  4.43it/s]
 17%|█▋        | 26/154 [00:06<00:29,  4.39it/s]
 18%|█▊        | 27/154 [00:06<00:28,  4.46it/s]
 18%|█▊        | 28/154 [00:06<00:28,  4.37it/s]
 19%|█▉        | 29/154 [00:06<00:28,  4.43it/s]
 19%|█▉        | 30/154 [00:06<00:27,  4.49it/s]
 20%|██        | 31/154 [00:07<00:27,  4.43it/s]
 21%|██        | 32/154 [00:07<00:27,  4.47it/s]
 21%|██▏       | 33/154 [00:07<00:27,  4.44it/s]
 22%|██▏       | 34/154 [00:07<00:27,  4.33it/s]
 23%|██▎       | 35/154 [00:08<00:27,  4.40it/s]
 23%|██▎       | 36/154 [00:08<00:26,  4.38it/s]
 24%|██▍       | 37/154 [00:08<00:26,  4.34it/s]
 25%|██▍       | 38/154 [00:08<00:26,  4.39it/s]
 25%|██▌       | 39/154 [00:09<00:25,  4.46it/s]
 26%|██▌       | 40/154 [00:09<00:25,  4.43it/s]
 27%|██▋       | 41/154 [00:09<00:26,  4.26it/s]
 27%|██▋       | 42/154 [00:09<00:26,  4.22it/s]
 28%|██▊       | 43/154 [00:09<00:26,  4.19it/s]
 29%|██▊       | 44/154 [00:10<00:25,  4.38it/s]
 29%|██▉       | 45/154 [00:10<00:25,  4.30it/s]
 30%|██▉       | 46/154 [00:10<00:24,  4.39it/s]
 31%|███       | 47/154 [00:10<00:24,  4.39it/s]
 31%|███       | 48/154 [00:11<00:23,  4.42it/s]
 32%|███▏      | 49/154 [00:11<00:23,  4.38it/s]
 32%|███▏      | 50/154 [00:11<00:24,  4.31it/s]
 33%|███▎      | 51/154 [00:11<00:23,  4.39it/s]
 34%|███▍      | 52/154 [00:12<00:23,  4.29it/s]
 34%|███▍      | 53/154 [00:12<00:23,  4.26it/s]
 35%|███▌      | 54/154 [00:12<00:22,  4.36it/s]
 36%|███▌      | 55/154 [00:12<00:23,  4.29it/s]
 36%|███▋      | 56/154 [00:12<00:23,  4.25it/s]
 37%|███▋      | 57/154 [00:13<00:22,  4.36it/s]
 38%|███▊      | 58/154 [00:13<00:22,  4.35it/s]
 38%|███▊      | 59/154 [00:13<00:21,  4.40it/s]
 39%|███▉      | 60/154 [00:13<00:22,  4.26it/s]
 40%|███▉      | 61/154 [00:14<00:21,  4.26it/s]
 40%|████      | 62/154 [00:14<00:21,  4.30it/s]
 41%|████      | 63/154 [00:14<00:21,  4.31it/s]
 42%|████▏     | 64/154 [00:14<00:20,  4.38it/s]
 42%|████▏     | 65/154 [00:15<00:21,  4.19it/s]
 43%|████▎     | 66/154 [00:15<00:21,  4.10it/s]
 44%|████▎     | 67/154 [00:15<00:21,  4.11it/s]
 44%|████▍     | 68/154 [00:15<00:20,  4.24it/s]
 45%|████▍     | 69/154 [00:16<00:19,  4.26it/s]
 45%|████▌     | 70/154 [00:16<00:19,  4.37it/s]
 46%|████▌     | 71/154 [00:16<00:19,  4.35it/s]
 47%|████▋     | 72/154 [00:16<00:19,  4.29it/s]
 47%|████▋     | 73/154 [00:16<00:18,  4.29it/s]
 48%|████▊     | 74/154 [00:17<00:18,  4.30it/s]
 49%|████▊     | 75/154 [00:17<00:18,  4.29it/s]
 49%|████▉     | 76/154 [00:17<00:18,  4.15it/s]
 50%|█████     | 77/154 [00:17<00:18,  4.26it/s]
 51%|█████     | 78/154 [00:18<00:18,  4.22it/s]
 51%|█████▏    | 79/154 [00:18<00:17,  4.29it/s]
 52%|█████▏    | 80/154 [00:18<00:17,  4.13it/s]
 53%|█████▎    | 81/154 [00:18<00:16,  4.32it/s]
 53%|█████▎    | 82/154 [00:19<00:16,  4.39it/s]
 54%|█████▍    | 83/154 [00:19<00:16,  4.23it/s]
 55%|█████▍    | 84/154 [00:19<00:16,  4.28it/s]
 55%|█████▌    | 85/154 [00:19<00:15,  4.44it/s]
 56%|█████▌    | 86/154 [00:19<00:15,  4.35it/s]
 56%|█████▋    | 87/154 [00:20<00:15,  4.34it/s]
 57%|█████▋    | 88/154 [00:20<00:15,  4.22it/s]
 58%|█████▊    | 89/154 [00:20<00:15,  4.23it/s]
 58%|█████▊    | 90/154 [00:20<00:14,  4.32it/s]
 59%|█████▉    | 91/154 [00:21<00:14,  4.33it/s]
 60%|█████▉    | 92/154 [00:21<00:15,  3.95it/s]
 60%|██████    | 93/154 [00:21<00:15,  3.99it/s]
 61%|██████    | 94/154 [00:21<00:15,  3.92it/s]
 62%|██████▏   | 95/154 [00:22<00:15,  3.93it/s]
 62%|██████▏   | 96/154 [00:22<00:14,  3.95it/s]
 63%|██████▎   | 97/154 [00:22<00:14,  4.01it/s]
 64%|██████▎   | 98/154 [00:22<00:13,  4.18it/s]
 64%|██████▍   | 99/154 [00:23<00:13,  4.12it/s]
 65%|██████▍   | 100/154 [00:23<00:13,  4.08it/s]
 66%|██████▌   | 101/154 [00:23<00:12,  4.17it/s]
 66%|██████▌   | 102/154 [00:23<00:12,  4.29it/s]
 67%|██████▋   | 103/154 [00:24<00:11,  4.29it/s]
 68%|██████▊   | 104/154 [00:24<00:11,  4.30it/s]
 68%|██████▊   | 105/154 [00:24<00:11,  4.31it/s]
 69%|██████▉   | 106/154 [00:24<00:10,  4.37it/s]
 69%|██████▉   | 107/154 [00:25<00:10,  4.32it/s]
 70%|███████   | 108/154 [00:25<00:10,  4.19it/s]
 71%|███████   | 109/154 [00:25<00:10,  4.31it/s]
 71%|███████▏  | 110/154 [00:25<00:10,  4.18it/s]
 72%|███████▏  | 111/154 [00:25<00:10,  4.27it/s]
 73%|███████▎  | 112/154 [00:26<00:09,  4.23it/s]
 73%|███████▎  | 113/154 [00:26<00:09,  4.27it/s]
 74%|███████▍  | 114/154 [00:26<00:09,  4.35it/s]
 75%|███████▍  | 115/154 [00:26<00:08,  4.36it/s]
 75%|███████▌  | 116/154 [00:27<00:08,  4.36it/s]
 76%|███████▌  | 117/154 [00:27<00:08,  4.41it/s]
 77%|███████▋  | 118/154 [00:27<00:08,  4.38it/s]
 77%|███████▋  | 119/154 [00:27<00:07,  4.44it/s]
 78%|███████▊  | 120/154 [00:27<00:07,  4.56it/s]
 79%|███████▊  | 121/154 [00:28<00:07,  4.54it/s]
 79%|███████▉  | 122/154 [00:28<00:07,  4.55it/s]
 80%|███████▉  | 123/154 [00:28<00:07,  4.35it/s]
 81%|████████  | 124/154 [00:28<00:06,  4.32it/s]
 81%|████████  | 125/154 [00:29<00:06,  4.40it/s]
 82%|████████▏ | 126/154 [00:29<00:06,  4.26it/s]
 82%|████████▏ | 127/154 [00:29<00:06,  4.28it/s]
 83%|████████▎ | 128/154 [00:29<00:06,  4.05it/s]
 84%|████████▍ | 129/154 [00:30<00:06,  4.14it/s]
 84%|████████▍ | 130/154 [00:30<00:05,  4.18it/s]
 85%|████████▌ | 131/154 [00:30<00:05,  4.22it/s]
 86%|████████▌ | 132/154 [00:30<00:05,  4.32it/s]
 86%|████████▋ | 133/154 [00:31<00:04,  4.26it/s]
 87%|████████▋ | 134/154 [00:31<00:04,  4.09it/s]
 88%|████████▊ | 135/154 [00:31<00:04,  4.18it/s]
 88%|████████▊ | 136/154 [00:31<00:04,  4.33it/s]
 89%|████████▉ | 137/154 [00:31<00:03,  4.38it/s]
 90%|████████▉ | 138/154 [00:32<00:03,  4.51it/s]
 90%|█████████ | 139/154 [00:32<00:03,  4.52it/s]
 91%|█████████ | 140/154 [00:32<00:03,  4.40it/s]
 92%|█████████▏| 141/154 [00:32<00:03,  4.33it/s]
 92%|█████████▏| 142/154 [00:33<00:02,  4.34it/s]
 93%|█████████▎| 143/154 [00:33<00:02,  4.35it/s]
 94%|█████████▎| 144/154 [00:33<00:02,  4.27it/s]
 94%|█████████▍| 145/154 [00:33<00:02,  4.43it/s]
 95%|█████████▍| 146/154 [00:34<00:01,  4.40it/s]
 95%|█████████▌| 147/154 [00:34<00:01,  4.27it/s]
 96%|█████████▌| 148/154 [00:34<00:01,  4.18it/s]
 97%|█████████▋| 149/154 [00:34<00:01,  4.32it/s]
 97%|█████████▋| 150/154 [00:34<00:00,  4.33it/s]
 98%|█████████▊| 151/154 [00:35<00:00,  4.22it/s]
 99%|█████████▊| 152/154 [00:35<00:00,  4.41it/s]
 99%|█████████▉| 153/154 [00:35<00:00,  4.27it/s]
100%|██████████| 154/154 [00:35<00:00,  4.30it/s]
2023-07-10 16:15:41,343 Computing features for evaluation...

  0%|          | 0/155 [00:00<?, ?it/s]/ceph/hpc/home/eujongc/anaconda3/envs/latentops/lib/python3.9/site-packages/torch/utils/data/dataloader.py:554: UserWarning: This DataLoader will create 4 worker processes in total. Our suggested max number of worker in current system is 2, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(_create_warning_msg(

  1%|          | 1/155 [00:00<01:01,  2.52it/s]
  1%|▏         | 2/155 [00:00<00:44,  3.40it/s]
  2%|▏         | 3/155 [00:00<00:40,  3.80it/s]
  3%|▎         | 4/155 [00:01<00:41,  3.65it/s]
  3%|▎         | 5/155 [00:01<00:39,  3.76it/s]
  4%|▍         | 6/155 [00:01<00:37,  4.00it/s]
  5%|▍         | 7/155 [00:01<00:36,  4.06it/s]
  5%|▌         | 8/155 [00:02<00:35,  4.15it/s]
  6%|▌         | 9/155 [00:02<00:34,  4.20it/s]
  6%|▋         | 10/155 [00:02<00:34,  4.26it/s]
  7%|▋         | 11/155 [00:02<00:34,  4.14it/s]
  8%|▊         | 12/155 [00:03<00:33,  4.21it/s]
  8%|▊         | 13/155 [00:03<00:34,  4.16it/s]
  9%|▉         | 14/155 [00:03<00:34,  4.10it/s]
 10%|▉         | 15/155 [00:03<00:34,  4.00it/s]
 10%|█         | 16/155 [00:03<00:32,  4.22it/s]
 11%|█         | 17/155 [00:04<00:33,  4.17it/s]
 12%|█▏        | 18/155 [00:04<00:33,  4.09it/s]
 12%|█▏        | 19/155 [00:04<00:32,  4.22it/s]
 13%|█▎        | 20/155 [00:04<00:32,  4.17it/s]
 14%|█▎        | 21/155 [00:05<00:31,  4.29it/s]
 14%|█▍        | 22/155 [00:05<00:29,  4.43it/s]
 15%|█▍        | 23/155 [00:05<00:30,  4.39it/s]
 15%|█▌        | 24/155 [00:05<00:30,  4.31it/s]
 16%|█▌        | 25/155 [00:06<00:29,  4.38it/s]
 17%|█▋        | 26/155 [00:06<00:30,  4.23it/s]
 17%|█▋        | 27/155 [00:06<00:30,  4.26it/s]
 18%|█▊        | 28/155 [00:06<00:29,  4.34it/s]
 19%|█▊        | 29/155 [00:07<00:29,  4.21it/s]
 19%|█▉        | 30/155 [00:07<00:30,  4.12it/s]
 20%|██        | 31/155 [00:07<00:30,  4.08it/s]
 21%|██        | 32/155 [00:07<00:29,  4.22it/s]
 21%|██▏       | 33/155 [00:07<00:28,  4.25it/s]
 22%|██▏       | 34/155 [00:08<00:28,  4.22it/s]
 23%|██▎       | 35/155 [00:08<00:28,  4.18it/s]
 23%|██▎       | 36/155 [00:08<00:28,  4.12it/s]
 24%|██▍       | 37/155 [00:08<00:29,  4.01it/s]
 25%|██▍       | 38/155 [00:09<00:28,  4.09it/s]
 25%|██▌       | 39/155 [00:09<00:27,  4.17it/s]
 26%|██▌       | 40/155 [00:09<00:26,  4.28it/s]
 26%|██▋       | 41/155 [00:09<00:27,  4.16it/s]
 27%|██▋       | 42/155 [00:10<00:26,  4.24it/s]
 28%|██▊       | 43/155 [00:10<00:26,  4.21it/s]
 28%|██▊       | 44/155 [00:10<00:26,  4.20it/s]
 29%|██▉       | 45/155 [00:10<00:25,  4.32it/s]
 30%|██▉       | 46/155 [00:11<00:26,  4.19it/s]
 30%|███       | 47/155 [00:11<00:25,  4.17it/s]
 31%|███       | 48/155 [00:11<00:25,  4.17it/s]
 32%|███▏      | 49/155 [00:11<00:24,  4.29it/s]
 32%|███▏      | 50/155 [00:12<00:25,  4.20it/s]
 33%|███▎      | 51/155 [00:12<00:24,  4.18it/s]
 34%|███▎      | 52/155 [00:12<00:25,  4.03it/s]
 34%|███▍      | 53/155 [00:12<00:24,  4.10it/s]
 35%|███▍      | 54/155 [00:13<00:23,  4.26it/s]
 35%|███▌      | 55/155 [00:13<00:23,  4.28it/s]
 36%|███▌      | 56/155 [00:13<00:23,  4.29it/s]
 37%|███▋      | 57/155 [00:13<00:23,  4.22it/s]
 37%|███▋      | 58/155 [00:13<00:23,  4.20it/s]
 38%|███▊      | 59/155 [00:14<00:22,  4.22it/s]
 39%|███▊      | 60/155 [00:14<00:21,  4.34it/s]
 39%|███▉      | 61/155 [00:14<00:23,  4.08it/s]
 40%|████      | 62/155 [00:14<00:22,  4.17it/s]
 41%|████      | 63/155 [00:15<00:21,  4.23it/s]
 41%|████▏     | 64/155 [00:15<00:21,  4.25it/s]
 42%|████▏     | 65/155 [00:15<00:20,  4.41it/s]
 43%|████▎     | 66/155 [00:15<00:20,  4.29it/s]
 43%|████▎     | 67/155 [00:16<00:20,  4.36it/s]
 44%|████▍     | 68/155 [00:16<00:19,  4.44it/s]
 45%|████▍     | 69/155 [00:16<00:19,  4.36it/s]
 45%|████▌     | 70/155 [00:16<00:19,  4.29it/s]
 46%|████▌     | 71/155 [00:16<00:19,  4.31it/s]
 46%|████▋     | 72/155 [00:17<00:20,  4.01it/s]
 47%|████▋     | 73/155 [00:17<00:21,  3.81it/s]
 48%|████▊     | 74/155 [00:17<00:20,  3.89it/s]
 48%|████▊     | 75/155 [00:18<00:19,  4.03it/s]
 49%|████▉     | 76/155 [00:18<00:19,  4.12it/s]
 50%|████▉     | 77/155 [00:18<00:18,  4.11it/s]
 50%|█████     | 78/155 [00:18<00:18,  4.12it/s]
 51%|█████     | 79/155 [00:18<00:17,  4.30it/s]
 52%|█████▏    | 80/155 [00:19<00:16,  4.45it/s]
 52%|█████▏    | 81/155 [00:19<00:17,  4.28it/s]
 53%|█████▎    | 82/155 [00:19<00:16,  4.30it/s]
 54%|█████▎    | 83/155 [00:19<00:17,  4.13it/s]
 54%|█████▍    | 84/155 [00:20<00:16,  4.24it/s]
 55%|█████▍    | 85/155 [00:20<00:16,  4.27it/s]
 55%|█████▌    | 86/155 [00:20<00:16,  4.30it/s]
 56%|█████▌    | 87/155 [00:20<00:15,  4.36it/s]
 57%|█████▋    | 88/155 [00:21<00:15,  4.42it/s]
 57%|█████▋    | 89/155 [00:21<00:14,  4.54it/s]
 58%|█████▊    | 90/155 [00:21<00:14,  4.48it/s]
 59%|█████▊    | 91/155 [00:21<00:14,  4.42it/s]
 59%|█████▉    | 92/155 [00:21<00:14,  4.47it/s]
 60%|██████    | 93/155 [00:22<00:17,  3.58it/s]
 61%|██████    | 94/155 [00:22<00:16,  3.81it/s]
 61%|██████▏   | 95/155 [00:22<00:15,  3.94it/s]
 62%|██████▏   | 96/155 [00:23<00:14,  4.00it/s]
 63%|██████▎   | 97/155 [00:23<00:13,  4.16it/s]
 63%|██████▎   | 98/155 [00:23<00:13,  4.16it/s]
 64%|██████▍   | 99/155 [00:23<00:13,  4.28it/s]
 65%|██████▍   | 100/155 [00:23<00:13,  4.22it/s]
 65%|██████▌   | 101/155 [00:24<00:12,  4.26it/s]
 66%|██████▌   | 102/155 [00:24<00:12,  4.29it/s]
 66%|██████▋   | 103/155 [00:24<00:12,  4.16it/s]
 67%|██████▋   | 104/155 [00:24<00:12,  4.21it/s]
 68%|██████▊   | 105/155 [00:25<00:11,  4.23it/s]
 68%|██████▊   | 106/155 [00:25<00:11,  4.20it/s]
 69%|██████▉   | 107/155 [00:25<00:11,  4.26it/s]
 70%|██████▉   | 108/155 [00:25<00:11,  4.22it/s]
 70%|███████   | 109/155 [00:26<00:10,  4.27it/s]
 71%|███████   | 110/155 [00:26<00:10,  4.29it/s]
 72%|███████▏  | 111/155 [00:26<00:09,  4.44it/s]
 72%|███████▏  | 112/155 [00:26<00:09,  4.35it/s]
 73%|███████▎  | 113/155 [00:26<00:09,  4.32it/s]
 74%|███████▎  | 114/155 [00:27<00:09,  4.15it/s]
 74%|███████▍  | 115/155 [00:27<00:09,  4.08it/s]
 75%|███████▍  | 116/155 [00:27<00:09,  4.22it/s]
 75%|███████▌  | 117/155 [00:27<00:09,  4.19it/s]
 76%|███████▌  | 118/155 [00:28<00:08,  4.37it/s]
 77%|███████▋  | 119/155 [00:28<00:08,  4.05it/s]
 77%|███████▋  | 120/155 [00:28<00:08,  4.13it/s]
 78%|███████▊  | 121/155 [00:28<00:08,  4.02it/s]
 79%|███████▊  | 122/155 [00:29<00:08,  4.11it/s]
 79%|███████▉  | 123/155 [00:29<00:07,  4.17it/s]
 80%|████████  | 124/155 [00:29<00:07,  4.09it/s]
 81%|████████  | 125/155 [00:29<00:07,  4.25it/s]
 81%|████████▏ | 126/155 [00:30<00:06,  4.26it/s]
 82%|████████▏ | 127/155 [00:30<00:06,  4.37it/s]
 83%|████████▎ | 128/155 [00:30<00:06,  4.23it/s]
 83%|████████▎ | 129/155 [00:30<00:06,  4.12it/s]
 84%|████████▍ | 130/155 [00:31<00:06,  4.07it/s]
 85%|████████▍ | 131/155 [00:31<00:06,  3.98it/s]
 85%|████████▌ | 132/155 [00:31<00:05,  4.15it/s]
 86%|████████▌ | 133/155 [00:31<00:05,  4.21it/s]
 86%|████████▋ | 134/155 [00:32<00:05,  4.13it/s]
 87%|████████▋ | 135/155 [00:32<00:04,  4.21it/s]
 88%|████████▊ | 136/155 [00:32<00:04,  4.30it/s]
 88%|████████▊ | 137/155 [00:32<00:04,  4.38it/s]
 89%|████████▉ | 138/155 [00:32<00:04,  4.25it/s]
 90%|████████▉ | 139/155 [00:33<00:03,  4.22it/s]
 90%|█████████ | 140/155 [00:33<00:03,  4.21it/s]
 91%|█████████ | 141/155 [00:33<00:03,  4.18it/s]
 92%|█████████▏| 142/155 [00:33<00:03,  4.30it/s]
 92%|█████████▏| 143/155 [00:34<00:02,  4.40it/s]
 93%|█████████▎| 144/155 [00:34<00:02,  4.18it/s]
 94%|█████████▎| 145/155 [00:34<00:02,  4.21it/s]
 94%|█████████▍| 146/155 [00:34<00:02,  4.32it/s]
 95%|█████████▍| 147/155 [00:35<00:01,  4.32it/s]
 95%|█████████▌| 148/155 [00:35<00:01,  4.41it/s]
 96%|█████████▌| 149/155 [00:35<00:01,  4.34it/s]
 97%|█████████▋| 150/155 [00:35<00:01,  4.40it/s]
 97%|█████████▋| 151/155 [00:35<00:00,  4.45it/s]
 98%|█████████▊| 152/155 [00:36<00:00,  4.53it/s]
 99%|█████████▊| 153/155 [00:36<00:00,  4.51it/s]
 99%|█████████▉| 154/155 [00:36<00:00,  4.18it/s]
100%|██████████| 155/155 [00:36<00:00,  4.21it/s]
+-------+------------------------+--------------------+-------------+-------------+-----------+----------+
| epoch |           lr           |     train_loss     | val_top1acc | val_top3acc | val_ndcg1 | val_mrr3 |
+-------+------------------------+--------------------+-------------+-------------+-----------+----------+
|   0   | 1.0000000000000023e-05 | 2.2853724935689868 |    43.42    |    76.27    |   67.87   |  57.81   |
+-------+------------------------+--------------------+-------------+-------------+-----------+----------+
/ceph/hpc/home/eujongc/anaconda3/envs/latentops/lib/python3.9/site-packages/torch/utils/data/dataloader.py:554: UserWarning: This DataLoader will create 4 worker processes in total. Our suggested max number of worker in current system is 2, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(_create_warning_msg(
Train Epoch: [1]  [  0/229]  eta: 0:05:21  lr: 0.000010  loss: 1.9147  time: 1.4023  data: 0.0841  max mem: 30242
Train Epoch: [1]  [ 50/229]  eta: 0:03:24  lr: 0.000010  loss: 1.3471  time: 1.1121  data: 0.0001  max mem: 30242
Train Epoch: [1]  [100/229]  eta: 0:02:28  lr: 0.000010  loss: 1.9183  time: 1.1476  data: 0.0001  max mem: 30242
Train Epoch: [1]  [150/229]  eta: 0:01:30  lr: 0.000010  loss: 2.0465  time: 1.1418  data: 0.0001  max mem: 30242
Train Epoch: [1]  [200/229]  eta: 0:00:33  lr: 0.000010  loss: 1.4603  time: 1.2157  data: 0.0001  max mem: 30242
Train Epoch: [1]  [228/229]  eta: 0:00:01  lr: 0.000010  loss: 1.3713  time: 1.1250  data: 0.0001  max mem: 30242
2023-07-10 16:20:41,320 Train Epoch: [1] Total time: 0:04:22 (1.1470 s / it)
2023-07-10 16:20:41,324 Computing features for evaluation...

  0%|          | 0/154 [00:00<?, ?it/s]
  1%|          | 1/154 [00:00<00:51,  2.97it/s]
  1%|▏         | 2/154 [00:00<00:40,  3.71it/s]
  2%|▏         | 3/154 [00:00<00:37,  3.98it/s]
  3%|▎         | 4/154 [00:01<00:36,  4.15it/s]
  3%|▎         | 5/154 [00:01<00:36,  4.09it/s]
  4%|▍         | 6/154 [00:01<00:34,  4.25it/s]
  5%|▍         | 7/154 [00:01<00:32,  4.46it/s]
  5%|▌         | 8/154 [00:01<00:33,  4.36it/s]
  6%|▌         | 9/154 [00:02<00:33,  4.28it/s]
  6%|▋         | 10/154 [00:02<00:32,  4.38it/s]
  7%|▋         | 11/154 [00:02<00:33,  4.22it/s]
  8%|▊         | 12/154 [00:02<00:33,  4.20it/s]
  8%|▊         | 13/154 [00:03<00:33,  4.24it/s]
  9%|▉         | 14/154 [00:03<00:33,  4.21it/s]
 10%|▉         | 15/154 [00:03<00:32,  4.23it/s]
 10%|█         | 16/154 [00:03<00:31,  4.35it/s]
 11%|█         | 17/154 [00:04<00:31,  4.33it/s]
 12%|█▏        | 18/154 [00:04<00:31,  4.34it/s]
 12%|█▏        | 19/154 [00:04<00:32,  4.18it/s]
 13%|█▎        | 20/154 [00:04<00:32,  4.17it/s]
 14%|█▎        | 21/154 [00:04<00:30,  4.30it/s]
 14%|█▍        | 22/154 [00:05<00:29,  4.42it/s]
 15%|█▍        | 23/154 [00:05<00:29,  4.48it/s]
 16%|█▌        | 24/154 [00:05<00:29,  4.44it/s]
 16%|█▌        | 25/154 [00:05<00:29,  4.43it/s]
 17%|█▋        | 26/154 [00:06<00:35,  3.64it/s]
 18%|█▊        | 27/154 [00:06<00:32,  3.89it/s]
 18%|█▊        | 28/154 [00:06<00:31,  3.97it/s]
 19%|█▉        | 29/154 [00:06<00:30,  4.14it/s]
 19%|█▉        | 30/154 [00:07<00:29,  4.28it/s]
 20%|██        | 31/154 [00:07<00:28,  4.29it/s]
 21%|██        | 32/154 [00:07<00:27,  4.37it/s]
 21%|██▏       | 33/154 [00:07<00:27,  4.36it/s]
 22%|██▏       | 34/154 [00:08<00:28,  4.28it/s]
 23%|██▎       | 35/154 [00:08<00:27,  4.36it/s]
 23%|██▎       | 36/154 [00:08<00:27,  4.35it/s]
 24%|██▍       | 37/154 [00:08<00:27,  4.33it/s]
 25%|██▍       | 38/154 [00:08<00:26,  4.38it/s]
 25%|██▌       | 39/154 [00:09<00:25,  4.44it/s]
 26%|██▌       | 40/154 [00:09<00:25,  4.42it/s]
 27%|██▋       | 41/154 [00:09<00:26,  4.25it/s]
 27%|██▋       | 42/154 [00:09<00:26,  4.21it/s]
 28%|██▊       | 43/154 [00:10<00:26,  4.19it/s]
 29%|██▊       | 44/154 [00:10<00:25,  4.38it/s]
 29%|██▉       | 45/154 [00:10<00:25,  4.30it/s]
 30%|██▉       | 46/154 [00:10<00:24,  4.39it/s]
 31%|███       | 47/154 [00:11<00:24,  4.39it/s]
 31%|███       | 48/154 [00:11<00:23,  4.42it/s]
 32%|███▏      | 49/154 [00:11<00:23,  4.38it/s]
 32%|███▏      | 50/154 [00:11<00:24,  4.31it/s]
 33%|███▎      | 51/154 [00:11<00:23,  4.38it/s]
 34%|███▍      | 52/154 [00:12<00:23,  4.29it/s]
 34%|███▍      | 53/154 [00:12<00:23,  4.27it/s]
 35%|███▌      | 54/154 [00:12<00:22,  4.36it/s]
 36%|███▌      | 55/154 [00:12<00:23,  4.30it/s]
 36%|███▋      | 56/154 [00:13<00:23,  4.25it/s]
 37%|███▋      | 57/154 [00:13<00:22,  4.36it/s]
 38%|███▊      | 58/154 [00:13<00:22,  4.36it/s]
 38%|███▊      | 59/154 [00:13<00:21,  4.40it/s]
 39%|███▉      | 60/154 [00:14<00:22,  4.26it/s]
 40%|███▉      | 61/154 [00:14<00:21,  4.27it/s]
 40%|████      | 62/154 [00:14<00:21,  4.30it/s]
 41%|████      | 63/154 [00:14<00:21,  4.31it/s]
 42%|████▏     | 64/154 [00:14<00:20,  4.39it/s]
 42%|████▏     | 65/154 [00:15<00:21,  4.20it/s]
 43%|████▎     | 66/154 [00:15<00:21,  4.10it/s]
 44%|████▎     | 67/154 [00:15<00:21,  4.11it/s]
 44%|████▍     | 68/154 [00:15<00:20,  4.24it/s]
 45%|████▍     | 69/154 [00:16<00:19,  4.26it/s]
 45%|████▌     | 70/154 [00:16<00:19,  4.36it/s]
 46%|████▌     | 71/154 [00:16<00:19,  4.34it/s]
 47%|████▋     | 72/154 [00:16<00:19,  4.28it/s]
 47%|████▋     | 73/154 [00:17<00:18,  4.29it/s]
 48%|████▊     | 74/154 [00:17<00:18,  4.29it/s]
 49%|████▊     | 75/154 [00:17<00:18,  4.29it/s]
 49%|████▉     | 76/154 [00:17<00:18,  4.15it/s]
 50%|█████     | 77/154 [00:18<00:18,  4.26it/s]
 51%|█████     | 78/154 [00:18<00:18,  4.22it/s]
 51%|█████▏    | 79/154 [00:18<00:17,  4.29it/s]
 52%|█████▏    | 80/154 [00:18<00:17,  4.13it/s]
 53%|█████▎    | 81/154 [00:18<00:16,  4.32it/s]
 53%|█████▎    | 82/154 [00:19<00:16,  4.40it/s]
 54%|█████▍    | 83/154 [00:19<00:16,  4.24it/s]
 55%|█████▍    | 84/154 [00:19<00:16,  4.28it/s]
 55%|█████▌    | 85/154 [00:19<00:15,  4.44it/s]
 56%|█████▌    | 86/154 [00:20<00:15,  4.35it/s]
 56%|█████▋    | 87/154 [00:20<00:15,  4.34it/s]
 57%|█████▋    | 88/154 [00:20<00:15,  4.22it/s]
 58%|█████▊    | 89/154 [00:20<00:15,  4.22it/s]
 58%|█████▊    | 90/154 [00:21<00:14,  4.32it/s]
 59%|█████▉    | 91/154 [00:21<00:14,  4.32it/s]
 60%|█████▉    | 92/154 [00:21<00:15,  3.95it/s]
 60%|██████    | 93/154 [00:21<00:15,  3.99it/s]
 61%|██████    | 94/154 [00:22<00:15,  3.92it/s]
 62%|██████▏   | 95/154 [00:22<00:15,  3.93it/s]
 62%|██████▏   | 96/154 [00:22<00:14,  3.94it/s]
 63%|██████▎   | 97/154 [00:22<00:14,  4.01it/s]
 64%|██████▎   | 98/154 [00:23<00:13,  4.18it/s]
 64%|██████▍   | 99/154 [00:23<00:13,  4.12it/s]
 65%|██████▍   | 100/154 [00:23<00:13,  4.08it/s]
 66%|██████▌   | 101/154 [00:23<00:12,  4.17it/s]
 66%|██████▌   | 102/154 [00:24<00:12,  4.29it/s]
 67%|██████▋   | 103/154 [00:24<00:11,  4.29it/s]
 68%|██████▊   | 104/154 [00:24<00:11,  4.30it/s]
 68%|██████▊   | 105/154 [00:24<00:11,  4.30it/s]
 69%|██████▉   | 106/154 [00:24<00:10,  4.37it/s]
 69%|██████▉   | 107/154 [00:25<00:10,  4.32it/s]
 70%|███████   | 108/154 [00:25<00:10,  4.19it/s]
 71%|███████   | 109/154 [00:25<00:10,  4.31it/s]
 71%|███████▏  | 110/154 [00:25<00:10,  4.18it/s]
 72%|███████▏  | 111/154 [00:26<00:10,  4.27it/s]
 73%|███████▎  | 112/154 [00:26<00:09,  4.23it/s]
 73%|███████▎  | 113/154 [00:26<00:09,  4.26it/s]
 74%|███████▍  | 114/154 [00:26<00:09,  4.34it/s]
 75%|███████▍  | 115/154 [00:27<00:08,  4.35it/s]
 75%|███████▌  | 116/154 [00:27<00:08,  4.35it/s]
 76%|███████▌  | 117/154 [00:27<00:08,  4.40it/s]
 77%|███████▋  | 118/154 [00:27<00:08,  4.37it/s]
 77%|███████▋  | 119/154 [00:27<00:07,  4.43it/s]
 78%|███████▊  | 120/154 [00:28<00:07,  4.56it/s]
 79%|███████▊  | 121/154 [00:28<00:07,  4.55it/s]
 79%|███████▉  | 122/154 [00:28<00:07,  4.56it/s]
 80%|███████▉  | 123/154 [00:28<00:07,  4.35it/s]
 81%|████████  | 124/154 [00:29<00:06,  4.32it/s]
 81%|████████  | 125/154 [00:29<00:06,  4.40it/s]
 82%|████████▏ | 126/154 [00:29<00:06,  4.26it/s]
 82%|████████▏ | 127/154 [00:29<00:06,  4.28it/s]
 83%|████████▎ | 128/154 [00:30<00:06,  4.05it/s]
 84%|████████▍ | 129/154 [00:30<00:06,  4.13it/s]
 84%|████████▍ | 130/154 [00:30<00:05,  4.18it/s]
 85%|████████▌ | 131/154 [00:30<00:05,  4.22it/s]
 86%|████████▌ | 132/154 [00:30<00:05,  4.33it/s]
 86%|████████▋ | 133/154 [00:31<00:04,  4.26it/s]
 87%|████████▋ | 134/154 [00:31<00:04,  4.09it/s]
 88%|████████▊ | 135/154 [00:31<00:04,  4.17it/s]
 88%|████████▊ | 136/154 [00:31<00:04,  4.33it/s]
 89%|████████▉ | 137/154 [00:32<00:03,  4.38it/s]
 90%|████████▉ | 138/154 [00:32<00:03,  4.51it/s]
 90%|█████████ | 139/154 [00:32<00:03,  4.53it/s]
 91%|█████████ | 140/154 [00:32<00:03,  4.40it/s]
 92%|█████████▏| 141/154 [00:33<00:03,  4.33it/s]
 92%|█████████▏| 142/154 [00:33<00:02,  4.34it/s]
 93%|█████████▎| 143/154 [00:33<00:02,  4.35it/s]
 94%|█████████▎| 144/154 [00:33<00:02,  4.27it/s]
 94%|█████████▍| 145/154 [00:33<00:02,  4.42it/s]
 95%|█████████▍| 146/154 [00:34<00:01,  4.39it/s]
 95%|█████████▌| 147/154 [00:34<00:01,  4.26it/s]
 96%|█████████▌| 148/154 [00:34<00:01,  4.18it/s]
 97%|█████████▋| 149/154 [00:34<00:01,  4.32it/s]
 97%|█████████▋| 150/154 [00:35<00:00,  4.33it/s]
 98%|█████████▊| 151/154 [00:35<00:00,  4.22it/s]
 99%|█████████▊| 152/154 [00:35<00:00,  4.40it/s]
 99%|█████████▉| 153/154 [00:35<00:00,  4.27it/s]
100%|██████████| 154/154 [00:36<00:00,  4.28it/s]
2023-07-10 16:21:18,724 Computing features for evaluation...

  0%|          | 0/155 [00:00<?, ?it/s]/ceph/hpc/home/eujongc/anaconda3/envs/latentops/lib/python3.9/site-packages/torch/utils/data/dataloader.py:554: UserWarning: This DataLoader will create 4 worker processes in total. Our suggested max number of worker in current system is 2, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(_create_warning_msg(

  1%|          | 1/155 [00:00<00:50,  3.06it/s]
  1%|▏         | 2/155 [00:00<00:40,  3.77it/s]
  2%|▏         | 3/155 [00:00<00:37,  4.03it/s]
  3%|▎         | 4/155 [00:01<00:39,  3.78it/s]
  3%|▎         | 5/155 [00:01<00:38,  3.85it/s]
  4%|▍         | 6/155 [00:01<00:36,  4.07it/s]
  5%|▍         | 7/155 [00:01<00:36,  4.11it/s]
  5%|▌         | 8/155 [00:02<00:35,  4.19it/s]
  6%|▌         | 9/155 [00:02<00:34,  4.23it/s]
  6%|▋         | 10/155 [00:02<00:33,  4.28it/s]
  7%|▋         | 11/155 [00:02<00:34,  4.16it/s]
  8%|▊         | 12/155 [00:02<00:33,  4.22it/s]
  8%|▊         | 13/155 [00:03<00:34,  4.17it/s]
  9%|▉         | 14/155 [00:03<00:34,  4.11it/s]
 10%|▉         | 15/155 [00:03<00:34,  4.01it/s]
 10%|█         | 16/155 [00:03<00:32,  4.23it/s]
 11%|█         | 17/155 [00:04<00:33,  4.18it/s]
 12%|█▏        | 18/155 [00:04<00:33,  4.10it/s]
 12%|█▏        | 19/155 [00:04<00:32,  4.23it/s]
 13%|█▎        | 20/155 [00:04<00:32,  4.17it/s]
 14%|█▎        | 21/155 [00:05<00:31,  4.29it/s]
 14%|█▍        | 22/155 [00:05<00:30,  4.43it/s]
 15%|█▍        | 23/155 [00:05<00:30,  4.38it/s]
 15%|█▌        | 24/155 [00:05<00:30,  4.31it/s]
 16%|█▌        | 25/155 [00:06<00:29,  4.39it/s]
 17%|█▋        | 26/155 [00:06<00:30,  4.23it/s]
 17%|█▋        | 27/155 [00:06<00:29,  4.27it/s]
 18%|█▊        | 28/155 [00:06<00:29,  4.35it/s]
 19%|█▊        | 29/155 [00:06<00:29,  4.22it/s]
 19%|█▉        | 30/155 [00:07<00:30,  4.13it/s]
 20%|██        | 31/155 [00:07<00:30,  4.08it/s]
 21%|██        | 32/155 [00:07<00:29,  4.22it/s]
 21%|██▏       | 33/155 [00:07<00:28,  4.25it/s]
 22%|██▏       | 34/155 [00:08<00:28,  4.22it/s]
 23%|██▎       | 35/155 [00:08<00:28,  4.19it/s]
 23%|██▎       | 36/155 [00:08<00:28,  4.13it/s]
 24%|██▍       | 37/155 [00:08<00:29,  4.01it/s]
 25%|██▍       | 38/155 [00:09<00:28,  4.09it/s]
 25%|██▌       | 39/155 [00:09<00:27,  4.17it/s]
 26%|██▌       | 40/155 [00:09<00:26,  4.29it/s]
 26%|██▋       | 41/155 [00:09<00:27,  4.17it/s]
 27%|██▋       | 42/155 [00:10<00:26,  4.24it/s]
 28%|██▊       | 43/155 [00:10<00:26,  4.22it/s]
 28%|██▊       | 44/155 [00:10<00:26,  4.20it/s]
 29%|██▉       | 45/155 [00:10<00:25,  4.32it/s]
 30%|██▉       | 46/155 [00:11<00:25,  4.20it/s]
 30%|███       | 47/155 [00:11<00:25,  4.18it/s]
 31%|███       | 48/155 [00:11<00:25,  4.18it/s]
 32%|███▏      | 49/155 [00:11<00:24,  4.29it/s]
 32%|███▏      | 50/155 [00:11<00:25,  4.19it/s]
 33%|███▎      | 51/155 [00:12<00:24,  4.17it/s]
 34%|███▎      | 52/155 [00:12<00:25,  4.03it/s]
 34%|███▍      | 53/155 [00:12<00:24,  4.09it/s]
 35%|███▍      | 54/155 [00:12<00:23,  4.24it/s]
 35%|███▌      | 55/155 [00:13<00:23,  4.27it/s]
 36%|███▌      | 56/155 [00:13<00:23,  4.29it/s]
 37%|███▋      | 57/155 [00:13<00:23,  4.24it/s]
 37%|███▋      | 58/155 [00:13<00:23,  4.21it/s]
 38%|███▊      | 59/155 [00:14<00:22,  4.23it/s]
 39%|███▊      | 60/155 [00:14<00:21,  4.34it/s]
 39%|███▉      | 61/155 [00:14<00:23,  4.08it/s]
 40%|████      | 62/155 [00:14<00:22,  4.17it/s]
 41%|████      | 63/155 [00:15<00:21,  4.23it/s]
 41%|████▏     | 64/155 [00:15<00:21,  4.23it/s]
 42%|████▏     | 65/155 [00:15<00:20,  4.36it/s]
 43%|████▎     | 66/155 [00:15<00:20,  4.26it/s]
 43%|████▎     | 67/155 [00:15<00:20,  4.35it/s]
 44%|████▍     | 68/155 [00:16<00:19,  4.44it/s]
 45%|████▍     | 69/155 [00:16<00:19,  4.35it/s]
 45%|████▌     | 70/155 [00:16<00:19,  4.29it/s]
 46%|████▌     | 71/155 [00:16<00:19,  4.30it/s]
 46%|████▋     | 72/155 [00:17<00:20,  4.00it/s]
 47%|████▋     | 73/155 [00:17<00:21,  3.81it/s]
 48%|████▊     | 74/155 [00:17<00:20,  3.89it/s]
 48%|████▊     | 75/155 [00:17<00:19,  4.03it/s]
 49%|████▉     | 76/155 [00:18<00:19,  4.11it/s]
 50%|████▉     | 77/155 [00:18<00:19,  4.10it/s]
 50%|█████     | 78/155 [00:18<00:18,  4.13it/s]
 51%|█████     | 79/155 [00:18<00:17,  4.31it/s]
 52%|█████▏    | 80/155 [00:19<00:16,  4.45it/s]
 52%|█████▏    | 81/155 [00:19<00:17,  4.28it/s]
 53%|█████▎    | 82/155 [00:19<00:16,  4.30it/s]
 54%|█████▎    | 83/155 [00:19<00:17,  4.13it/s]
 54%|█████▍    | 84/155 [00:20<00:16,  4.24it/s]
 55%|█████▍    | 85/155 [00:20<00:16,  4.26it/s]
 55%|█████▌    | 86/155 [00:20<00:16,  4.29it/s]
 56%|█████▌    | 87/155 [00:20<00:15,  4.35it/s]
 57%|█████▋    | 88/155 [00:20<00:15,  4.42it/s]
 57%|█████▋    | 89/155 [00:21<00:14,  4.54it/s]
 58%|█████▊    | 90/155 [00:21<00:14,  4.49it/s]
 59%|█████▊    | 91/155 [00:21<00:14,  4.43it/s]
 59%|█████▉    | 92/155 [00:21<00:14,  4.47it/s]
 60%|██████    | 93/155 [00:22<00:13,  4.54it/s]
 61%|██████    | 94/155 [00:22<00:13,  4.52it/s]
 61%|██████▏   | 95/155 [00:22<00:13,  4.46it/s]
 62%|██████▏   | 96/155 [00:22<00:13,  4.36it/s]
 63%|██████▎   | 97/155 [00:22<00:13,  4.42it/s]
 63%|██████▎   | 98/155 [00:23<00:13,  4.34it/s]
 64%|██████▍   | 99/155 [00:23<00:12,  4.41it/s]
 65%|██████▍   | 100/155 [00:23<00:12,  4.31it/s]
 65%|██████▌   | 101/155 [00:23<00:12,  4.32it/s]
 66%|██████▌   | 102/155 [00:24<00:12,  4.32it/s]
 66%|██████▋   | 103/155 [00:24<00:12,  4.19it/s]
 67%|██████▋   | 104/155 [00:24<00:12,  4.23it/s]
 68%|██████▊   | 105/155 [00:24<00:11,  4.24it/s]
 68%|██████▊   | 106/155 [00:25<00:11,  4.22it/s]
 69%|██████▉   | 107/155 [00:25<00:11,  4.27it/s]
 70%|██████▉   | 108/155 [00:25<00:11,  4.22it/s]
 70%|███████   | 109/155 [00:25<00:10,  4.27it/s]
 71%|███████   | 110/155 [00:26<00:10,  4.29it/s]
 72%|███████▏  | 111/155 [00:26<00:09,  4.44it/s]
 72%|███████▏  | 112/155 [00:26<00:09,  4.35it/s]
 73%|███████▎  | 113/155 [00:26<00:09,  4.32it/s]
 74%|███████▎  | 114/155 [00:26<00:09,  4.15it/s]
 74%|███████▍  | 115/155 [00:27<00:09,  4.07it/s]
 75%|███████▍  | 116/155 [00:27<00:09,  4.21it/s]
 75%|███████▌  | 117/155 [00:27<00:09,  4.19it/s]
 76%|███████▌  | 118/155 [00:27<00:08,  4.37it/s]
 77%|███████▋  | 119/155 [00:28<00:08,  4.04it/s]
 77%|███████▋  | 120/155 [00:28<00:08,  4.13it/s]
 78%|███████▊  | 121/155 [00:28<00:08,  4.01it/s]
 79%|███████▊  | 122/155 [00:28<00:08,  4.11it/s]
 79%|███████▉  | 123/155 [00:29<00:07,  4.17it/s]
 80%|████████  | 124/155 [00:29<00:07,  4.08it/s]
 81%|████████  | 125/155 [00:29<00:07,  4.25it/s]
 81%|████████▏ | 126/155 [00:29<00:06,  4.25it/s]
 82%|████████▏ | 127/155 [00:30<00:06,  4.36it/s]
 83%|████████▎ | 128/155 [00:30<00:06,  4.23it/s]
 83%|████████▎ | 129/155 [00:30<00:06,  4.12it/s]
 84%|████████▍ | 130/155 [00:30<00:06,  4.06it/s]
 85%|████████▍ | 131/155 [00:31<00:06,  3.98it/s]
 85%|████████▌ | 132/155 [00:31<00:05,  4.15it/s]
 86%|████████▌ | 133/155 [00:31<00:05,  4.22it/s]
 86%|████████▋ | 134/155 [00:31<00:05,  4.13it/s]
 87%|████████▋ | 135/155 [00:32<00:04,  4.22it/s]
 88%|████████▊ | 136/155 [00:32<00:04,  4.29it/s]
 88%|████████▊ | 137/155 [00:32<00:04,  4.38it/s]
 89%|████████▉ | 138/155 [00:32<00:04,  4.25it/s]
 90%|████████▉ | 139/155 [00:32<00:03,  4.21it/s]
 90%|█████████ | 140/155 [00:33<00:03,  4.20it/s]
 91%|█████████ | 141/155 [00:33<00:03,  4.18it/s]
 92%|█████████▏| 142/155 [00:33<00:03,  4.30it/s]
 92%|█████████▏| 143/155 [00:33<00:02,  4.40it/s]
 93%|█████████▎| 144/155 [00:34<00:02,  4.18it/s]
 94%|█████████▎| 145/155 [00:34<00:02,  4.21it/s]
 94%|█████████▍| 146/155 [00:34<00:02,  4.31it/s]
 95%|█████████▍| 147/155 [00:34<00:01,  4.32it/s]
 95%|█████████▌| 148/155 [00:35<00:01,  4.41it/s]
 96%|█████████▌| 149/155 [00:35<00:01,  4.34it/s]
 97%|█████████▋| 150/155 [00:35<00:01,  4.39it/s]
 97%|█████████▋| 151/155 [00:35<00:00,  4.45it/s]
 98%|█████████▊| 152/155 [00:35<00:00,  4.52it/s]
 99%|█████████▊| 153/155 [00:36<00:00,  4.50it/s]
 99%|█████████▉| 154/155 [00:36<00:00,  4.18it/s]
100%|██████████| 155/155 [00:36<00:00,  4.24it/s]
+-------+------------------------+--------------------+-------------+-------------+-----------+----------+
| epoch |           lr           |     train_loss     | val_top1acc | val_top3acc | val_ndcg1 | val_mrr3 |
+-------+------------------------+--------------------+-------------+-------------+-----------+----------+
|   0   | 1.0000000000000023e-05 | 2.2853724935689868 |    43.42    |    76.27    |   67.87   |  57.81   |
|   1   |  9.99112027792722e-06  | 1.5891911364018136 |    52.55    |    82.72    |   74.75   |  66.10   |
+-------+------------------------+--------------------+-------------+-------------+-----------+----------+
/ceph/hpc/home/eujongc/anaconda3/envs/latentops/lib/python3.9/site-packages/torch/utils/data/dataloader.py:554: UserWarning: This DataLoader will create 4 worker processes in total. Our suggested max number of worker in current system is 2, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(_create_warning_msg(
Train Epoch: [2]  [  0/229]  eta: 0:04:24  lr: 0.000010  loss: 1.5627  time: 1.1570  data: 0.0887  max mem: 30242
Train Epoch: [2]  [ 50/229]  eta: 0:03:26  lr: 0.000010  loss: 1.2043  time: 1.1491  data: 0.0001  max mem: 30242
Train Epoch: [2]  [100/229]  eta: 0:02:27  lr: 0.000010  loss: 1.4849  time: 1.1404  data: 0.0001  max mem: 30242
Train Epoch: [2]  [150/229]  eta: 0:01:30  lr: 0.000010  loss: 1.1983  time: 1.1506  data: 0.0001  max mem: 30242
Train Epoch: [2]  [200/229]  eta: 0:00:33  lr: 0.000010  loss: 0.8299  time: 1.1484  data: 0.0001  max mem: 30242
Train Epoch: [2]  [228/229]  eta: 0:00:01  lr: 0.000010  loss: 1.2194  time: 1.1670  data: 0.0001  max mem: 30242
2023-07-10 16:26:19,982 Train Epoch: [2] Total time: 0:04:24 (1.1538 s / it)
2023-07-10 16:26:19,985 Computing features for evaluation...

  0%|          | 0/154 [00:00<?, ?it/s]
  1%|          | 1/154 [00:00<00:51,  2.97it/s]
  1%|▏         | 2/154 [00:00<00:40,  3.71it/s]
  2%|▏         | 3/154 [00:00<00:37,  3.98it/s]
  3%|▎         | 4/154 [00:01<00:36,  4.14it/s]
  3%|▎         | 5/154 [00:01<00:36,  4.09it/s]
  4%|▍         | 6/154 [00:01<00:34,  4.25it/s]
  5%|▍         | 7/154 [00:01<00:32,  4.47it/s]
  5%|▌         | 8/154 [00:01<00:33,  4.37it/s]
  6%|▌         | 9/154 [00:02<00:33,  4.28it/s]
  6%|▋         | 10/154 [00:02<00:32,  4.37it/s]
  7%|▋         | 11/154 [00:02<00:33,  4.22it/s]
  8%|▊         | 12/154 [00:02<00:33,  4.20it/s]
  8%|▊         | 13/154 [00:03<00:33,  4.25it/s]
  9%|▉         | 14/154 [00:03<00:33,  4.21it/s]
 10%|▉         | 15/154 [00:03<00:32,  4.22it/s]
 10%|█         | 16/154 [00:03<00:31,  4.34it/s]
 11%|█         | 17/154 [00:04<00:31,  4.32it/s]
 12%|█▏        | 18/154 [00:04<00:31,  4.32it/s]
 12%|█▏        | 19/154 [00:04<00:32,  4.18it/s]
 13%|█▎        | 20/154 [00:04<00:32,  4.17it/s]
 14%|█▎        | 21/154 [00:04<00:30,  4.30it/s]
 14%|█▍        | 22/154 [00:05<00:29,  4.43it/s]
 15%|█▍        | 23/154 [00:05<00:29,  4.48it/s]
 16%|█▌        | 24/154 [00:05<00:29,  4.45it/s]
 16%|█▌        | 25/154 [00:05<00:29,  4.43it/s]
 17%|█▋        | 26/154 [00:06<00:29,  4.40it/s]
 18%|█▊        | 27/154 [00:06<00:28,  4.47it/s]
 18%|█▊        | 28/154 [00:06<00:28,  4.37it/s]
 19%|█▉        | 29/154 [00:06<00:28,  4.44it/s]
 19%|█▉        | 30/154 [00:06<00:27,  4.50it/s]
 20%|██        | 31/154 [00:07<00:27,  4.45it/s]
 21%|██        | 32/154 [00:07<00:27,  4.49it/s]
 21%|██▏       | 33/154 [00:07<00:27,  4.44it/s]
 22%|██▏       | 34/154 [00:07<00:27,  4.33it/s]
 23%|██▎       | 35/154 [00:08<00:27,  4.39it/s]
 23%|██▎       | 36/154 [00:08<00:26,  4.37it/s]
 24%|██▍       | 37/154 [00:08<00:26,  4.34it/s]
 25%|██▍       | 38/154 [00:08<00:26,  4.39it/s]
 25%|██▌       | 39/154 [00:09<00:25,  4.45it/s]
 26%|██▌       | 40/154 [00:09<00:25,  4.43it/s]
 27%|██▋       | 41/154 [00:09<00:26,  4.26it/s]
 27%|██▋       | 42/154 [00:09<00:26,  4.22it/s]
 28%|██▊       | 43/154 [00:10<00:26,  4.20it/s]
 29%|██▊       | 44/154 [00:10<00:25,  4.39it/s]
 29%|██▉       | 45/154 [00:10<00:25,  4.30it/s]
 30%|██▉       | 46/154 [00:10<00:24,  4.40it/s]
 31%|███       | 47/154 [00:10<00:24,  4.38it/s]
 31%|███       | 48/154 [00:11<00:24,  4.41it/s]
 32%|███▏      | 49/154 [00:11<00:23,  4.38it/s]
 32%|███▏      | 50/154 [00:11<00:24,  4.31it/s]
 33%|███▎      | 51/154 [00:11<00:23,  4.39it/s]
 34%|███▍      | 52/154 [00:12<00:23,  4.29it/s]
 34%|███▍      | 53/154 [00:12<00:23,  4.27it/s]
 35%|███▌      | 54/154 [00:12<00:22,  4.36it/s]
 36%|███▌      | 55/154 [00:12<00:23,  4.29it/s]
 36%|███▋      | 56/154 [00:12<00:23,  4.25it/s]
 37%|███▋      | 57/154 [00:13<00:22,  4.36it/s]
 38%|███▊      | 58/154 [00:13<00:22,  4.35it/s]
 38%|███▊      | 59/154 [00:13<00:21,  4.39it/s]
 39%|███▉      | 60/154 [00:13<00:22,  4.25it/s]
 40%|███▉      | 61/154 [00:14<00:21,  4.26it/s]
 40%|████      | 62/154 [00:14<00:21,  4.29it/s]
 41%|████      | 63/154 [00:14<00:21,  4.30it/s]
 42%|████▏     | 64/154 [00:14<00:20,  4.38it/s]
 42%|████▏     | 65/154 [00:15<00:21,  4.18it/s]
 43%|████▎     | 66/154 [00:15<00:21,  4.10it/s]
 44%|████▎     | 67/154 [00:15<00:21,  4.11it/s]
 44%|████▍     | 68/154 [00:15<00:20,  4.24it/s]
 45%|████▍     | 69/154 [00:16<00:19,  4.26it/s]
 45%|████▌     | 70/154 [00:16<00:19,  4.36it/s]
 46%|████▌     | 71/154 [00:16<00:19,  4.34it/s]
 47%|████▋     | 72/154 [00:16<00:19,  4.29it/s]
 47%|████▋     | 73/154 [00:16<00:18,  4.29it/s]
 48%|████▊     | 74/154 [00:17<00:18,  4.30it/s]
 49%|████▊     | 75/154 [00:17<00:18,  4.29it/s]
 49%|████▉     | 76/154 [00:17<00:18,  4.15it/s]
 50%|█████     | 77/154 [00:17<00:18,  4.27it/s]
 51%|█████     | 78/154 [00:18<00:17,  4.23it/s]
 51%|█████▏    | 79/154 [00:18<00:17,  4.30it/s]
 52%|█████▏    | 80/154 [00:18<00:17,  4.13it/s]
 53%|█████▎    | 81/154 [00:18<00:16,  4.32it/s]
 53%|█████▎    | 82/154 [00:19<00:16,  4.40it/s]
 54%|█████▍    | 83/154 [00:19<00:16,  4.24it/s]
 55%|█████▍    | 84/154 [00:19<00:16,  4.29it/s]
 55%|█████▌    | 85/154 [00:19<00:15,  4.44it/s]
 56%|█████▌    | 86/154 [00:19<00:15,  4.35it/s]
 56%|█████▋    | 87/154 [00:20<00:15,  4.34it/s]
 57%|█████▋    | 88/154 [00:20<00:15,  4.22it/s]
 58%|█████▊    | 89/154 [00:20<00:15,  4.23it/s]
 58%|█████▊    | 90/154 [00:20<00:14,  4.33it/s]
 59%|█████▉    | 91/154 [00:21<00:14,  4.33it/s]
 60%|█████▉    | 92/154 [00:21<00:15,  3.95it/s]
 60%|██████    | 93/154 [00:21<00:15,  3.99it/s]
 61%|██████    | 94/154 [00:21<00:15,  3.92it/s]
 62%|██████▏   | 95/154 [00:22<00:15,  3.93it/s]
 62%|██████▏   | 96/154 [00:22<00:14,  3.94it/s]
 63%|██████▎   | 97/154 [00:22<00:14,  4.01it/s]
 64%|██████▎   | 98/154 [00:22<00:13,  4.18it/s]
 64%|██████▍   | 99/154 [00:23<00:13,  4.12it/s]
 65%|██████▍   | 100/154 [00:23<00:13,  4.08it/s]
 66%|██████▌   | 101/154 [00:23<00:12,  4.17it/s]
 66%|██████▌   | 102/154 [00:23<00:12,  4.30it/s]
 67%|██████▋   | 103/154 [00:24<00:11,  4.30it/s]
 68%|██████▊   | 104/154 [00:24<00:11,  4.31it/s]
 68%|██████▊   | 105/154 [00:24<00:11,  4.31it/s]
 69%|██████▉   | 106/154 [00:24<00:10,  4.37it/s]
 69%|██████▉   | 107/154 [00:25<00:10,  4.33it/s]
 70%|███████   | 108/154 [00:25<00:10,  4.20it/s]
 71%|███████   | 109/154 [00:25<00:10,  4.32it/s]
 71%|███████▏  | 110/154 [00:25<00:10,  4.19it/s]
 72%|███████▏  | 111/154 [00:25<00:10,  4.28it/s]
 73%|███████▎  | 112/154 [00:26<00:09,  4.24it/s]
 73%|███████▎  | 113/154 [00:26<00:09,  4.27it/s]
 74%|███████▍  | 114/154 [00:26<00:09,  4.35it/s]
 75%|███████▍  | 115/154 [00:26<00:08,  4.36it/s]
 75%|███████▌  | 116/154 [00:27<00:08,  4.37it/s]
 76%|███████▌  | 117/154 [00:27<00:08,  4.41it/s]
 77%|███████▋  | 118/154 [00:27<00:08,  4.38it/s]
 77%|███████▋  | 119/154 [00:27<00:07,  4.44it/s]
 78%|███████▊  | 120/154 [00:28<00:07,  4.57it/s]
 79%|███████▊  | 121/154 [00:28<00:07,  4.55it/s]
 79%|███████▉  | 122/154 [00:28<00:07,  4.56it/s]
 80%|███████▉  | 123/154 [00:28<00:07,  4.35it/s]
 81%|████████  | 124/154 [00:28<00:06,  4.33it/s]
 81%|████████  | 125/154 [00:29<00:06,  4.41it/s]
 82%|████████▏ | 126/154 [00:29<00:06,  4.26it/s]
 82%|████████▏ | 127/154 [00:29<00:06,  4.28it/s]
 83%|████████▎ | 128/154 [00:29<00:06,  4.05it/s]
 84%|████████▍ | 129/154 [00:30<00:06,  4.14it/s]
 84%|████████▍ | 130/154 [00:30<00:05,  4.18it/s]
 85%|████████▌ | 131/154 [00:30<00:05,  4.22it/s]
 86%|████████▌ | 132/154 [00:30<00:05,  4.33it/s]
 86%|████████▋ | 133/154 [00:31<00:04,  4.26it/s]
 87%|████████▋ | 134/154 [00:31<00:04,  4.09it/s]
 88%|████████▊ | 135/154 [00:31<00:04,  4.17it/s]
 88%|████████▊ | 136/154 [00:31<00:04,  4.33it/s]
 89%|████████▉ | 137/154 [00:31<00:03,  4.38it/s]
 90%|████████▉ | 138/154 [00:32<00:03,  4.51it/s]
 90%|█████████ | 139/154 [00:32<00:03,  4.52it/s]
 91%|█████████ | 140/154 [00:32<00:03,  4.39it/s]
 92%|█████████▏| 141/154 [00:32<00:02,  4.33it/s]
 92%|█████████▏| 142/154 [00:33<00:02,  4.34it/s]
 93%|█████████▎| 143/154 [00:33<00:02,  4.34it/s]
 94%|█████████▎| 144/154 [00:33<00:02,  4.25it/s]
 94%|█████████▍| 145/154 [00:33<00:02,  4.41it/s]
 95%|█████████▍| 146/154 [00:34<00:01,  4.39it/s]
 95%|█████████▌| 147/154 [00:34<00:01,  4.26it/s]
 96%|█████████▌| 148/154 [00:34<00:01,  4.18it/s]
 97%|█████████▋| 149/154 [00:34<00:01,  4.32it/s]
 97%|█████████▋| 150/154 [00:34<00:00,  4.33it/s]
 98%|█████████▊| 151/154 [00:35<00:00,  4.22it/s]
 99%|█████████▊| 152/154 [00:35<00:00,  4.40it/s]
 99%|█████████▉| 153/154 [00:35<00:00,  4.28it/s]
100%|██████████| 154/154 [00:35<00:00,  4.30it/s]
2023-07-10 16:26:57,271 Computing features for evaluation...

  0%|          | 0/155 [00:00<?, ?it/s]/ceph/hpc/home/eujongc/anaconda3/envs/latentops/lib/python3.9/site-packages/torch/utils/data/dataloader.py:554: UserWarning: This DataLoader will create 4 worker processes in total. Our suggested max number of worker in current system is 2, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(_create_warning_msg(

  1%|          | 1/155 [00:00<00:50,  3.08it/s]
  1%|▏         | 2/155 [00:00<00:40,  3.80it/s]
  2%|▏         | 3/155 [00:00<00:37,  4.06it/s]
  3%|▎         | 4/155 [00:01<00:39,  3.80it/s]
  3%|▎         | 5/155 [00:01<00:38,  3.86it/s]
  4%|▍         | 6/155 [00:01<00:36,  4.07it/s]
  5%|▍         | 7/155 [00:01<00:35,  4.11it/s]
  5%|▌         | 8/155 [00:01<00:35,  4.20it/s]
  6%|▌         | 9/155 [00:02<00:34,  4.24it/s]
  6%|▋         | 10/155 [00:02<00:33,  4.27it/s]
  7%|▋         | 11/155 [00:02<00:34,  4.15it/s]
  8%|▊         | 12/155 [00:02<00:33,  4.23it/s]
  8%|▊         | 13/155 [00:03<00:33,  4.18it/s]
  9%|▉         | 14/155 [00:03<00:34,  4.11it/s]
 10%|▉         | 15/155 [00:03<00:34,  4.02it/s]
 10%|█         | 16/155 [00:04<00:39,  3.55it/s]
 11%|█         | 17/155 [00:04<00:37,  3.69it/s]
 12%|█▏        | 18/155 [00:04<00:36,  3.76it/s]
 12%|█▏        | 19/155 [00:04<00:34,  3.97it/s]
 13%|█▎        | 20/155 [00:05<00:33,  4.00it/s]
 14%|█▎        | 21/155 [00:05<00:32,  4.16it/s]
 14%|█▍        | 22/155 [00:05<00:30,  4.33it/s]
 15%|█▍        | 23/155 [00:05<00:30,  4.32it/s]
 15%|█▌        | 24/155 [00:05<00:30,  4.27it/s]
 16%|█▌        | 25/155 [00:06<00:29,  4.36it/s]
 17%|█▋        | 26/155 [00:06<00:30,  4.21it/s]
 17%|█▋        | 27/155 [00:06<00:30,  4.25it/s]
 18%|█▊        | 28/155 [00:06<00:29,  4.33it/s]
 19%|█▊        | 29/155 [00:07<00:29,  4.22it/s]
 19%|█▉        | 30/155 [00:07<00:30,  4.13it/s]
 20%|██        | 31/155 [00:07<00:30,  4.08it/s]
 21%|██        | 32/155 [00:07<00:29,  4.22it/s]
 21%|██▏       | 33/155 [00:08<00:28,  4.25it/s]
 22%|██▏       | 34/155 [00:08<00:28,  4.22it/s]
 23%|██▎       | 35/155 [00:08<00:28,  4.19it/s]
 23%|██▎       | 36/155 [00:08<00:28,  4.13it/s]
 24%|██▍       | 37/155 [00:09<00:29,  4.01it/s]
 25%|██▍       | 38/155 [00:09<00:28,  4.09it/s]
 25%|██▌       | 39/155 [00:09<00:27,  4.17it/s]
 26%|██▌       | 40/155 [00:09<00:26,  4.29it/s]
 26%|██▋       | 41/155 [00:09<00:27,  4.17it/s]
 27%|██▋       | 42/155 [00:10<00:26,  4.24it/s]
 28%|██▊       | 43/155 [00:10<00:26,  4.23it/s]
 28%|██▊       | 44/155 [00:10<00:26,  4.21it/s]
 29%|██▉       | 45/155 [00:10<00:25,  4.33it/s]
 30%|██▉       | 46/155 [00:11<00:25,  4.20it/s]
 30%|███       | 47/155 [00:11<00:25,  4.18it/s]
 31%|███       | 48/155 [00:11<00:25,  4.18it/s]
 32%|███▏      | 49/155 [00:11<00:24,  4.29it/s]
 32%|███▏      | 50/155 [00:12<00:24,  4.20it/s]
 33%|███▎      | 51/155 [00:12<00:24,  4.18it/s]
 34%|███▎      | 52/155 [00:12<00:25,  4.03it/s]
 34%|███▍      | 53/155 [00:12<00:24,  4.10it/s]
 35%|███▍      | 54/155 [00:13<00:23,  4.25it/s]
 35%|███▌      | 55/155 [00:13<00:23,  4.28it/s]
 36%|███▌      | 56/155 [00:13<00:23,  4.29it/s]
 37%|███▋      | 57/155 [00:13<00:23,  4.23it/s]
 37%|███▋      | 58/155 [00:14<00:23,  4.20it/s]
 38%|███▊      | 59/155 [00:14<00:22,  4.23it/s]
 39%|███▊      | 60/155 [00:14<00:21,  4.35it/s]
 39%|███▉      | 61/155 [00:14<00:22,  4.09it/s]
 40%|████      | 62/155 [00:14<00:22,  4.18it/s]
 41%|████      | 63/155 [00:15<00:21,  4.23it/s]
 41%|████▏     | 64/155 [00:15<00:21,  4.24it/s]
 42%|████▏     | 65/155 [00:15<00:20,  4.40it/s]
 43%|████▎     | 66/155 [00:15<00:20,  4.30it/s]
 43%|████▎     | 67/155 [00:16<00:20,  4.38it/s]
 44%|████▍     | 68/155 [00:16<00:19,  4.46it/s]
 45%|████▍     | 69/155 [00:16<00:19,  4.37it/s]
 45%|████▌     | 70/155 [00:16<00:19,  4.30it/s]
 46%|████▌     | 71/155 [00:17<00:19,  4.31it/s]
 46%|████▋     | 72/155 [00:17<00:20,  4.02it/s]
 47%|████▋     | 73/155 [00:17<00:21,  3.82it/s]
 48%|████▊     | 74/155 [00:17<00:20,  3.90it/s]
 48%|████▊     | 75/155 [00:18<00:19,  4.04it/s]
 49%|████▉     | 76/155 [00:18<00:19,  4.12it/s]
 50%|████▉     | 77/155 [00:18<00:18,  4.12it/s]
 50%|█████     | 78/155 [00:18<00:18,  4.13it/s]
 51%|█████     | 79/155 [00:19<00:17,  4.31it/s]
 52%|█████▏    | 80/155 [00:19<00:16,  4.46it/s]
 52%|█████▏    | 81/155 [00:19<00:17,  4.29it/s]
 53%|█████▎    | 82/155 [00:19<00:16,  4.30it/s]
 54%|█████▎    | 83/155 [00:19<00:17,  4.14it/s]
 54%|█████▍    | 84/155 [00:20<00:16,  4.25it/s]
 55%|█████▍    | 85/155 [00:20<00:16,  4.27it/s]
 55%|█████▌    | 86/155 [00:20<00:16,  4.30it/s]
 56%|█████▌    | 87/155 [00:20<00:15,  4.37it/s]
 57%|█████▋    | 88/155 [00:21<00:15,  4.44it/s]
 57%|█████▋    | 89/155 [00:21<00:14,  4.55it/s]
 58%|█████▊    | 90/155 [00:21<00:14,  4.50it/s]
 59%|█████▊    | 91/155 [00:21<00:14,  4.44it/s]
 59%|█████▉    | 92/155 [00:21<00:14,  4.49it/s]
 60%|██████    | 93/155 [00:22<00:13,  4.57it/s]
 61%|██████    | 94/155 [00:22<00:13,  4.54it/s]
 61%|██████▏   | 95/155 [00:22<00:13,  4.48it/s]
 62%|██████▏   | 96/155 [00:22<00:13,  4.38it/s]
 63%|██████▎   | 97/155 [00:23<00:13,  4.44it/s]
 63%|██████▎   | 98/155 [00:23<00:13,  4.36it/s]
 64%|██████▍   | 99/155 [00:23<00:12,  4.43it/s]
 65%|██████▍   | 100/155 [00:23<00:12,  4.33it/s]
 65%|██████▌   | 101/155 [00:24<00:12,  4.33it/s]
 66%|██████▌   | 102/155 [00:24<00:12,  4.34it/s]
 66%|██████▋   | 103/155 [00:24<00:12,  4.20it/s]
 67%|██████▋   | 104/155 [00:24<00:12,  4.24it/s]
 68%|██████▊   | 105/155 [00:24<00:11,  4.25it/s]
 68%|██████▊   | 106/155 [00:25<00:11,  4.23it/s]
 69%|██████▉   | 107/155 [00:25<00:11,  4.28it/s]
 70%|██████▉   | 108/155 [00:25<00:11,  4.23it/s]
 70%|███████   | 109/155 [00:25<00:10,  4.28it/s]
 71%|███████   | 110/155 [00:26<00:10,  4.30it/s]
 72%|███████▏  | 111/155 [00:26<00:09,  4.45it/s]
 72%|███████▏  | 112/155 [00:26<00:09,  4.36it/s]
 73%|███████▎  | 113/155 [00:26<00:09,  4.33it/s]
 74%|███████▎  | 114/155 [00:27<00:09,  4.15it/s]
 74%|███████▍  | 115/155 [00:27<00:09,  4.08it/s]
 75%|███████▍  | 116/155 [00:27<00:09,  4.22it/s]
 75%|███████▌  | 117/155 [00:27<00:09,  4.19it/s]
 76%|███████▌  | 118/155 [00:28<00:08,  4.37it/s]
 77%|███████▋  | 119/155 [00:28<00:08,  4.04it/s]
 77%|███████▋  | 120/155 [00:28<00:08,  4.13it/s]
 78%|███████▊  | 121/155 [00:28<00:08,  4.02it/s]
 79%|███████▊  | 122/155 [00:29<00:08,  4.11it/s]
 79%|███████▉  | 123/155 [00:29<00:07,  4.18it/s]
 80%|████████  | 124/155 [00:29<00:07,  4.08it/s]
 81%|████████  | 125/155 [00:29<00:07,  4.25it/s]
 81%|████████▏ | 126/155 [00:29<00:06,  4.25it/s]
 82%|████████▏ | 127/155 [00:30<00:06,  4.37it/s]
 83%|████████▎ | 128/155 [00:30<00:06,  4.23it/s]
 83%|████████▎ | 129/155 [00:30<00:06,  4.13it/s]
 84%|████████▍ | 130/155 [00:30<00:06,  4.07it/s]
 85%|████████▍ | 131/155 [00:31<00:06,  3.99it/s]
 85%|████████▌ | 132/155 [00:31<00:05,  4.16it/s]
 86%|████████▌ | 133/155 [00:31<00:05,  4.22it/s]
 86%|████████▋ | 134/155 [00:31<00:05,  4.13it/s]
 87%|████████▋ | 135/155 [00:32<00:04,  4.22it/s]
 88%|████████▊ | 136/155 [00:32<00:04,  4.31it/s]
 88%|████████▊ | 137/155 [00:32<00:04,  4.40it/s]
 89%|████████▉ | 138/155 [00:32<00:03,  4.26it/s]
 90%|████████▉ | 139/155 [00:33<00:03,  4.23it/s]
 90%|█████████ | 140/155 [00:33<00:03,  4.22it/s]
 91%|█████████ | 141/155 [00:33<00:03,  4.19it/s]
 92%|█████████▏| 142/155 [00:33<00:03,  4.31it/s]
 92%|█████████▏| 143/155 [00:33<00:02,  4.42it/s]
 93%|█████████▎| 144/155 [00:34<00:02,  4.19it/s]
 94%|█████████▎| 145/155 [00:34<00:02,  4.22it/s]
 94%|█████████▍| 146/155 [00:34<00:02,  4.33it/s]
 95%|█████████▍| 147/155 [00:34<00:01,  4.33it/s]
 95%|█████████▌| 148/155 [00:35<00:01,  4.43it/s]
 96%|█████████▌| 149/155 [00:35<00:01,  4.35it/s]
 97%|█████████▋| 150/155 [00:35<00:01,  4.41it/s]
 97%|█████████▋| 151/155 [00:35<00:00,  4.46it/s]
 98%|█████████▊| 152/155 [00:36<00:00,  4.54it/s]
 99%|█████████▊| 153/155 [00:36<00:00,  4.52it/s]
 99%|█████████▉| 154/155 [00:36<00:00,  4.20it/s]
100%|██████████| 155/155 [00:36<00:00,  4.22it/s]
+-------+------------------------+--------------------+-------------+-------------+-----------+----------+
| epoch |           lr           |     train_loss     | val_top1acc | val_top3acc | val_ndcg1 | val_mrr3 |
+-------+------------------------+--------------------+-------------+-------------+-----------+----------+
|   0   | 1.0000000000000023e-05 | 2.2853724935689868 |    43.42    |    76.27    |   67.87   |  57.81   |
|   1   |  9.99112027792722e-06  | 1.5891911364018136 |    52.55    |    82.72    |   74.75   |  66.10   |
|   2   | 9.964516155915175e-06  | 1.2577084753190586 |    58.79    |    87.16    |   78.59   |  71.44   |
+-------+------------------------+--------------------+-------------+-------------+-----------+----------+
/ceph/hpc/home/eujongc/anaconda3/envs/latentops/lib/python3.9/site-packages/torch/utils/data/dataloader.py:554: UserWarning: This DataLoader will create 4 worker processes in total. Our suggested max number of worker in current system is 2, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(_create_warning_msg(
Train Epoch: [3]  [  0/229]  eta: 0:04:47  lr: 0.000010  loss: 1.0162  time: 1.2544  data: 0.1191  max mem: 30242
Train Epoch: [3]  [ 50/229]  eta: 0:03:23  lr: 0.000010  loss: 1.2913  time: 1.1352  data: 0.0001  max mem: 30242
Train Epoch: [3]  [100/229]  eta: 0:02:26  lr: 0.000010  loss: 1.0778  time: 1.1479  data: 0.0001  max mem: 30242
Train Epoch: [3]  [150/229]  eta: 0:01:29  lr: 0.000010  loss: 0.8708  time: 1.1495  data: 0.0001  max mem: 30242
Train Epoch: [3]  [200/229]  eta: 0:00:33  lr: 0.000010  loss: 0.8078  time: 1.1688  data: 0.0001  max mem: 30242
Train Epoch: [3]  [228/229]  eta: 0:00:01  lr: 0.000010  loss: 1.1054  time: 1.1555  data: 0.0001  max mem: 30242
2023-07-10 16:31:56,754 Train Epoch: [3] Total time: 0:04:22 (1.1456 s / it)
2023-07-10 16:31:56,758 Computing features for evaluation...

  0%|          | 0/154 [00:00<?, ?it/s]
  1%|          | 1/154 [00:00<00:52,  2.92it/s]
  1%|▏         | 2/154 [00:00<00:41,  3.67it/s]
  2%|▏         | 3/154 [00:00<00:38,  3.95it/s]
  3%|▎         | 4/154 [00:01<00:36,  4.14it/s]
  3%|▎         | 5/154 [00:01<00:36,  4.09it/s]
  4%|▍         | 6/154 [00:01<00:34,  4.25it/s]
  5%|▍         | 7/154 [00:01<00:32,  4.46it/s]
  5%|▌         | 8/154 [00:01<00:33,  4.36it/s]
  6%|▌         | 9/154 [00:02<00:33,  4.28it/s]
  6%|▋         | 10/154 [00:02<00:32,  4.38it/s]
  7%|▋         | 11/154 [00:02<00:33,  4.23it/s]
  8%|▊         | 12/154 [00:02<00:33,  4.20it/s]
  8%|▊         | 13/154 [00:03<00:33,  4.25it/s]
  9%|▉         | 14/154 [00:03<00:33,  4.22it/s]
 10%|▉         | 15/154 [00:03<00:32,  4.23it/s]
 10%|█         | 16/154 [00:03<00:31,  4.35it/s]
 11%|█         | 17/154 [00:04<00:31,  4.34it/s]
 12%|█▏        | 18/154 [00:04<00:31,  4.34it/s]
 12%|█▏        | 19/154 [00:04<00:32,  4.19it/s]
 13%|█▎        | 20/154 [00:04<00:32,  4.17it/s]
 14%|█▎        | 21/154 [00:04<00:30,  4.30it/s]
 14%|█▍        | 22/154 [00:05<00:29,  4.43it/s]
 15%|█▍        | 23/154 [00:05<00:29,  4.49it/s]
 16%|█▌        | 24/154 [00:05<00:29,  4.46it/s]
 16%|█▌        | 25/154 [00:05<00:29,  4.43it/s]
 17%|█▋        | 26/154 [00:06<00:29,  4.40it/s]
 18%|█▊        | 27/154 [00:06<00:28,  4.47it/s]
 18%|█▊        | 28/154 [00:06<00:28,  4.38it/s]
 19%|█▉        | 29/154 [00:06<00:28,  4.45it/s]
 19%|█▉        | 30/154 [00:06<00:27,  4.50it/s]
 20%|██        | 31/154 [00:07<00:27,  4.44it/s]
 21%|██        | 32/154 [00:07<00:27,  4.48it/s]
 21%|██▏       | 33/154 [00:07<00:27,  4.44it/s]
 22%|██▏       | 34/154 [00:07<00:27,  4.34it/s]
 23%|██▎       | 35/154 [00:08<00:27,  4.40it/s]
 23%|██▎       | 36/154 [00:08<00:26,  4.38it/s]
 24%|██▍       | 37/154 [00:08<00:26,  4.34it/s]
 25%|██▍       | 38/154 [00:08<00:26,  4.40it/s]
 25%|██▌       | 39/154 [00:09<00:25,  4.46it/s]
 26%|██▌       | 40/154 [00:09<00:25,  4.43it/s]
 27%|██▋       | 41/154 [00:09<00:26,  4.26it/s]
 27%|██▋       | 42/154 [00:09<00:26,  4.22it/s]
 28%|██▊       | 43/154 [00:09<00:26,  4.20it/s]
 29%|██▊       | 44/154 [00:10<00:25,  4.39it/s]
 29%|██▉       | 45/154 [00:10<00:25,  4.30it/s]
 30%|██▉       | 46/154 [00:10<00:24,  4.39it/s]
 31%|███       | 47/154 [00:10<00:24,  4.39it/s]
 31%|███       | 48/154 [00:11<00:23,  4.43it/s]
 32%|███▏      | 49/154 [00:11<00:23,  4.40it/s]
 32%|███▏      | 50/154 [00:11<00:24,  4.33it/s]
 33%|███▎      | 51/154 [00:11<00:23,  4.40it/s]
 34%|███▍      | 52/154 [00:12<00:23,  4.29it/s]
 34%|███▍      | 53/154 [00:12<00:23,  4.27it/s]
 35%|███▌      | 54/154 [00:12<00:22,  4.36it/s]
 36%|███▌      | 55/154 [00:12<00:23,  4.30it/s]
 36%|███▋      | 56/154 [00:12<00:22,  4.26it/s]
 37%|███▋      | 57/154 [00:13<00:22,  4.37it/s]
 38%|███▊      | 58/154 [00:13<00:22,  4.35it/s]
 38%|███▊      | 59/154 [00:13<00:21,  4.40it/s]
 39%|███▉      | 60/154 [00:13<00:22,  4.26it/s]
 40%|███▉      | 61/154 [00:14<00:21,  4.27it/s]
 40%|████      | 62/154 [00:14<00:21,  4.29it/s]
 41%|████      | 63/154 [00:14<00:21,  4.31it/s]
 42%|████▏     | 64/154 [00:14<00:20,  4.39it/s]
 42%|████▏     | 65/154 [00:15<00:21,  4.20it/s]
 43%|████▎     | 66/154 [00:15<00:21,  4.11it/s]
 44%|████▎     | 67/154 [00:15<00:21,  4.11it/s]
 44%|████▍     | 68/154 [00:15<00:20,  4.24it/s]
 45%|████▍     | 69/154 [00:16<00:19,  4.27it/s]
 45%|████▌     | 70/154 [00:16<00:19,  4.37it/s]
 46%|████▌     | 71/154 [00:16<00:19,  4.35it/s]
 47%|████▋     | 72/154 [00:16<00:19,  4.28it/s]
 47%|████▋     | 73/154 [00:16<00:18,  4.29it/s]
 48%|████▊     | 74/154 [00:17<00:18,  4.30it/s]
 49%|████▊     | 75/154 [00:17<00:18,  4.30it/s]
 49%|████▉     | 76/154 [00:17<00:18,  4.15it/s]
 50%|█████     | 77/154 [00:17<00:18,  4.26it/s]
 51%|█████     | 78/154 [00:18<00:17,  4.22it/s]
 51%|█████▏    | 79/154 [00:18<00:17,  4.29it/s]
 52%|█████▏    | 80/154 [00:18<00:17,  4.14it/s]
 53%|█████▎    | 81/154 [00:18<00:16,  4.32it/s]
 53%|█████▎    | 82/154 [00:19<00:16,  4.40it/s]
 54%|█████▍    | 83/154 [00:19<00:16,  4.24it/s]
 55%|█████▍    | 84/154 [00:19<00:16,  4.29it/s]
 55%|█████▌    | 85/154 [00:19<00:15,  4.45it/s]
 56%|█████▌    | 86/154 [00:19<00:15,  4.36it/s]
 56%|█████▋    | 87/154 [00:20<00:15,  4.35it/s]
 57%|█████▋    | 88/154 [00:20<00:15,  4.22it/s]
 58%|█████▊    | 89/154 [00:20<00:15,  4.23it/s]
 58%|█████▊    | 90/154 [00:20<00:14,  4.33it/s]
 59%|█████▉    | 91/154 [00:21<00:14,  4.33it/s]
 60%|█████▉    | 92/154 [00:21<00:15,  3.95it/s]
 60%|██████    | 93/154 [00:21<00:15,  3.99it/s]
 61%|██████    | 94/154 [00:21<00:15,  3.92it/s]
 62%|██████▏   | 95/154 [00:22<00:15,  3.93it/s]
 62%|██████▏   | 96/154 [00:22<00:14,  3.95it/s]
 63%|██████▎   | 97/154 [00:22<00:14,  4.01it/s]
 64%|██████▎   | 98/154 [00:22<00:13,  4.18it/s]
 64%|██████▍   | 99/154 [00:23<00:13,  4.12it/s]
 65%|██████▍   | 100/154 [00:23<00:13,  4.08it/s]
 66%|██████▌   | 101/154 [00:23<00:12,  4.17it/s]
 66%|██████▌   | 102/154 [00:23<00:12,  4.29it/s]
 67%|██████▋   | 103/154 [00:24<00:11,  4.29it/s]
 68%|██████▊   | 104/154 [00:24<00:11,  4.30it/s]
 68%|██████▊   | 105/154 [00:24<00:11,  4.30it/s]
 69%|██████▉   | 106/154 [00:24<00:10,  4.38it/s]
 69%|██████▉   | 107/154 [00:25<00:10,  4.33it/s]
 70%|███████   | 108/154 [00:25<00:10,  4.19it/s]
 71%|███████   | 109/154 [00:25<00:10,  4.31it/s]
 71%|███████▏  | 110/154 [00:25<00:10,  4.19it/s]
 72%|███████▏  | 111/154 [00:25<00:10,  4.28it/s]
 73%|███████▎  | 112/154 [00:26<00:09,  4.24it/s]
 73%|███████▎  | 113/154 [00:26<00:09,  4.27it/s]
 74%|███████▍  | 114/154 [00:26<00:09,  4.35it/s]
 75%|███████▍  | 115/154 [00:26<00:08,  4.36it/s]
 75%|███████▌  | 116/154 [00:27<00:08,  4.36it/s]
 76%|███████▌  | 117/154 [00:27<00:08,  4.41it/s]
 77%|███████▋  | 118/154 [00:27<00:08,  4.38it/s]
 77%|███████▋  | 119/154 [00:27<00:07,  4.43it/s]
 78%|███████▊  | 120/154 [00:27<00:07,  4.56it/s]
 79%|███████▊  | 121/154 [00:28<00:07,  4.55it/s]
 79%|███████▉  | 122/154 [00:28<00:07,  4.57it/s]
 80%|███████▉  | 123/154 [00:28<00:07,  4.36it/s]
 81%|████████  | 124/154 [00:28<00:06,  4.33it/s]
 81%|████████  | 125/154 [00:29<00:06,  4.40it/s]
 82%|████████▏ | 126/154 [00:29<00:06,  4.26it/s]
 82%|████████▏ | 127/154 [00:29<00:06,  4.28it/s]
 83%|████████▎ | 128/154 [00:29<00:06,  4.05it/s]
 84%|████████▍ | 129/154 [00:30<00:06,  4.14it/s]
 84%|████████▍ | 130/154 [00:30<00:05,  4.18it/s]
 85%|████████▌ | 131/154 [00:30<00:05,  4.22it/s]
 86%|████████▌ | 132/154 [00:30<00:05,  4.33it/s]
 86%|████████▋ | 133/154 [00:31<00:04,  4.27it/s]
 87%|████████▋ | 134/154 [00:31<00:04,  4.10it/s]
 88%|████████▊ | 135/154 [00:31<00:04,  4.17it/s]
 88%|████████▊ | 136/154 [00:31<00:04,  4.33it/s]
 89%|████████▉ | 137/154 [00:31<00:03,  4.38it/s]
 90%|████████▉ | 138/154 [00:32<00:03,  4.51it/s]
 90%|█████████ | 139/154 [00:32<00:03,  4.52it/s]
 91%|█████████ | 140/154 [00:32<00:03,  4.40it/s]
 92%|█████████▏| 141/154 [00:32<00:03,  4.33it/s]
 92%|█████████▏| 142/154 [00:33<00:02,  4.34it/s]
 93%|█████████▎| 143/154 [00:33<00:02,  4.36it/s]
 94%|█████████▎| 144/154 [00:33<00:02,  4.27it/s]
 94%|█████████▍| 145/154 [00:33<00:02,  4.43it/s]
 95%|█████████▍| 146/154 [00:34<00:01,  4.40it/s]
 95%|█████████▌| 147/154 [00:34<00:01,  4.27it/s]
 96%|█████████▌| 148/154 [00:34<00:01,  4.18it/s]
 97%|█████████▋| 149/154 [00:34<00:01,  4.33it/s]
 97%|█████████▋| 150/154 [00:34<00:00,  4.34it/s]
 98%|█████████▊| 151/154 [00:35<00:00,  4.23it/s]
 99%|█████████▊| 152/154 [00:35<00:00,  4.41it/s]
 99%|█████████▉| 153/154 [00:35<00:00,  4.28it/s]
100%|██████████| 154/154 [00:35<00:00,  4.30it/s]
2023-07-10 16:32:34,008 Computing features for evaluation...

  0%|          | 0/155 [00:00<?, ?it/s]/ceph/hpc/home/eujongc/anaconda3/envs/latentops/lib/python3.9/site-packages/torch/utils/data/dataloader.py:554: UserWarning: This DataLoader will create 4 worker processes in total. Our suggested max number of worker in current system is 2, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(_create_warning_msg(

  1%|          | 1/155 [00:00<00:52,  2.96it/s]
  1%|▏         | 2/155 [00:00<00:41,  3.71it/s]
  2%|▏         | 3/155 [00:00<00:37,  4.01it/s]
  3%|▎         | 4/155 [00:01<00:40,  3.77it/s]
  3%|▎         | 5/155 [00:01<00:38,  3.85it/s]
  4%|▍         | 6/155 [00:01<00:36,  4.07it/s]
  5%|▍         | 7/155 [00:01<00:36,  4.11it/s]
  5%|▌         | 8/155 [00:02<00:35,  4.19it/s]
  6%|▌         | 9/155 [00:02<00:34,  4.23it/s]
  6%|▋         | 10/155 [00:02<00:33,  4.28it/s]
  7%|▋         | 11/155 [00:02<00:34,  4.16it/s]
  8%|▊         | 12/155 [00:02<00:33,  4.23it/s]
  8%|▊         | 13/155 [00:03<00:33,  4.18it/s]
  9%|▉         | 14/155 [00:03<00:34,  4.11it/s]
 10%|▉         | 15/155 [00:03<00:34,  4.02it/s]
 10%|█         | 16/155 [00:03<00:32,  4.24it/s]
 11%|█         | 17/155 [00:04<00:32,  4.19it/s]
 12%|█▏        | 18/155 [00:04<00:33,  4.11it/s]
 12%|█▏        | 19/155 [00:04<00:32,  4.24it/s]
 13%|█▎        | 20/155 [00:04<00:32,  4.19it/s]
 14%|█▎        | 21/155 [00:05<00:31,  4.31it/s]
 14%|█▍        | 22/155 [00:05<00:29,  4.44it/s]
 15%|█▍        | 23/155 [00:05<00:30,  4.39it/s]
 15%|█▌        | 24/155 [00:05<00:30,  4.31it/s]
 16%|█▌        | 25/155 [00:06<00:29,  4.39it/s]
 17%|█▋        | 26/155 [00:06<00:30,  4.24it/s]
 17%|█▋        | 27/155 [00:06<00:29,  4.27it/s]
 18%|█▊        | 28/155 [00:06<00:29,  4.35it/s]
 19%|█▊        | 29/155 [00:06<00:29,  4.22it/s]
 19%|█▉        | 30/155 [00:07<00:30,  4.13it/s]
 20%|██        | 31/155 [00:07<00:30,  4.09it/s]
 21%|██        | 32/155 [00:07<00:29,  4.23it/s]
 21%|██▏       | 33/155 [00:07<00:28,  4.26it/s]
 22%|██▏       | 34/155 [00:08<00:28,  4.23it/s]
 23%|██▎       | 35/155 [00:08<00:28,  4.19it/s]
 23%|██▎       | 36/155 [00:08<00:28,  4.13it/s]
 24%|██▍       | 37/155 [00:08<00:29,  4.01it/s]
 25%|██▍       | 38/155 [00:09<00:28,  4.09it/s]
 25%|██▌       | 39/155 [00:09<00:27,  4.17it/s]
 26%|██▌       | 40/155 [00:09<00:26,  4.29it/s]
 26%|██▋       | 41/155 [00:09<00:27,  4.17it/s]
 27%|██▋       | 42/155 [00:10<00:26,  4.24it/s]
 28%|██▊       | 43/155 [00:10<00:26,  4.23it/s]
 28%|██▊       | 44/155 [00:10<00:26,  4.21it/s]
 29%|██▉       | 45/155 [00:10<00:25,  4.33it/s]
 30%|██▉       | 46/155 [00:11<00:25,  4.20it/s]
 30%|███       | 47/155 [00:11<00:25,  4.18it/s]
 31%|███       | 48/155 [00:11<00:25,  4.18it/s]
 32%|███▏      | 49/155 [00:11<00:24,  4.29it/s]
 32%|███▏      | 50/155 [00:11<00:24,  4.20it/s]
 33%|███▎      | 51/155 [00:12<00:24,  4.18it/s]
 34%|███▎      | 52/155 [00:12<00:25,  4.04it/s]
 34%|███▍      | 53/155 [00:12<00:24,  4.10it/s]
 35%|███▍      | 54/155 [00:12<00:23,  4.26it/s]
 35%|███▌      | 55/155 [00:13<00:23,  4.29it/s]
 36%|███▌      | 56/155 [00:13<00:23,  4.30it/s]
 37%|███▋      | 57/155 [00:13<00:23,  4.24it/s]
 37%|███▋      | 58/155 [00:13<00:23,  4.22it/s]
 38%|███▊      | 59/155 [00:14<00:22,  4.24it/s]
 39%|███▊      | 60/155 [00:14<00:21,  4.36it/s]
 39%|███▉      | 61/155 [00:14<00:22,  4.09it/s]
 40%|████      | 62/155 [00:14<00:22,  4.18it/s]
 41%|████      | 63/155 [00:15<00:21,  4.24it/s]
 41%|████▏     | 64/155 [00:15<00:21,  4.25it/s]
 42%|████▏     | 65/155 [00:15<00:20,  4.40it/s]
 43%|████▎     | 66/155 [00:15<00:20,  4.29it/s]
 43%|████▎     | 67/155 [00:15<00:20,  4.37it/s]
 44%|████▍     | 68/155 [00:16<00:19,  4.45it/s]
 45%|████▍     | 69/155 [00:16<00:19,  4.37it/s]
 45%|████▌     | 70/155 [00:16<00:19,  4.31it/s]
 46%|████▌     | 71/155 [00:16<00:19,  4.32it/s]
 46%|████▋     | 72/155 [00:17<00:20,  4.01it/s]
 47%|████▋     | 73/155 [00:17<00:21,  3.81it/s]
 48%|████▊     | 74/155 [00:17<00:20,  3.90it/s]
 48%|████▊     | 75/155 [00:17<00:19,  4.04it/s]
 49%|████▉     | 76/155 [00:18<00:19,  4.12it/s]
 50%|████▉     | 77/155 [00:18<00:18,  4.11it/s]
 50%|█████     | 78/155 [00:18<00:18,  4.13it/s]
 51%|█████     | 79/155 [00:18<00:17,  4.32it/s]
 52%|█████▏    | 80/155 [00:19<00:16,  4.47it/s]
 52%|█████▏    | 81/155 [00:19<00:17,  4.29it/s]
 53%|█████▎    | 82/155 [00:19<00:16,  4.30it/s]
 54%|█████▎    | 83/155 [00:19<00:17,  4.13it/s]
 54%|█████▍    | 84/155 [00:20<00:16,  4.25it/s]
 55%|█████▍    | 85/155 [00:20<00:16,  4.27it/s]
 55%|█████▌    | 86/155 [00:20<00:16,  4.30it/s]
 56%|█████▌    | 87/155 [00:20<00:15,  4.37it/s]
 57%|█████▋    | 88/155 [00:20<00:15,  4.44it/s]
 57%|█████▋    | 89/155 [00:21<00:14,  4.55it/s]
 58%|█████▊    | 90/155 [00:21<00:14,  4.50it/s]
 59%|█████▊    | 91/155 [00:21<00:14,  4.45it/s]
 59%|█████▉    | 92/155 [00:21<00:14,  4.49it/s]
 60%|██████    | 93/155 [00:22<00:13,  4.56it/s]
 61%|██████    | 94/155 [00:22<00:13,  4.54it/s]
 61%|██████▏   | 95/155 [00:22<00:13,  4.47it/s]
 62%|██████▏   | 96/155 [00:22<00:13,  4.37it/s]
 63%|██████▎   | 97/155 [00:22<00:13,  4.43it/s]
 63%|██████▎   | 98/155 [00:23<00:13,  4.36it/s]
 64%|██████▍   | 99/155 [00:23<00:12,  4.42it/s]
 65%|██████▍   | 100/155 [00:23<00:12,  4.32it/s]
 65%|██████▌   | 101/155 [00:23<00:12,  4.33it/s]
 66%|██████▌   | 102/155 [00:24<00:12,  4.33it/s]
 66%|██████▋   | 103/155 [00:24<00:12,  4.20it/s]
 67%|██████▋   | 104/155 [00:24<00:12,  4.24it/s]
 68%|██████▊   | 105/155 [00:24<00:11,  4.25it/s]
 68%|██████▊   | 106/155 [00:25<00:11,  4.23it/s]
 69%|██████▉   | 107/155 [00:25<00:11,  4.28it/s]
 70%|██████▉   | 108/155 [00:25<00:11,  4.24it/s]
 70%|███████   | 109/155 [00:25<00:10,  4.28it/s]
 71%|███████   | 110/155 [00:25<00:10,  4.30it/s]
 72%|███████▏  | 111/155 [00:26<00:09,  4.45it/s]
 72%|███████▏  | 112/155 [00:26<00:09,  4.37it/s]
 73%|███████▎  | 113/155 [00:26<00:09,  4.34it/s]
 74%|███████▎  | 114/155 [00:26<00:09,  4.16it/s]
 74%|███████▍  | 115/155 [00:27<00:09,  4.09it/s]
 75%|███████▍  | 116/155 [00:27<00:09,  4.23it/s]
 75%|███████▌  | 117/155 [00:27<00:09,  4.20it/s]
 76%|███████▌  | 118/155 [00:27<00:08,  4.38it/s]
 77%|███████▋  | 119/155 [00:28<00:08,  4.05it/s]
 77%|███████▋  | 120/155 [00:28<00:08,  4.14it/s]
 78%|███████▊  | 121/155 [00:28<00:08,  4.02it/s]
 79%|███████▊  | 122/155 [00:28<00:08,  4.12it/s]
 79%|███████▉  | 123/155 [00:29<00:07,  4.19it/s]
 80%|████████  | 124/155 [00:29<00:07,  4.10it/s]
 81%|████████  | 125/155 [00:29<00:07,  4.26it/s]
 81%|████████▏ | 126/155 [00:29<00:06,  4.26it/s]
 82%|████████▏ | 127/155 [00:30<00:06,  4.38it/s]
 83%|████████▎ | 128/155 [00:30<00:06,  4.24it/s]
 83%|████████▎ | 129/155 [00:30<00:06,  4.14it/s]
 84%|████████▍ | 130/155 [00:30<00:06,  4.08it/s]
 85%|████████▍ | 131/155 [00:31<00:06,  3.99it/s]
 85%|████████▌ | 132/155 [00:31<00:05,  4.16it/s]
 86%|████████▌ | 133/155 [00:31<00:05,  4.23it/s]
 86%|████████▋ | 134/155 [00:31<00:05,  4.14it/s]
 87%|████████▋ | 135/155 [00:31<00:04,  4.23it/s]
 88%|████████▊ | 136/155 [00:32<00:04,  4.31it/s]
 88%|████████▊ | 137/155 [00:32<00:04,  4.40it/s]
 89%|████████▉ | 138/155 [00:32<00:03,  4.26it/s]
 90%|████████▉ | 139/155 [00:32<00:03,  4.23it/s]
 90%|█████████ | 140/155 [00:33<00:03,  4.22it/s]
 91%|█████████ | 141/155 [00:33<00:03,  4.19it/s]
 92%|█████████▏| 142/155 [00:33<00:03,  4.31it/s]
 92%|█████████▏| 143/155 [00:33<00:02,  4.42it/s]
 93%|█████████▎| 144/155 [00:34<00:02,  4.20it/s]
 94%|█████████▎| 145/155 [00:34<00:02,  4.22it/s]
 94%|█████████▍| 146/155 [00:34<00:02,  4.33it/s]
 95%|█████████▍| 147/155 [00:34<00:01,  4.33it/s]
 95%|█████████▌| 148/155 [00:34<00:01,  4.42it/s]
 96%|█████████▌| 149/155 [00:35<00:01,  4.35it/s]
 97%|█████████▋| 150/155 [00:35<00:01,  4.40it/s]
 97%|█████████▋| 151/155 [00:35<00:00,  4.45it/s]
 98%|█████████▊| 152/155 [00:35<00:00,  4.53it/s]
 99%|█████████▊| 153/155 [00:36<00:00,  4.51it/s]
 99%|█████████▉| 154/155 [00:36<00:00,  4.19it/s]
100%|██████████| 155/155 [00:36<00:00,  4.24it/s]
+-------+------------------------+--------------------+-------------+-------------+-----------+----------+
| epoch |           lr           |     train_loss     | val_top1acc | val_top3acc | val_ndcg1 | val_mrr3 |
+-------+------------------------+--------------------+-------------+-------------+-----------+----------+
|   0   | 1.0000000000000023e-05 | 2.2853724935689868 |    43.42    |    76.27    |   67.87   |  57.81   |
|   1   |  9.99112027792722e-06  | 1.5891911364018136 |    52.55    |    82.72    |   74.75   |  66.10   |
|   2   | 9.964516155915175e-06  | 1.2577084753190586 |    58.79    |    87.16    |   78.59   |  71.44   |
|   3   | 9.920292628279128e-06  | 1.0084300179148344 |    61.43    |    88.79    |   80.23   |  73.58   |
+-------+------------------------+--------------------+-------------+-------------+-----------+----------+
/ceph/hpc/home/eujongc/anaconda3/envs/latentops/lib/python3.9/site-packages/torch/utils/data/dataloader.py:554: UserWarning: This DataLoader will create 4 worker processes in total. Our suggested max number of worker in current system is 2, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(_create_warning_msg(
Train Epoch: [4]  [  0/229]  eta: 0:04:40  lr: 0.000010  loss: 0.7988  time: 1.2263  data: 0.1338  max mem: 30242
Train Epoch: [4]  [ 50/229]  eta: 0:03:24  lr: 0.000010  loss: 0.9482  time: 1.1356  data: 0.0001  max mem: 30242
Train Epoch: [4]  [100/229]  eta: 0:02:27  lr: 0.000010  loss: 0.9346  time: 1.1365  data: 0.0001  max mem: 30242
Train Epoch: [4]  [150/229]  eta: 0:01:30  lr: 0.000010  loss: 0.8133  time: 1.1785  data: 0.0001  max mem: 30242
Train Epoch: [4]  [200/229]  eta: 0:00:33  lr: 0.000010  loss: 0.7541  time: 1.1228  data: 0.0001  max mem: 30242
Train Epoch: [4]  [228/229]  eta: 0:00:01  lr: 0.000010  loss: 0.7160  time: 1.1613  data: 0.0001  max mem: 30242
2023-07-10 16:37:34,057 Train Epoch: [4] Total time: 0:04:23 (1.1488 s / it)
2023-07-10 16:37:34,061 Computing features for evaluation...

  0%|          | 0/154 [00:00<?, ?it/s]
  1%|          | 1/154 [00:00<00:53,  2.85it/s]
  1%|▏         | 2/154 [00:00<00:41,  3.63it/s]
  2%|▏         | 3/154 [00:00<00:38,  3.93it/s]
  3%|▎         | 4/154 [00:01<00:36,  4.12it/s]
  3%|▎         | 5/154 [00:01<00:36,  4.08it/s]
  4%|▍         | 6/154 [00:01<00:34,  4.24it/s]
  5%|▍         | 7/154 [00:01<00:33,  4.45it/s]
  5%|▌         | 8/154 [00:01<00:33,  4.35it/s]
  6%|▌         | 9/154 [00:02<00:33,  4.28it/s]
  6%|▋         | 10/154 [00:02<00:32,  4.38it/s]
  7%|▋         | 11/154 [00:02<00:33,  4.22it/s]
  8%|▊         | 12/154 [00:02<00:33,  4.20it/s]
  8%|▊         | 13/154 [00:03<00:33,  4.24it/s]
  9%|▉         | 14/154 [00:03<00:33,  4.21it/s]
 10%|▉         | 15/154 [00:03<00:32,  4.23it/s]
 10%|█         | 16/154 [00:03<00:31,  4.35it/s]
 11%|█         | 17/154 [00:04<00:31,  4.34it/s]
 12%|█▏        | 18/154 [00:04<00:31,  4.34it/s]
 12%|█▏        | 19/154 [00:04<00:32,  4.19it/s]
 13%|█▎        | 20/154 [00:04<00:32,  4.17it/s]
 14%|█▎        | 21/154 [00:04<00:30,  4.30it/s]
 14%|█▍        | 22/154 [00:05<00:29,  4.43it/s]
 15%|█▍        | 23/154 [00:05<00:29,  4.48it/s]
 16%|█▌        | 24/154 [00:05<00:29,  4.44it/s]
 16%|█▌        | 25/154 [00:05<00:29,  4.43it/s]
 17%|█▋        | 26/154 [00:06<00:29,  4.40it/s]
 18%|█▊        | 27/154 [00:06<00:28,  4.47it/s]
 18%|█▊        | 28/154 [00:06<00:28,  4.37it/s]
 19%|█▉        | 29/154 [00:06<00:28,  4.44it/s]
 19%|█▉        | 30/154 [00:06<00:27,  4.48it/s]
 20%|██        | 31/154 [00:07<00:27,  4.43it/s]
 21%|██        | 32/154 [00:07<00:27,  4.47it/s]
 21%|██▏       | 33/154 [00:07<00:27,  4.44it/s]
 22%|██▏       | 34/154 [00:07<00:27,  4.34it/s]
 23%|██▎       | 35/154 [00:08<00:27,  4.40it/s]
 23%|██▎       | 36/154 [00:08<00:26,  4.38it/s]
 24%|██▍       | 37/154 [00:08<00:26,  4.34it/s]
 25%|██▍       | 38/154 [00:08<00:26,  4.39it/s]
 25%|██▌       | 39/154 [00:09<00:25,  4.45it/s]
 26%|██▌       | 40/154 [00:09<00:25,  4.43it/s]
 27%|██▋       | 41/154 [00:09<00:26,  4.26it/s]
 27%|██▋       | 42/154 [00:09<00:26,  4.22it/s]
 28%|██▊       | 43/154 [00:10<00:26,  4.20it/s]
 29%|██▊       | 44/154 [00:10<00:25,  4.39it/s]
 29%|██▉       | 45/154 [00:10<00:25,  4.30it/s]
 30%|██▉       | 46/154 [00:10<00:24,  4.39it/s]
 31%|███       | 47/154 [00:10<00:24,  4.38it/s]
 31%|███       | 48/154 [00:11<00:24,  4.42it/s]
 32%|███▏      | 49/154 [00:11<00:23,  4.39it/s]
 32%|███▏      | 50/154 [00:11<00:24,  4.31it/s]
 33%|███▎      | 51/154 [00:11<00:23,  4.39it/s]
 34%|███▍      | 52/154 [00:12<00:23,  4.29it/s]
 34%|███▍      | 53/154 [00:12<00:23,  4.26it/s]
 35%|███▌      | 54/154 [00:12<00:22,  4.36it/s]
 36%|███▌      | 55/154 [00:12<00:23,  4.30it/s]
 36%|███▋      | 56/154 [00:13<00:23,  4.25it/s]
 37%|███▋      | 57/154 [00:13<00:22,  4.36it/s]
 38%|███▊      | 58/154 [00:13<00:22,  4.35it/s]
 38%|███▊      | 59/154 [00:13<00:21,  4.40it/s]
 39%|███▉      | 60/154 [00:13<00:22,  4.26it/s]
 40%|███▉      | 61/154 [00:14<00:21,  4.27it/s]
 40%|████      | 62/154 [00:14<00:21,  4.30it/s]
 41%|████      | 63/154 [00:14<00:21,  4.30it/s]
 42%|████▏     | 64/154 [00:14<00:20,  4.38it/s]
 42%|████▏     | 65/154 [00:15<00:21,  4.19it/s]
 43%|████▎     | 66/154 [00:15<00:21,  4.10it/s]
 44%|████▎     | 67/154 [00:15<00:21,  4.11it/s]
 44%|████▍     | 68/154 [00:15<00:20,  4.23it/s]
 45%|████▍     | 69/154 [00:16<00:19,  4.26it/s]
 45%|████▌     | 70/154 [00:16<00:19,  4.36it/s]
 46%|████▌     | 71/154 [00:16<00:19,  4.35it/s]
 47%|████▋     | 72/154 [00:16<00:19,  4.29it/s]
 47%|████▋     | 73/154 [00:16<00:18,  4.29it/s]
 48%|████▊     | 74/154 [00:17<00:18,  4.29it/s]
 49%|████▊     | 75/154 [00:17<00:18,  4.29it/s]
 49%|████▉     | 76/154 [00:17<00:18,  4.15it/s]
 50%|█████     | 77/154 [00:17<00:18,  4.27it/s]
 51%|█████     | 78/154 [00:18<00:17,  4.23it/s]
 51%|█████▏    | 79/154 [00:18<00:17,  4.30it/s]
 52%|█████▏    | 80/154 [00:18<00:17,  4.13it/s]
 53%|█████▎    | 81/154 [00:18<00:16,  4.32it/s]
 53%|█████▎    | 82/154 [00:19<00:16,  4.40it/s]
 54%|█████▍    | 83/154 [00:19<00:16,  4.24it/s]
 55%|█████▍    | 84/154 [00:19<00:16,  4.28it/s]
 55%|█████▌    | 85/154 [00:19<00:15,  4.43it/s]
 56%|█████▌    | 86/154 [00:19<00:15,  4.34it/s]
 56%|█████▋    | 87/154 [00:20<00:15,  4.34it/s]
 57%|█████▋    | 88/154 [00:20<00:15,  4.22it/s]
 58%|█████▊    | 89/154 [00:20<00:15,  4.23it/s]
 58%|█████▊    | 90/154 [00:20<00:14,  4.32it/s]
 59%|█████▉    | 91/154 [00:21<00:14,  4.33it/s]
 60%|█████▉    | 92/154 [00:21<00:15,  3.95it/s]
 60%|██████    | 93/154 [00:21<00:15,  3.99it/s]
 61%|██████    | 94/154 [00:21<00:15,  3.93it/s]
 62%|██████▏   | 95/154 [00:22<00:14,  3.94it/s]
 62%|██████▏   | 96/154 [00:22<00:14,  3.95it/s]
 63%|██████▎   | 97/154 [00:22<00:14,  4.01it/s]
 64%|██████▎   | 98/154 [00:22<00:13,  4.18it/s]
 64%|██████▍   | 99/154 [00:23<00:13,  4.13it/s]
 65%|██████▍   | 100/154 [00:23<00:13,  4.09it/s]
 66%|██████▌   | 101/154 [00:23<00:12,  4.17it/s]
 66%|██████▌   | 102/154 [00:23<00:12,  4.30it/s]
 67%|██████▋   | 103/154 [00:24<00:11,  4.29it/s]
 68%|██████▊   | 104/154 [00:24<00:11,  4.31it/s]
 68%|██████▊   | 105/154 [00:24<00:11,  4.31it/s]
 69%|██████▉   | 106/154 [00:24<00:10,  4.37it/s]
 69%|██████▉   | 107/154 [00:25<00:10,  4.33it/s]
 70%|███████   | 108/154 [00:25<00:10,  4.19it/s]
 71%|███████   | 109/154 [00:25<00:12,  3.60it/s]
 71%|███████▏  | 110/154 [00:25<00:11,  3.69it/s]
 72%|███████▏  | 111/154 [00:26<00:11,  3.90it/s]
 73%|███████▎  | 112/154 [00:26<00:10,  3.96it/s]
 73%|███████▎  | 113/154 [00:26<00:10,  4.07it/s]
 74%|███████▍  | 114/154 [00:26<00:09,  4.21it/s]
 75%|███████▍  | 115/154 [00:27<00:09,  4.26it/s]
 75%|███████▌  | 116/154 [00:27<00:08,  4.29it/s]
 76%|███████▌  | 117/154 [00:27<00:08,  4.36it/s]
 77%|███████▋  | 118/154 [00:27<00:08,  4.35it/s]
 77%|███████▋  | 119/154 [00:27<00:07,  4.42it/s]
 78%|███████▊  | 120/154 [00:28<00:07,  4.55it/s]
 79%|███████▊  | 121/154 [00:28<00:07,  4.54it/s]
 79%|███████▉  | 122/154 [00:28<00:07,  4.56it/s]
 80%|███████▉  | 123/154 [00:28<00:07,  4.34it/s]
 81%|████████  | 124/154 [00:29<00:06,  4.32it/s]
 81%|████████  | 125/154 [00:29<00:06,  4.40it/s]
 82%|████████▏ | 126/154 [00:29<00:06,  4.26it/s]
 82%|████████▏ | 127/154 [00:29<00:06,  4.28it/s]
 83%|████████▎ | 128/154 [00:30<00:06,  4.04it/s]
 84%|████████▍ | 129/154 [00:30<00:06,  4.14it/s]
 84%|████████▍ | 130/154 [00:30<00:05,  4.19it/s]
 85%|████████▌ | 131/154 [00:30<00:05,  4.22it/s]
 86%|████████▌ | 132/154 [00:30<00:05,  4.33it/s]
 86%|████████▋ | 133/154 [00:31<00:04,  4.26it/s]
 87%|████████▋ | 134/154 [00:31<00:04,  4.09it/s]
 88%|████████▊ | 135/154 [00:31<00:04,  4.17it/s]
 88%|████████▊ | 136/154 [00:31<00:04,  4.33it/s]
 89%|████████▉ | 137/154 [00:32<00:03,  4.38it/s]
 90%|████████▉ | 138/154 [00:32<00:03,  4.51it/s]
 90%|█████████ | 139/154 [00:32<00:03,  4.52it/s]
 91%|█████████ | 140/154 [00:32<00:03,  4.40it/s]
 92%|█████████▏| 141/154 [00:33<00:02,  4.33it/s]
 92%|█████████▏| 142/154 [00:33<00:02,  4.34it/s]
 93%|█████████▎| 143/154 [00:33<00:02,  4.35it/s]
 94%|█████████▎| 144/154 [00:33<00:02,  4.27it/s]
 94%|█████████▍| 145/154 [00:33<00:02,  4.43it/s]
 95%|█████████▍| 146/154 [00:34<00:01,  4.40it/s]
 95%|█████████▌| 147/154 [00:34<00:01,  4.27it/s]
 96%|█████████▌| 148/154 [00:34<00:01,  4.18it/s]
 97%|█████████▋| 149/154 [00:34<00:01,  4.32it/s]
 97%|█████████▋| 150/154 [00:35<00:00,  4.33it/s]
 98%|█████████▊| 151/154 [00:35<00:00,  4.22it/s]
 99%|█████████▊| 152/154 [00:35<00:00,  4.40it/s]
 99%|█████████▉| 153/154 [00:35<00:00,  4.28it/s]
100%|██████████| 154/154 [00:36<00:00,  4.28it/s]
2023-07-10 16:38:11,512 Computing features for evaluation...

  0%|          | 0/155 [00:00<?, ?it/s]/ceph/hpc/home/eujongc/anaconda3/envs/latentops/lib/python3.9/site-packages/torch/utils/data/dataloader.py:554: UserWarning: This DataLoader will create 4 worker processes in total. Our suggested max number of worker in current system is 2, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(_create_warning_msg(

  1%|          | 1/155 [00:00<00:54,  2.82it/s]
  1%|▏         | 2/155 [00:00<00:42,  3.63it/s]
  2%|▏         | 3/155 [00:00<00:38,  3.95it/s]
  3%|▎         | 4/155 [00:01<00:40,  3.74it/s]
  3%|▎         | 5/155 [00:01<00:39,  3.81it/s]
  4%|▍         | 6/155 [00:01<00:36,  4.04it/s]
  5%|▍         | 7/155 [00:01<00:36,  4.09it/s]
  5%|▌         | 8/155 [00:02<00:35,  4.18it/s]
  6%|▌         | 9/155 [00:02<00:34,  4.21it/s]
  6%|▋         | 10/155 [00:02<00:34,  4.26it/s]
  7%|▋         | 11/155 [00:02<00:34,  4.14it/s]
  8%|▊         | 12/155 [00:02<00:33,  4.22it/s]
  8%|▊         | 13/155 [00:03<00:34,  4.17it/s]
  9%|▉         | 14/155 [00:03<00:34,  4.10it/s]
 10%|▉         | 15/155 [00:03<00:34,  4.01it/s]
 10%|█         | 16/155 [00:03<00:32,  4.22it/s]
 11%|█         | 17/155 [00:04<00:33,  4.18it/s]
 12%|█▏        | 18/155 [00:04<00:33,  4.10it/s]
 12%|█▏        | 19/155 [00:04<00:32,  4.24it/s]
 13%|█▎        | 20/155 [00:04<00:32,  4.19it/s]
 14%|█▎        | 21/155 [00:05<00:31,  4.30it/s]
 14%|█▍        | 22/155 [00:05<00:29,  4.44it/s]
 15%|█▍        | 23/155 [00:05<00:30,  4.39it/s]
 15%|█▌        | 24/155 [00:05<00:30,  4.32it/s]
 16%|█▌        | 25/155 [00:06<00:29,  4.40it/s]
 17%|█▋        | 26/155 [00:06<00:30,  4.24it/s]
 17%|█▋        | 27/155 [00:06<00:29,  4.27it/s]
 18%|█▊        | 28/155 [00:06<00:29,  4.35it/s]
 19%|█▊        | 29/155 [00:06<00:29,  4.22it/s]
 19%|█▉        | 30/155 [00:07<00:30,  4.13it/s]
 20%|██        | 31/155 [00:07<00:30,  4.08it/s]
 21%|██        | 32/155 [00:07<00:29,  4.21it/s]
 21%|██▏       | 33/155 [00:07<00:28,  4.25it/s]
 22%|██▏       | 34/155 [00:08<00:28,  4.22it/s]
 23%|██▎       | 35/155 [00:08<00:28,  4.19it/s]
 23%|██▎       | 36/155 [00:08<00:28,  4.13it/s]
 24%|██▍       | 37/155 [00:08<00:29,  4.01it/s]
 25%|██▍       | 38/155 [00:09<00:28,  4.09it/s]
 25%|██▌       | 39/155 [00:09<00:27,  4.17it/s]
 26%|██▌       | 40/155 [00:09<00:26,  4.30it/s]
 26%|██▋       | 41/155 [00:09<00:27,  4.18it/s]
 27%|██▋       | 42/155 [00:10<00:26,  4.25it/s]
 28%|██▊       | 43/155 [00:10<00:26,  4.22it/s]
 28%|██▊       | 44/155 [00:10<00:26,  4.21it/s]
 29%|██▉       | 45/155 [00:10<00:25,  4.33it/s]
 30%|██▉       | 46/155 [00:11<00:25,  4.20it/s]
 30%|███       | 47/155 [00:11<00:25,  4.18it/s]
 31%|███       | 48/155 [00:11<00:25,  4.17it/s]
 32%|███▏      | 49/155 [00:11<00:24,  4.29it/s]
 32%|███▏      | 50/155 [00:12<00:25,  4.20it/s]
 33%|███▎      | 51/155 [00:12<00:24,  4.18it/s]
 34%|███▎      | 52/155 [00:12<00:25,  4.03it/s]
 34%|███▍      | 53/155 [00:12<00:24,  4.09it/s]
 35%|███▍      | 54/155 [00:12<00:23,  4.24it/s]
 35%|███▌      | 55/155 [00:13<00:23,  4.28it/s]
 36%|███▌      | 56/155 [00:13<00:23,  4.29it/s]
 37%|███▋      | 57/155 [00:13<00:23,  4.24it/s]
 37%|███▋      | 58/155 [00:13<00:23,  4.21it/s]
 38%|███▊      | 59/155 [00:14<00:22,  4.22it/s]
 39%|███▊      | 60/155 [00:14<00:21,  4.34it/s]
 39%|███▉      | 61/155 [00:14<00:23,  4.08it/s]
 40%|████      | 62/155 [00:14<00:22,  4.18it/s]
 41%|████      | 63/155 [00:15<00:21,  4.24it/s]
 41%|████▏     | 64/155 [00:15<00:21,  4.25it/s]
 42%|████▏     | 65/155 [00:15<00:20,  4.40it/s]
 43%|████▎     | 66/155 [00:15<00:20,  4.29it/s]
 43%|████▎     | 67/155 [00:16<00:20,  4.37it/s]
 44%|████▍     | 68/155 [00:16<00:19,  4.45it/s]
 45%|████▍     | 69/155 [00:16<00:19,  4.36it/s]
 45%|████▌     | 70/155 [00:16<00:19,  4.30it/s]
 46%|████▌     | 71/155 [00:16<00:19,  4.31it/s]
 46%|████▋     | 72/155 [00:17<00:20,  4.01it/s]
 47%|████▋     | 73/155 [00:17<00:21,  3.81it/s]
 48%|████▊     | 74/155 [00:17<00:20,  3.90it/s]
 48%|████▊     | 75/155 [00:17<00:19,  4.03it/s]
 49%|████▉     | 76/155 [00:18<00:19,  4.11it/s]
 50%|████▉     | 77/155 [00:18<00:18,  4.11it/s]
 50%|█████     | 78/155 [00:18<00:18,  4.12it/s]
 51%|█████     | 79/155 [00:18<00:17,  4.31it/s]
 52%|█████▏    | 80/155 [00:19<00:16,  4.45it/s]
 52%|█████▏    | 81/155 [00:19<00:17,  4.28it/s]
 53%|█████▎    | 82/155 [00:19<00:16,  4.30it/s]
 54%|█████▎    | 83/155 [00:19<00:17,  4.13it/s]
 54%|█████▍    | 84/155 [00:20<00:16,  4.25it/s]
 55%|█████▍    | 85/155 [00:20<00:16,  4.27it/s]
 55%|█████▌    | 86/155 [00:20<00:16,  4.30it/s]
 56%|█████▌    | 87/155 [00:20<00:15,  4.36it/s]
 57%|█████▋    | 88/155 [00:20<00:15,  4.44it/s]
 57%|█████▋    | 89/155 [00:21<00:14,  4.55it/s]
 58%|█████▊    | 90/155 [00:21<00:14,  4.49it/s]
 59%|█████▊    | 91/155 [00:21<00:14,  4.44it/s]
 59%|█████▉    | 92/155 [00:21<00:14,  4.48it/s]
 60%|██████    | 93/155 [00:22<00:13,  4.56it/s]
 61%|██████    | 94/155 [00:22<00:13,  4.54it/s]
 61%|██████▏   | 95/155 [00:22<00:13,  4.47it/s]
 62%|██████▏   | 96/155 [00:22<00:13,  4.35it/s]
 63%|██████▎   | 97/155 [00:22<00:13,  4.41it/s]
 63%|██████▎   | 98/155 [00:23<00:13,  4.34it/s]
 64%|██████▍   | 99/155 [00:23<00:12,  4.42it/s]
 65%|██████▍   | 100/155 [00:23<00:12,  4.32it/s]
 65%|██████▌   | 101/155 [00:23<00:12,  4.33it/s]
 66%|██████▌   | 102/155 [00:24<00:12,  4.33it/s]
 66%|██████▋   | 103/155 [00:24<00:12,  4.20it/s]
 67%|██████▋   | 104/155 [00:24<00:12,  4.24it/s]
 68%|██████▊   | 105/155 [00:24<00:11,  4.25it/s]
 68%|██████▊   | 106/155 [00:25<00:11,  4.22it/s]
 69%|██████▉   | 107/155 [00:25<00:11,  4.27it/s]
 70%|██████▉   | 108/155 [00:25<00:11,  4.23it/s]
 70%|███████   | 109/155 [00:25<00:10,  4.28it/s]
 71%|███████   | 110/155 [00:26<00:10,  4.30it/s]
 72%|███████▏  | 111/155 [00:26<00:09,  4.45it/s]
 72%|███████▏  | 112/155 [00:26<00:09,  4.36it/s]
 73%|███████▎  | 113/155 [00:26<00:09,  4.33it/s]
 74%|███████▎  | 114/155 [00:26<00:09,  4.15it/s]
 74%|███████▍  | 115/155 [00:27<00:09,  4.08it/s]
 75%|███████▍  | 116/155 [00:27<00:09,  4.22it/s]
 75%|███████▌  | 117/155 [00:27<00:09,  4.20it/s]
 76%|███████▌  | 118/155 [00:27<00:08,  4.37it/s]
 77%|███████▋  | 119/155 [00:28<00:08,  4.04it/s]
 77%|███████▋  | 120/155 [00:28<00:08,  4.13it/s]
 78%|███████▊  | 121/155 [00:28<00:08,  4.02it/s]
 79%|███████▊  | 122/155 [00:28<00:08,  4.12it/s]
 79%|███████▉  | 123/155 [00:29<00:07,  4.18it/s]
 80%|████████  | 124/155 [00:29<00:07,  4.09it/s]
 81%|████████  | 125/155 [00:29<00:07,  4.25it/s]
 81%|████████▏ | 126/155 [00:29<00:06,  4.26it/s]
 82%|████████▏ | 127/155 [00:30<00:06,  4.37it/s]
 83%|████████▎ | 128/155 [00:30<00:06,  4.23it/s]
 83%|████████▎ | 129/155 [00:30<00:06,  4.13it/s]
 84%|████████▍ | 130/155 [00:30<00:06,  4.07it/s]
 85%|████████▍ | 131/155 [00:31<00:06,  3.99it/s]
 85%|████████▌ | 132/155 [00:31<00:05,  4.16it/s]
 86%|████████▌ | 133/155 [00:31<00:05,  4.22it/s]
 86%|████████▋ | 134/155 [00:31<00:05,  4.13it/s]
 87%|████████▋ | 135/155 [00:32<00:04,  4.22it/s]
 88%|████████▊ | 136/155 [00:32<00:04,  4.31it/s]
 88%|████████▊ | 137/155 [00:32<00:04,  4.39it/s]
 89%|████████▉ | 138/155 [00:32<00:03,  4.26it/s]
 90%|████████▉ | 139/155 [00:32<00:03,  4.22it/s]
 90%|█████████ | 140/155 [00:33<00:03,  4.21it/s]
 91%|█████████ | 141/155 [00:33<00:03,  4.18it/s]
 92%|█████████▏| 142/155 [00:33<00:03,  4.30it/s]
 92%|█████████▏| 143/155 [00:33<00:02,  4.41it/s]
 93%|█████████▎| 144/155 [00:34<00:02,  4.18it/s]
 94%|█████████▎| 145/155 [00:34<00:02,  4.21it/s]
 94%|█████████▍| 146/155 [00:34<00:02,  4.31it/s]
 95%|█████████▍| 147/155 [00:34<00:01,  4.32it/s]
 95%|█████████▌| 148/155 [00:35<00:01,  4.42it/s]
 96%|█████████▌| 149/155 [00:35<00:01,  4.35it/s]
 97%|█████████▋| 150/155 [00:35<00:01,  4.40it/s]
 97%|█████████▋| 151/155 [00:35<00:00,  4.45it/s]
 98%|█████████▊| 152/155 [00:35<00:00,  4.52it/s]
 99%|█████████▊| 153/155 [00:36<00:00,  4.51it/s]
 99%|█████████▉| 154/155 [00:36<00:00,  4.19it/s]
100%|██████████| 155/155 [00:36<00:00,  4.23it/s]
+-------+------------------------+--------------------+-------------+-------------+-----------+----------+
| epoch |           lr           |     train_loss     | val_top1acc | val_top3acc | val_ndcg1 | val_mrr3 |
+-------+------------------------+--------------------+-------------+-------------+-----------+----------+
|   0   | 1.0000000000000023e-05 | 2.2853724935689868 |    43.42    |    76.27    |   67.87   |  57.81   |
|   1   |  9.99112027792722e-06  | 1.5891911364018136 |    52.55    |    82.72    |   74.75   |  66.10   |
|   2   | 9.964516155915175e-06  | 1.2577084753190586 |    58.79    |    87.16    |   78.59   |  71.44   |
|   3   | 9.920292628279128e-06  | 1.0084300179148344 |    61.43    |    88.79    |   80.23   |  73.58   |
|   4   | 9.858624225078883e-06  | 0.793933470176297  |    63.23    |    88.79    |   81.15   |  74.64   |
+-------+------------------------+--------------------+-------------+-------------+-----------+----------+
/ceph/hpc/home/eujongc/anaconda3/envs/latentops/lib/python3.9/site-packages/torch/utils/data/dataloader.py:554: UserWarning: This DataLoader will create 4 worker processes in total. Our suggested max number of worker in current system is 2, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(_create_warning_msg(
Train Epoch: [5]  [  0/229]  eta: 0:04:18  lr: 0.000010  loss: 0.8110  time: 1.1309  data: 0.1282  max mem: 30242
Train Epoch: [5]  [ 50/229]  eta: 0:03:26  lr: 0.000010  loss: 0.5197  time: 1.1675  data: 0.0001  max mem: 30242
Train Epoch: [5]  [100/229]  eta: 0:02:28  lr: 0.000010  loss: 0.6228  time: 1.1493  data: 0.0001  max mem: 30242
Train Epoch: [5]  [150/229]  eta: 0:01:30  lr: 0.000010  loss: 0.5253  time: 1.1659  data: 0.0001  max mem: 30242
Train Epoch: [5]  [200/229]  eta: 0:00:33  lr: 0.000010  loss: 0.7501  time: 1.1491  data: 0.0001  max mem: 30242
Train Epoch: [5]  [228/229]  eta: 0:00:01  lr: 0.000010  loss: 0.4923  time: 1.1460  data: 0.0001  max mem: 30242
2023-07-10 16:43:11,636 Train Epoch: [5] Total time: 0:04:23 (1.1488 s / it)
2023-07-10 16:43:11,639 Computing features for evaluation...

  0%|          | 0/154 [00:00<?, ?it/s]
  1%|          | 1/154 [00:00<00:52,  2.90it/s]
  1%|▏         | 2/154 [00:00<00:41,  3.67it/s]
  2%|▏         | 3/154 [00:00<00:38,  3.96it/s]
  3%|▎         | 4/154 [00:01<00:36,  4.14it/s]
  3%|▎         | 5/154 [00:01<00:36,  4.09it/s]
  4%|▍         | 6/154 [00:01<00:34,  4.25it/s]
  5%|▍         | 7/154 [00:01<00:32,  4.46it/s]
  5%|▌         | 8/154 [00:01<00:33,  4.36it/s]
  6%|▌         | 9/154 [00:02<00:33,  4.29it/s]
  6%|▋         | 10/154 [00:02<00:32,  4.39it/s]
  7%|▋         | 11/154 [00:02<00:33,  4.23it/s]
  8%|▊         | 12/154 [00:02<00:33,  4.21it/s]
  8%|▊         | 13/154 [00:03<00:33,  4.25it/s]
  9%|▉         | 14/154 [00:03<00:33,  4.21it/s]
 10%|▉         | 15/154 [00:03<00:32,  4.24it/s]
 10%|█         | 16/154 [00:03<00:31,  4.36it/s]
 11%|█         | 17/154 [00:04<00:31,  4.34it/s]
 12%|█▏        | 18/154 [00:04<00:31,  4.34it/s]
 12%|█▏        | 19/154 [00:04<00:32,  4.19it/s]
 13%|█▎        | 20/154 [00:04<00:32,  4.17it/s]
 14%|█▎        | 21/154 [00:04<00:30,  4.31it/s]
 14%|█▍        | 22/154 [00:05<00:29,  4.43it/s]
 15%|█▍        | 23/154 [00:05<00:29,  4.49it/s]
 16%|█▌        | 24/154 [00:05<00:29,  4.45it/s]
 16%|█▌        | 25/154 [00:05<00:29,  4.43it/s]
 17%|█▋        | 26/154 [00:06<00:29,  4.40it/s]
 18%|█▊        | 27/154 [00:06<00:28,  4.48it/s]
 18%|█▊        | 28/154 [00:06<00:28,  4.38it/s]
 19%|█▉        | 29/154 [00:06<00:28,  4.44it/s]
 19%|█▉        | 30/154 [00:06<00:27,  4.49it/s]
 20%|██        | 31/154 [00:07<00:27,  4.44it/s]
 21%|██        | 32/154 [00:07<00:27,  4.48it/s]
 21%|██▏       | 33/154 [00:07<00:27,  4.45it/s]
 22%|██▏       | 34/154 [00:07<00:27,  4.34it/s]
 23%|██▎       | 35/154 [00:08<00:27,  4.40it/s]
 23%|██▎       | 36/154 [00:08<00:26,  4.38it/s]
 24%|██▍       | 37/154 [00:08<00:26,  4.35it/s]
 25%|██▍       | 38/154 [00:08<00:26,  4.40it/s]
 25%|██▌       | 39/154 [00:09<00:25,  4.46it/s]
 26%|██▌       | 40/154 [00:09<00:25,  4.44it/s]
 27%|██▋       | 41/154 [00:09<00:26,  4.27it/s]
 27%|██▋       | 42/154 [00:09<00:26,  4.22it/s]
 28%|██▊       | 43/154 [00:09<00:26,  4.20it/s]
 29%|██▊       | 44/154 [00:10<00:25,  4.40it/s]
 29%|██▉       | 45/154 [00:10<00:25,  4.30it/s]
 30%|██▉       | 46/154 [00:10<00:24,  4.39it/s]
 31%|███       | 47/154 [00:10<00:24,  4.38it/s]
 31%|███       | 48/154 [00:11<00:23,  4.42it/s]
 32%|███▏      | 49/154 [00:11<00:23,  4.39it/s]
 32%|███▏      | 50/154 [00:11<00:24,  4.32it/s]
 33%|███▎      | 51/154 [00:11<00:23,  4.39it/s]
 34%|███▍      | 52/154 [00:12<00:23,  4.29it/s]
 34%|███▍      | 53/154 [00:12<00:23,  4.27it/s]
 35%|███▌      | 54/154 [00:12<00:22,  4.36it/s]
 36%|███▌      | 55/154 [00:12<00:23,  4.30it/s]
 36%|███▋      | 56/154 [00:12<00:23,  4.26it/s]
 37%|███▋      | 57/154 [00:13<00:22,  4.37it/s]
 38%|███▊      | 58/154 [00:13<00:22,  4.35it/s]
 38%|███▊      | 59/154 [00:13<00:21,  4.40it/s]
 39%|███▉      | 60/154 [00:13<00:22,  4.26it/s]
 40%|███▉      | 61/154 [00:14<00:21,  4.27it/s]
 40%|████      | 62/154 [00:14<00:21,  4.31it/s]
 41%|████      | 63/154 [00:14<00:21,  4.31it/s]
 42%|████▏     | 64/154 [00:14<00:20,  4.39it/s]
 42%|████▏     | 65/154 [00:15<00:21,  4.20it/s]
 43%|████▎     | 66/154 [00:15<00:21,  4.11it/s]
 44%|████▎     | 67/154 [00:15<00:21,  4.12it/s]
 44%|████▍     | 68/154 [00:15<00:20,  4.25it/s]
 45%|████▍     | 69/154 [00:16<00:19,  4.27it/s]
 45%|████▌     | 70/154 [00:16<00:19,  4.37it/s]
 46%|████▌     | 71/154 [00:16<00:19,  4.35it/s]
 47%|████▋     | 72/154 [00:16<00:19,  4.29it/s]
 47%|████▋     | 73/154 [00:16<00:18,  4.29it/s]
 48%|████▊     | 74/154 [00:17<00:18,  4.30it/s]
 49%|████▊     | 75/154 [00:17<00:18,  4.29it/s]
 49%|████▉     | 76/154 [00:17<00:18,  4.15it/s]
 50%|█████     | 77/154 [00:17<00:18,  4.27it/s]
 51%|█████     | 78/154 [00:18<00:17,  4.23it/s]
 51%|█████▏    | 79/154 [00:18<00:17,  4.29it/s]
 52%|█████▏    | 80/154 [00:18<00:17,  4.13it/s]
 53%|█████▎    | 81/154 [00:18<00:16,  4.32it/s]
 53%|█████▎    | 82/154 [00:19<00:16,  4.40it/s]
 54%|█████▍    | 83/154 [00:19<00:16,  4.24it/s]
 55%|█████▍    | 84/154 [00:19<00:16,  4.29it/s]
 55%|█████▌    | 85/154 [00:19<00:15,  4.44it/s]
 56%|█████▌    | 86/154 [00:19<00:15,  4.35it/s]
 56%|█████▋    | 87/154 [00:20<00:15,  4.34it/s]
 57%|█████▋    | 88/154 [00:20<00:15,  4.22it/s]
 58%|█████▊    | 89/154 [00:20<00:15,  4.23it/s]
 58%|█████▊    | 90/154 [00:20<00:14,  4.32it/s]
 59%|█████▉    | 91/154 [00:21<00:14,  4.33it/s]
 60%|█████▉    | 92/154 [00:21<00:15,  3.95it/s]
 60%|██████    | 93/154 [00:21<00:15,  4.00it/s]
 61%|██████    | 94/154 [00:21<00:15,  3.93it/s]
 62%|██████▏   | 95/154 [00:22<00:15,  3.93it/s]
 62%|██████▏   | 96/154 [00:22<00:14,  3.94it/s]
 63%|██████▎   | 97/154 [00:22<00:14,  4.01it/s]
 64%|██████▎   | 98/154 [00:22<00:13,  4.18it/s]
 64%|██████▍   | 99/154 [00:23<00:13,  4.13it/s]
 65%|██████▍   | 100/154 [00:23<00:13,  4.07it/s]
 66%|██████▌   | 101/154 [00:23<00:12,  4.16it/s]
 66%|██████▌   | 102/154 [00:23<00:12,  4.29it/s]
 67%|██████▋   | 103/154 [00:24<00:11,  4.29it/s]
 68%|██████▊   | 104/154 [00:24<00:11,  4.30it/s]
 68%|██████▊   | 105/154 [00:24<00:11,  4.31it/s]
 69%|██████▉   | 106/154 [00:24<00:10,  4.37it/s]
 69%|██████▉   | 107/154 [00:25<00:10,  4.33it/s]
 70%|███████   | 108/154 [00:25<00:10,  4.19it/s]
 71%|███████   | 109/154 [00:25<00:10,  4.32it/s]
 71%|███████▏  | 110/154 [00:25<00:10,  4.19it/s]
 72%|███████▏  | 111/154 [00:25<00:10,  4.28it/s]
 73%|███████▎  | 112/154 [00:26<00:09,  4.23it/s]
 73%|███████▎  | 113/154 [00:26<00:09,  4.27it/s]
 74%|███████▍  | 114/154 [00:26<00:09,  4.35it/s]
 75%|███████▍  | 115/154 [00:26<00:08,  4.36it/s]
 75%|███████▌  | 116/154 [00:27<00:08,  4.37it/s]
 76%|███████▌  | 117/154 [00:27<00:08,  4.42it/s]
 77%|███████▋  | 118/154 [00:27<00:08,  4.38it/s]
 77%|███████▋  | 119/154 [00:27<00:07,  4.44it/s]
 78%|███████▊  | 120/154 [00:27<00:07,  4.57it/s]
 79%|███████▊  | 121/154 [00:28<00:07,  4.55it/s]
 79%|███████▉  | 122/154 [00:28<00:07,  4.57it/s]
 80%|███████▉  | 123/154 [00:28<00:07,  4.35it/s]
 81%|████████  | 124/154 [00:28<00:06,  4.32it/s]
 81%|████████  | 125/154 [00:29<00:06,  4.41it/s]
 82%|████████▏ | 126/154 [00:29<00:06,  4.26it/s]
 82%|████████▏ | 127/154 [00:29<00:06,  4.29it/s]
 83%|████████▎ | 128/154 [00:29<00:06,  4.05it/s]
 84%|████████▍ | 129/154 [00:30<00:06,  4.14it/s]
 84%|████████▍ | 130/154 [00:30<00:05,  4.18it/s]
 85%|████████▌ | 131/154 [00:30<00:05,  4.22it/s]
 86%|████████▌ | 132/154 [00:30<00:05,  4.33it/s]
 86%|████████▋ | 133/154 [00:31<00:04,  4.27it/s]
 87%|████████▋ | 134/154 [00:31<00:04,  4.09it/s]
 88%|████████▊ | 135/154 [00:31<00:04,  4.18it/s]
 88%|████████▊ | 136/154 [00:31<00:04,  4.34it/s]
 89%|████████▉ | 137/154 [00:31<00:03,  4.38it/s]
 90%|████████▉ | 138/154 [00:32<00:03,  4.52it/s]
 90%|█████████ | 139/154 [00:32<00:03,  4.53it/s]
 91%|█████████ | 140/154 [00:32<00:03,  4.40it/s]
 92%|█████████▏| 141/154 [00:32<00:02,  4.34it/s]
 92%|█████████▏| 142/154 [00:33<00:02,  4.35it/s]
 93%|█████████▎| 143/154 [00:33<00:02,  4.36it/s]
 94%|█████████▎| 144/154 [00:33<00:02,  4.27it/s]
 94%|█████████▍| 145/154 [00:33<00:02,  4.43it/s]
 95%|█████████▍| 146/154 [00:34<00:01,  4.40it/s]
 95%|█████████▌| 147/154 [00:34<00:01,  4.27it/s]
 96%|█████████▌| 148/154 [00:34<00:01,  4.18it/s]
 97%|█████████▋| 149/154 [00:34<00:01,  4.33it/s]
 97%|█████████▋| 150/154 [00:34<00:00,  4.34it/s]
 98%|█████████▊| 151/154 [00:35<00:00,  4.22it/s]
 99%|█████████▊| 152/154 [00:35<00:00,  4.40it/s]
 99%|█████████▉| 153/154 [00:35<00:00,  4.28it/s]
100%|██████████| 154/154 [00:35<00:00,  4.30it/s]
2023-07-10 16:43:48,993 Computing features for evaluation...

  0%|          | 0/155 [00:00<?, ?it/s]/ceph/hpc/home/eujongc/anaconda3/envs/latentops/lib/python3.9/site-packages/torch/utils/data/dataloader.py:554: UserWarning: This DataLoader will create 4 worker processes in total. Our suggested max number of worker in current system is 2, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(_create_warning_msg(

  1%|          | 1/155 [00:00<01:03,  2.43it/s]
  1%|▏         | 2/155 [00:00<00:45,  3.35it/s]
  2%|▏         | 3/155 [00:00<00:40,  3.76it/s]
  3%|▎         | 4/155 [00:01<00:41,  3.64it/s]
  3%|▎         | 5/155 [00:01<00:39,  3.75it/s]
  4%|▍         | 6/155 [00:01<00:37,  4.00it/s]
  5%|▍         | 7/155 [00:01<00:36,  4.06it/s]
  5%|▌         | 8/155 [00:02<00:35,  4.16it/s]
  6%|▌         | 9/155 [00:02<00:34,  4.21it/s]
  6%|▋         | 10/155 [00:02<00:34,  4.26it/s]
  7%|▋         | 11/155 [00:02<00:34,  4.15it/s]
  8%|▊         | 12/155 [00:03<00:33,  4.23it/s]
  8%|▊         | 13/155 [00:03<00:33,  4.18it/s]
  9%|▉         | 14/155 [00:03<00:34,  4.11it/s]
 10%|▉         | 15/155 [00:03<00:34,  4.01it/s]
 10%|█         | 16/155 [00:03<00:32,  4.23it/s]
 11%|█         | 17/155 [00:04<00:32,  4.19it/s]
 12%|█▏        | 18/155 [00:04<00:33,  4.11it/s]
 12%|█▏        | 19/155 [00:04<00:32,  4.24it/s]
 13%|█▎        | 20/155 [00:04<00:32,  4.19it/s]
 14%|█▎        | 21/155 [00:05<00:31,  4.30it/s]
 14%|█▍        | 22/155 [00:05<00:29,  4.44it/s]
 15%|█▍        | 23/155 [00:05<00:30,  4.39it/s]
 15%|█▌        | 24/155 [00:05<00:30,  4.32it/s]
 16%|█▌        | 25/155 [00:06<00:29,  4.40it/s]
 17%|█▋        | 26/155 [00:06<00:30,  4.24it/s]
 17%|█▋        | 27/155 [00:06<00:29,  4.27it/s]
 18%|█▊        | 28/155 [00:06<00:29,  4.35it/s]
 19%|█▊        | 29/155 [00:07<00:29,  4.23it/s]
 19%|█▉        | 30/155 [00:07<00:30,  4.14it/s]
 20%|██        | 31/155 [00:07<00:30,  4.09it/s]
 21%|██        | 32/155 [00:07<00:29,  4.22it/s]
 21%|██▏       | 33/155 [00:07<00:28,  4.26it/s]
 22%|██▏       | 34/155 [00:08<00:28,  4.24it/s]
 23%|██▎       | 35/155 [00:08<00:28,  4.20it/s]
 23%|██▎       | 36/155 [00:08<00:28,  4.14it/s]
 24%|██▍       | 37/155 [00:08<00:29,  4.02it/s]
 25%|██▍       | 38/155 [00:09<00:28,  4.09it/s]
 25%|██▌       | 39/155 [00:09<00:27,  4.17it/s]
 26%|██▌       | 40/155 [00:09<00:26,  4.29it/s]
 26%|██▋       | 41/155 [00:09<00:27,  4.17it/s]
 27%|██▋       | 42/155 [00:10<00:26,  4.25it/s]
 28%|██▊       | 43/155 [00:10<00:26,  4.23it/s]
 28%|██▊       | 44/155 [00:10<00:26,  4.21it/s]
 29%|██▉       | 45/155 [00:10<00:25,  4.33it/s]
 30%|██▉       | 46/155 [00:11<00:25,  4.20it/s]
 30%|███       | 47/155 [00:11<00:25,  4.19it/s]
 31%|███       | 48/155 [00:11<00:25,  4.18it/s]
 32%|███▏      | 49/155 [00:11<00:24,  4.29it/s]
 32%|███▏      | 50/155 [00:12<00:25,  4.20it/s]
 33%|███▎      | 51/155 [00:12<00:24,  4.18it/s]
 34%|███▎      | 52/155 [00:12<00:25,  4.04it/s]
 34%|███▍      | 53/155 [00:12<00:24,  4.10it/s]
 35%|███▍      | 54/155 [00:12<00:23,  4.25it/s]
 35%|███▌      | 55/155 [00:13<00:23,  4.28it/s]
 36%|███▌      | 56/155 [00:13<00:23,  4.29it/s]
 37%|███▋      | 57/155 [00:13<00:23,  4.24it/s]
 37%|███▋      | 58/155 [00:13<00:23,  4.22it/s]
 38%|███▊      | 59/155 [00:14<00:22,  4.24it/s]
 39%|███▊      | 60/155 [00:14<00:21,  4.35it/s]
 39%|███▉      | 61/155 [00:14<00:22,  4.09it/s]
 40%|████      | 62/155 [00:14<00:22,  4.18it/s]
 41%|████      | 63/155 [00:15<00:21,  4.24it/s]
 41%|████▏     | 64/155 [00:15<00:21,  4.25it/s]
 42%|████▏     | 65/155 [00:15<00:20,  4.41it/s]
 43%|████▎     | 66/155 [00:15<00:20,  4.29it/s]
 43%|████▎     | 67/155 [00:16<00:20,  4.37it/s]
 44%|████▍     | 68/155 [00:16<00:19,  4.46it/s]
 45%|████▍     | 69/155 [00:16<00:19,  4.37it/s]
 45%|████▌     | 70/155 [00:16<00:19,  4.31it/s]
 46%|████▌     | 71/155 [00:16<00:19,  4.31it/s]
 46%|████▋     | 72/155 [00:17<00:20,  4.01it/s]
 47%|████▋     | 73/155 [00:17<00:21,  3.82it/s]
 48%|████▊     | 74/155 [00:17<00:20,  3.90it/s]
 48%|████▊     | 75/155 [00:18<00:19,  4.04it/s]
 49%|████▉     | 76/155 [00:18<00:19,  4.12it/s]
 50%|████▉     | 77/155 [00:18<00:18,  4.12it/s]
 50%|█████     | 78/155 [00:18<00:18,  4.13it/s]
 51%|█████     | 79/155 [00:18<00:17,  4.32it/s]
 52%|█████▏    | 80/155 [00:19<00:16,  4.47it/s]
 52%|█████▏    | 81/155 [00:19<00:20,  3.58it/s]
 53%|█████▎    | 82/155 [00:19<00:19,  3.78it/s]
 54%|█████▎    | 83/155 [00:20<00:19,  3.78it/s]
 54%|█████▍    | 84/155 [00:20<00:17,  3.98it/s]
 55%|█████▍    | 85/155 [00:20<00:17,  4.08it/s]
 55%|█████▌    | 86/155 [00:20<00:16,  4.17it/s]
 56%|█████▌    | 87/155 [00:20<00:15,  4.26it/s]
 57%|█████▋    | 88/155 [00:21<00:15,  4.36it/s]
 57%|█████▋    | 89/155 [00:21<00:14,  4.49it/s]
 58%|█████▊    | 90/155 [00:21<00:14,  4.46it/s]
 59%|█████▊    | 91/155 [00:21<00:14,  4.41it/s]
 59%|█████▉    | 92/155 [00:22<00:14,  4.47it/s]
 60%|██████    | 93/155 [00:22<00:13,  4.55it/s]
 61%|██████    | 94/155 [00:22<00:13,  4.53it/s]
 61%|██████▏   | 95/155 [00:22<00:13,  4.47it/s]
 62%|██████▏   | 96/155 [00:22<00:13,  4.38it/s]
 63%|██████▎   | 97/155 [00:23<00:13,  4.44it/s]
 63%|██████▎   | 98/155 [00:23<00:13,  4.36it/s]
 64%|██████▍   | 99/155 [00:23<00:12,  4.42it/s]
 65%|██████▍   | 100/155 [00:23<00:12,  4.32it/s]
 65%|██████▌   | 101/155 [00:24<00:12,  4.33it/s]
 66%|██████▌   | 102/155 [00:24<00:12,  4.34it/s]
 66%|██████▋   | 103/155 [00:24<00:12,  4.20it/s]
 67%|██████▋   | 104/155 [00:24<00:12,  4.24it/s]
 68%|██████▊   | 105/155 [00:25<00:11,  4.25it/s]
 68%|██████▊   | 106/155 [00:25<00:11,  4.23it/s]
 69%|██████▉   | 107/155 [00:25<00:11,  4.29it/s]
 70%|██████▉   | 108/155 [00:25<00:11,  4.23it/s]
 70%|███████   | 109/155 [00:25<00:10,  4.29it/s]
 71%|███████   | 110/155 [00:26<00:10,  4.30it/s]
 72%|███████▏  | 111/155 [00:26<00:09,  4.46it/s]
 72%|███████▏  | 112/155 [00:26<00:09,  4.37it/s]
 73%|███████▎  | 113/155 [00:26<00:09,  4.34it/s]
 74%|███████▎  | 114/155 [00:27<00:09,  4.16it/s]
 74%|███████▍  | 115/155 [00:27<00:09,  4.09it/s]
 75%|███████▍  | 116/155 [00:27<00:09,  4.23it/s]
 75%|███████▌  | 117/155 [00:27<00:09,  4.20it/s]
 76%|███████▌  | 118/155 [00:28<00:08,  4.37it/s]
 77%|███████▋  | 119/155 [00:28<00:08,  4.05it/s]
 77%|███████▋  | 120/155 [00:28<00:08,  4.14it/s]
 78%|███████▊  | 121/155 [00:28<00:08,  4.02it/s]
 79%|███████▊  | 122/155 [00:29<00:08,  4.12it/s]
 79%|███████▉  | 123/155 [00:29<00:07,  4.18it/s]
 80%|████████  | 124/155 [00:29<00:07,  4.10it/s]
 81%|████████  | 125/155 [00:29<00:07,  4.25it/s]
 81%|████████▏ | 126/155 [00:30<00:06,  4.26it/s]
 82%|████████▏ | 127/155 [00:30<00:06,  4.37it/s]
 83%|████████▎ | 128/155 [00:30<00:06,  4.24it/s]
 83%|████████▎ | 129/155 [00:30<00:06,  4.13it/s]
 84%|████████▍ | 130/155 [00:30<00:06,  4.07it/s]
 85%|████████▍ | 131/155 [00:31<00:06,  3.99it/s]
 85%|████████▌ | 132/155 [00:31<00:05,  4.16it/s]
 86%|████████▌ | 133/155 [00:31<00:05,  4.22it/s]
 86%|████████▋ | 134/155 [00:31<00:05,  4.14it/s]
 87%|████████▋ | 135/155 [00:32<00:04,  4.23it/s]
 88%|████████▊ | 136/155 [00:32<00:04,  4.31it/s]
 88%|████████▊ | 137/155 [00:32<00:04,  4.40it/s]
 89%|████████▉ | 138/155 [00:32<00:03,  4.27it/s]
 90%|████████▉ | 139/155 [00:33<00:03,  4.23it/s]
 90%|█████████ | 140/155 [00:33<00:03,  4.22it/s]
 91%|█████████ | 141/155 [00:33<00:03,  4.19it/s]
 92%|█████████▏| 142/155 [00:33<00:03,  4.31it/s]
 92%|█████████▏| 143/155 [00:34<00:02,  4.42it/s]
 93%|█████████▎| 144/155 [00:34<00:02,  4.19it/s]
 94%|█████████▎| 145/155 [00:34<00:02,  4.21it/s]
 94%|█████████▍| 146/155 [00:34<00:02,  4.32it/s]
 95%|█████████▍| 147/155 [00:34<00:01,  4.33it/s]
 95%|█████████▌| 148/155 [00:35<00:01,  4.42it/s]
 96%|█████████▌| 149/155 [00:35<00:01,  4.35it/s]
 97%|█████████▋| 150/155 [00:35<00:01,  4.40it/s]
 97%|█████████▋| 151/155 [00:35<00:00,  4.45it/s]
 98%|█████████▊| 152/155 [00:36<00:00,  4.53it/s]
 99%|█████████▊| 153/155 [00:36<00:00,  4.51it/s]
 99%|█████████▉| 154/155 [00:36<00:00,  4.20it/s]
100%|██████████| 155/155 [00:36<00:00,  4.22it/s]
+-------+------------------------+--------------------+-------------+-------------+-----------+----------+
| epoch |           lr           |     train_loss     | val_top1acc | val_top3acc | val_ndcg1 | val_mrr3 |
+-------+------------------------+--------------------+-------------+-------------+-----------+----------+
|   0   | 1.0000000000000023e-05 | 2.2853724935689868 |    43.42    |    76.27    |   67.87   |  57.81   |
|   1   |  9.99112027792722e-06  | 1.5891911364018136 |    52.55    |    82.72    |   74.75   |  66.10   |
|   2   | 9.964516155915175e-06  | 1.2577084753190586 |    58.79    |    87.16    |   78.59   |  71.44   |
|   3   | 9.920292628279128e-06  | 1.0084300179148344 |    61.43    |    88.79    |   80.23   |  73.58   |
|   4   | 9.858624225078883e-06  | 0.793933470176297  |    63.23    |    88.79    |   81.15   |  74.64   |
|   5   | 9.779754323328173e-06  | 0.6315311710126535 |    63.55    |    89.32    |   81.46   |  75.15   |
+-------+------------------------+--------------------+-------------+-------------+-----------+----------+
/ceph/hpc/home/eujongc/anaconda3/envs/latentops/lib/python3.9/site-packages/torch/utils/data/dataloader.py:554: UserWarning: This DataLoader will create 4 worker processes in total. Our suggested max number of worker in current system is 2, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(_create_warning_msg(
Train Epoch: [6]  [  0/229]  eta: 0:04:55  lr: 0.000010  loss: 0.4890  time: 1.2921  data: 0.1265  max mem: 30242
Train Epoch: [6]  [ 50/229]  eta: 0:03:23  lr: 0.000010  loss: 0.4559  time: 1.1361  data: 0.0001  max mem: 30242
Train Epoch: [6]  [100/229]  eta: 0:02:27  lr: 0.000010  loss: 0.4196  time: 1.1389  data: 0.0001  max mem: 30242
Train Epoch: [6]  [150/229]  eta: 0:01:30  lr: 0.000010  loss: 0.6452  time: 1.1271  data: 0.0001  max mem: 30242
Train Epoch: [6]  [200/229]  eta: 0:00:33  lr: 0.000010  loss: 0.6001  time: 1.1200  data: 0.0001  max mem: 30242
Train Epoch: [6]  [228/229]  eta: 0:00:01  lr: 0.000010  loss: 0.4984  time: 1.1443  data: 0.0001  max mem: 30242
2023-07-10 16:48:48,782 Train Epoch: [6] Total time: 0:04:22 (1.1467 s / it)
2023-07-10 16:48:48,786 Computing features for evaluation...

  0%|          | 0/154 [00:00<?, ?it/s]
  1%|          | 1/154 [00:00<00:51,  2.96it/s]
  1%|▏         | 2/154 [00:00<00:54,  2.77it/s]
  2%|▏         | 3/154 [00:00<00:45,  3.33it/s]
  3%|▎         | 4/154 [00:01<00:40,  3.69it/s]
  3%|▎         | 5/154 [00:01<00:39,  3.79it/s]
  4%|▍         | 6/154 [00:01<00:36,  4.03it/s]
  5%|▍         | 7/154 [00:01<00:34,  4.30it/s]
  5%|▌         | 8/154 [00:02<00:34,  4.25it/s]
  6%|▌         | 9/154 [00:02<00:34,  4.21it/s]
  6%|▋         | 10/154 [00:02<00:33,  4.33it/s]
  7%|▋         | 11/154 [00:02<00:34,  4.19it/s]
  8%|▊         | 12/154 [00:03<00:34,  4.17it/s]
  8%|▊         | 13/154 [00:03<00:33,  4.23it/s]
  9%|▉         | 14/154 [00:03<00:33,  4.19it/s]
 10%|▉         | 15/154 [00:03<00:32,  4.22it/s]
 10%|█         | 16/154 [00:03<00:31,  4.34it/s]
 11%|█         | 17/154 [00:04<00:31,  4.33it/s]
 12%|█▏        | 18/154 [00:04<00:31,  4.33it/s]
 12%|█▏        | 19/154 [00:04<00:32,  4.18it/s]
 13%|█▎        | 20/154 [00:04<00:32,  4.17it/s]
 14%|█▎        | 21/154 [00:05<00:30,  4.30it/s]
 14%|█▍        | 22/154 [00:05<00:29,  4.42it/s]
 15%|█▍        | 23/154 [00:05<00:29,  4.48it/s]
 16%|█▌        | 24/154 [00:05<00:29,  4.44it/s]
 16%|█▌        | 25/154 [00:06<00:29,  4.43it/s]
 17%|█▋        | 26/154 [00:06<00:29,  4.39it/s]
 18%|█▊        | 27/154 [00:06<00:28,  4.46it/s]
 18%|█▊        | 28/154 [00:06<00:28,  4.37it/s]
 19%|█▉        | 29/154 [00:06<00:28,  4.44it/s]
 19%|█▉        | 30/154 [00:07<00:27,  4.49it/s]
 20%|██        | 31/154 [00:07<00:27,  4.42it/s]
 21%|██        | 32/154 [00:07<00:27,  4.47it/s]
 21%|██▏       | 33/154 [00:07<00:27,  4.43it/s]
 22%|██▏       | 34/154 [00:08<00:27,  4.33it/s]
 23%|██▎       | 35/154 [00:08<00:27,  4.39it/s]
 23%|██▎       | 36/154 [00:08<00:26,  4.37it/s]
 24%|██▍       | 37/154 [00:08<00:26,  4.34it/s]
 25%|██▍       | 38/154 [00:08<00:26,  4.36it/s]
 25%|██▌       | 39/154 [00:09<00:25,  4.43it/s]
 26%|██▌       | 40/154 [00:09<00:25,  4.41it/s]
 27%|██▋       | 41/154 [00:09<00:26,  4.25it/s]
 27%|██▋       | 42/154 [00:09<00:26,  4.21it/s]
 28%|██▊       | 43/154 [00:10<00:26,  4.19it/s]
 29%|██▊       | 44/154 [00:10<00:25,  4.39it/s]
 29%|██▉       | 45/154 [00:10<00:25,  4.30it/s]
 30%|██▉       | 46/154 [00:10<00:24,  4.39it/s]
 31%|███       | 47/154 [00:11<00:24,  4.38it/s]
 31%|███       | 48/154 [00:11<00:23,  4.42it/s]
 32%|███▏      | 49/154 [00:11<00:23,  4.39it/s]
 32%|███▏      | 50/154 [00:11<00:24,  4.31it/s]
 33%|███▎      | 51/154 [00:11<00:23,  4.38it/s]
 34%|███▍      | 52/154 [00:12<00:23,  4.29it/s]
 34%|███▍      | 53/154 [00:12<00:23,  4.27it/s]
 35%|███▌      | 54/154 [00:12<00:22,  4.36it/s]
 36%|███▌      | 55/154 [00:12<00:23,  4.30it/s]
 36%|███▋      | 56/154 [00:13<00:23,  4.25it/s]
 37%|███▋      | 57/154 [00:13<00:22,  4.36it/s]
 38%|███▊      | 58/154 [00:13<00:22,  4.35it/s]
 38%|███▊      | 59/154 [00:13<00:21,  4.40it/s]
 39%|███▉      | 60/154 [00:14<00:22,  4.26it/s]
 40%|███▉      | 61/154 [00:14<00:21,  4.27it/s]
 40%|████      | 62/154 [00:14<00:21,  4.30it/s]
 41%|████      | 63/154 [00:14<00:21,  4.30it/s]
 42%|████▏     | 64/154 [00:14<00:20,  4.38it/s]
 42%|████▏     | 65/154 [00:15<00:21,  4.19it/s]
 43%|████▎     | 66/154 [00:15<00:21,  4.10it/s]
 44%|████▎     | 67/154 [00:15<00:21,  4.11it/s]
 44%|████▍     | 68/154 [00:15<00:20,  4.24it/s]
 45%|████▍     | 69/154 [00:16<00:19,  4.26it/s]
 45%|████▌     | 70/154 [00:16<00:19,  4.36it/s]
 46%|████▌     | 71/154 [00:16<00:19,  4.34it/s]
 47%|████▋     | 72/154 [00:16<00:19,  4.29it/s]
 47%|████▋     | 73/154 [00:17<00:18,  4.29it/s]
 48%|████▊     | 74/154 [00:17<00:18,  4.30it/s]
 49%|████▊     | 75/154 [00:17<00:18,  4.30it/s]
 49%|████▉     | 76/154 [00:17<00:18,  4.15it/s]
 50%|█████     | 77/154 [00:18<00:18,  4.27it/s]
 51%|█████     | 78/154 [00:18<00:17,  4.23it/s]
 51%|█████▏    | 79/154 [00:18<00:17,  4.30it/s]
 52%|█████▏    | 80/154 [00:18<00:17,  4.14it/s]
 53%|█████▎    | 81/154 [00:18<00:16,  4.32it/s]
 53%|█████▎    | 82/154 [00:19<00:16,  4.40it/s]
 54%|█████▍    | 83/154 [00:19<00:16,  4.24it/s]
 55%|█████▍    | 84/154 [00:19<00:16,  4.29it/s]
 55%|█████▌    | 85/154 [00:19<00:15,  4.44it/s]
 56%|█████▌    | 86/154 [00:20<00:15,  4.35it/s]
 56%|█████▋    | 87/154 [00:20<00:15,  4.34it/s]
 57%|█████▋    | 88/154 [00:20<00:15,  4.22it/s]
 58%|█████▊    | 89/154 [00:20<00:15,  4.23it/s]
 58%|█████▊    | 90/154 [00:21<00:14,  4.33it/s]
 59%|█████▉    | 91/154 [00:21<00:14,  4.33it/s]
 60%|█████▉    | 92/154 [00:21<00:15,  3.94it/s]
 60%|██████    | 93/154 [00:21<00:15,  3.98it/s]
 61%|██████    | 94/154 [00:22<00:15,  3.91it/s]
 62%|██████▏   | 95/154 [00:22<00:15,  3.92it/s]
 62%|██████▏   | 96/154 [00:22<00:14,  3.93it/s]
 63%|██████▎   | 97/154 [00:22<00:14,  4.00it/s]
 64%|██████▎   | 98/154 [00:23<00:13,  4.17it/s]
 64%|██████▍   | 99/154 [00:23<00:13,  4.12it/s]
 65%|██████▍   | 100/154 [00:23<00:13,  4.08it/s]
 66%|██████▌   | 101/154 [00:23<00:12,  4.17it/s]
 66%|██████▌   | 102/154 [00:24<00:12,  4.29it/s]
 67%|██████▋   | 103/154 [00:24<00:11,  4.29it/s]
 68%|██████▊   | 104/154 [00:24<00:11,  4.30it/s]
 68%|██████▊   | 105/154 [00:24<00:11,  4.30it/s]
 69%|██████▉   | 106/154 [00:24<00:10,  4.37it/s]
 69%|██████▉   | 107/154 [00:25<00:10,  4.33it/s]
 70%|███████   | 108/154 [00:25<00:10,  4.19it/s]
 71%|███████   | 109/154 [00:25<00:10,  4.31it/s]
 71%|███████▏  | 110/154 [00:25<00:10,  4.18it/s]
 72%|███████▏  | 111/154 [00:26<00:10,  4.27it/s]
 73%|███████▎  | 112/154 [00:26<00:09,  4.23it/s]
 73%|███████▎  | 113/154 [00:26<00:09,  4.26it/s]
 74%|███████▍  | 114/154 [00:26<00:09,  4.35it/s]
 75%|███████▍  | 115/154 [00:27<00:08,  4.35it/s]
 75%|███████▌  | 116/154 [00:27<00:08,  4.36it/s]
 76%|███████▌  | 117/154 [00:27<00:08,  4.41it/s]
 77%|███████▋  | 118/154 [00:27<00:08,  4.37it/s]
 77%|███████▋  | 119/154 [00:27<00:07,  4.43it/s]
 78%|███████▊  | 120/154 [00:28<00:07,  4.56it/s]
 79%|███████▊  | 121/154 [00:28<00:07,  4.54it/s]
 79%|███████▉  | 122/154 [00:28<00:07,  4.56it/s]
 80%|███████▉  | 123/154 [00:28<00:07,  4.35it/s]
 81%|████████  | 124/154 [00:29<00:06,  4.33it/s]
 81%|████████  | 125/154 [00:29<00:06,  4.41it/s]
 82%|████████▏ | 126/154 [00:29<00:06,  4.26it/s]
 82%|████████▏ | 127/154 [00:29<00:06,  4.29it/s]
 83%|████████▎ | 128/154 [00:30<00:06,  4.05it/s]
 84%|████████▍ | 129/154 [00:30<00:06,  4.14it/s]
 84%|████████▍ | 130/154 [00:30<00:05,  4.19it/s]
 85%|████████▌ | 131/154 [00:30<00:05,  4.23it/s]
 86%|████████▌ | 132/154 [00:30<00:05,  4.33it/s]
 86%|████████▋ | 133/154 [00:31<00:04,  4.27it/s]
 87%|████████▋ | 134/154 [00:31<00:04,  4.10it/s]
 88%|████████▊ | 135/154 [00:31<00:04,  4.18it/s]
 88%|████████▊ | 136/154 [00:31<00:04,  4.34it/s]
 89%|████████▉ | 137/154 [00:32<00:03,  4.39it/s]
 90%|████████▉ | 138/154 [00:32<00:03,  4.51it/s]
 90%|█████████ | 139/154 [00:32<00:03,  4.53it/s]
 91%|█████████ | 140/154 [00:32<00:03,  4.40it/s]
 92%|█████████▏| 141/154 [00:33<00:02,  4.34it/s]
 92%|█████████▏| 142/154 [00:33<00:02,  4.34it/s]
 93%|█████████▎| 143/154 [00:33<00:02,  4.35it/s]
 94%|█████████▎| 144/154 [00:33<00:02,  4.27it/s]
 94%|█████████▍| 145/154 [00:33<00:02,  4.43it/s]
 95%|█████████▍| 146/154 [00:34<00:01,  4.40it/s]
 95%|█████████▌| 147/154 [00:34<00:01,  4.27it/s]
 96%|█████████▌| 148/154 [00:34<00:01,  4.18it/s]
 97%|█████████▋| 149/154 [00:34<00:01,  4.32it/s]
 97%|█████████▋| 150/154 [00:35<00:00,  4.33it/s]
 98%|█████████▊| 151/154 [00:35<00:00,  4.22it/s]
 99%|█████████▊| 152/154 [00:35<00:00,  4.40it/s]
 99%|█████████▉| 153/154 [00:35<00:00,  4.28it/s]
100%|██████████| 154/154 [00:36<00:00,  4.28it/s]
2023-07-10 16:49:26,215 Computing features for evaluation...

  0%|          | 0/155 [00:00<?, ?it/s]/ceph/hpc/home/eujongc/anaconda3/envs/latentops/lib/python3.9/site-packages/torch/utils/data/dataloader.py:554: UserWarning: This DataLoader will create 4 worker processes in total. Our suggested max number of worker in current system is 2, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(_create_warning_msg(

  1%|          | 1/155 [00:00<00:54,  2.82it/s]
  1%|▏         | 2/155 [00:00<00:42,  3.63it/s]
  2%|▏         | 3/155 [00:00<00:38,  3.95it/s]
  3%|▎         | 4/155 [00:01<00:40,  3.74it/s]
  3%|▎         | 5/155 [00:01<00:39,  3.82it/s]
  4%|▍         | 6/155 [00:01<00:36,  4.05it/s]
  5%|▍         | 7/155 [00:01<00:36,  4.04it/s]
  5%|▌         | 8/155 [00:02<00:35,  4.15it/s]
  6%|▌         | 9/155 [00:02<00:34,  4.20it/s]
  6%|▋         | 10/155 [00:02<00:34,  4.25it/s]
  7%|▋         | 11/155 [00:02<00:34,  4.14it/s]
  8%|▊         | 12/155 [00:02<00:33,  4.22it/s]
  8%|▊         | 13/155 [00:03<00:34,  4.17it/s]
  9%|▉         | 14/155 [00:03<00:34,  4.11it/s]
 10%|▉         | 15/155 [00:03<00:34,  4.01it/s]
 10%|█         | 16/155 [00:03<00:32,  4.23it/s]
 11%|█         | 17/155 [00:04<00:33,  4.18it/s]
 12%|█▏        | 18/155 [00:04<00:33,  4.10it/s]
 12%|█▏        | 19/155 [00:04<00:32,  4.24it/s]
 13%|█▎        | 20/155 [00:04<00:32,  4.19it/s]
 14%|█▎        | 21/155 [00:05<00:31,  4.30it/s]
 14%|█▍        | 22/155 [00:05<00:29,  4.45it/s]
 15%|█▍        | 23/155 [00:05<00:30,  4.40it/s]
 15%|█▌        | 24/155 [00:05<00:30,  4.32it/s]
 16%|█▌        | 25/155 [00:06<00:29,  4.39it/s]
 17%|█▋        | 26/155 [00:06<00:30,  4.24it/s]
 17%|█▋        | 27/155 [00:06<00:29,  4.27it/s]
 18%|█▊        | 28/155 [00:06<00:29,  4.35it/s]
 19%|█▊        | 29/155 [00:06<00:29,  4.23it/s]
 19%|█▉        | 30/155 [00:07<00:30,  4.14it/s]
 20%|██        | 31/155 [00:07<00:30,  4.09it/s]
 21%|██        | 32/155 [00:07<00:29,  4.22it/s]
 21%|██▏       | 33/155 [00:07<00:28,  4.25it/s]
 22%|██▏       | 34/155 [00:08<00:28,  4.22it/s]
 23%|██▎       | 35/155 [00:08<00:28,  4.19it/s]
 23%|██▎       | 36/155 [00:08<00:28,  4.13it/s]
 24%|██▍       | 37/155 [00:08<00:29,  4.01it/s]
 25%|██▍       | 38/155 [00:09<00:28,  4.09it/s]
 25%|██▌       | 39/155 [00:09<00:27,  4.17it/s]
 26%|██▌       | 40/155 [00:09<00:26,  4.29it/s]
 26%|██▋       | 41/155 [00:09<00:27,  4.17it/s]
 27%|██▋       | 42/155 [00:10<00:26,  4.24it/s]
 28%|██▊       | 43/155 [00:10<00:26,  4.22it/s]
 28%|██▊       | 44/155 [00:10<00:26,  4.21it/s]
 29%|██▉       | 45/155 [00:10<00:25,  4.32it/s]
 30%|██▉       | 46/155 [00:11<00:25,  4.20it/s]
 30%|███       | 47/155 [00:11<00:25,  4.18it/s]
 31%|███       | 48/155 [00:11<00:25,  4.18it/s]
 32%|███▏      | 49/155 [00:11<00:24,  4.29it/s]
 32%|███▏      | 50/155 [00:12<00:25,  4.20it/s]
 33%|███▎      | 51/155 [00:12<00:24,  4.18it/s]
 34%|███▎      | 52/155 [00:12<00:25,  4.04it/s]
 34%|███▍      | 53/155 [00:12<00:24,  4.10it/s]
 35%|███▍      | 54/155 [00:12<00:23,  4.25it/s]
 35%|███▌      | 55/155 [00:13<00:23,  4.28it/s]
 36%|███▌      | 56/155 [00:13<00:23,  4.30it/s]
 37%|███▋      | 57/155 [00:13<00:23,  4.24it/s]
 37%|███▋      | 58/155 [00:13<00:23,  4.21it/s]
 38%|███▊      | 59/155 [00:14<00:22,  4.24it/s]
 39%|███▊      | 60/155 [00:14<00:21,  4.35it/s]
 39%|███▉      | 61/155 [00:14<00:22,  4.09it/s]
 40%|████      | 62/155 [00:14<00:22,  4.18it/s]
 41%|████      | 63/155 [00:15<00:21,  4.24it/s]
 41%|████▏     | 64/155 [00:15<00:21,  4.25it/s]
 42%|████▏     | 65/155 [00:15<00:20,  4.41it/s]
 43%|████▎     | 66/155 [00:15<00:20,  4.30it/s]
 43%|████▎     | 67/155 [00:15<00:20,  4.37it/s]
 44%|████▍     | 68/155 [00:16<00:19,  4.46it/s]
 45%|████▍     | 69/155 [00:16<00:19,  4.37it/s]
 45%|████▌     | 70/155 [00:16<00:19,  4.30it/s]
 46%|████▌     | 71/155 [00:16<00:19,  4.31it/s]
 46%|████▋     | 72/155 [00:17<00:20,  4.01it/s]
 47%|████▋     | 73/155 [00:17<00:21,  3.82it/s]
 48%|████▊     | 74/155 [00:17<00:20,  3.90it/s]
 48%|████▊     | 75/155 [00:17<00:19,  4.03it/s]
 49%|████▉     | 76/155 [00:18<00:19,  4.11it/s]
 50%|████▉     | 77/155 [00:18<00:18,  4.11it/s]
 50%|█████     | 78/155 [00:18<00:18,  4.13it/s]
 51%|█████     | 79/155 [00:18<00:17,  4.31it/s]
 52%|█████▏    | 80/155 [00:19<00:16,  4.46it/s]
 52%|█████▏    | 81/155 [00:19<00:17,  4.29it/s]
 53%|█████▎    | 82/155 [00:19<00:16,  4.30it/s]
 54%|█████▎    | 83/155 [00:19<00:17,  4.13it/s]
 54%|█████▍    | 84/155 [00:20<00:16,  4.24it/s]
 55%|█████▍    | 85/155 [00:20<00:16,  4.27it/s]
 55%|█████▌    | 86/155 [00:20<00:16,  4.30it/s]
 56%|█████▌    | 87/155 [00:20<00:15,  4.36it/s]
 57%|█████▋    | 88/155 [00:20<00:15,  4.43it/s]
 57%|█████▋    | 89/155 [00:21<00:14,  4.54it/s]
 58%|█████▊    | 90/155 [00:21<00:14,  4.49it/s]
 59%|█████▊    | 91/155 [00:21<00:14,  4.44it/s]
 59%|█████▉    | 92/155 [00:21<00:14,  4.49it/s]
 60%|██████    | 93/155 [00:22<00:13,  4.56it/s]
 61%|██████    | 94/155 [00:22<00:13,  4.54it/s]
 61%|██████▏   | 95/155 [00:22<00:13,  4.48it/s]
 62%|██████▏   | 96/155 [00:22<00:13,  4.37it/s]
 63%|██████▎   | 97/155 [00:22<00:13,  4.43it/s]
 63%|██████▎   | 98/155 [00:23<00:13,  4.35it/s]
 64%|██████▍   | 99/155 [00:23<00:12,  4.42it/s]
 65%|██████▍   | 100/155 [00:23<00:12,  4.32it/s]
 65%|██████▌   | 101/155 [00:23<00:12,  4.33it/s]
 66%|██████▌   | 102/155 [00:24<00:12,  4.34it/s]
 66%|██████▋   | 103/155 [00:24<00:12,  4.20it/s]
 67%|██████▋   | 104/155 [00:24<00:12,  4.24it/s]
 68%|██████▊   | 105/155 [00:24<00:11,  4.25it/s]
 68%|██████▊   | 106/155 [00:25<00:11,  4.23it/s]
 69%|██████▉   | 107/155 [00:25<00:11,  4.28it/s]
 70%|██████▉   | 108/155 [00:25<00:11,  4.23it/s]
 70%|███████   | 109/155 [00:25<00:10,  4.28it/s]
 71%|███████   | 110/155 [00:26<00:10,  4.30it/s]
 72%|███████▏  | 111/155 [00:26<00:09,  4.45it/s]
 72%|███████▏  | 112/155 [00:26<00:09,  4.36it/s]
 73%|███████▎  | 113/155 [00:26<00:09,  4.33it/s]
 74%|███████▎  | 114/155 [00:26<00:09,  4.16it/s]
 74%|███████▍  | 115/155 [00:27<00:09,  4.09it/s]
 75%|███████▍  | 116/155 [00:27<00:09,  4.23it/s]
 75%|███████▌  | 117/155 [00:27<00:09,  4.20it/s]
 76%|███████▌  | 118/155 [00:27<00:08,  4.38it/s]
 77%|███████▋  | 119/155 [00:28<00:08,  4.05it/s]
 77%|███████▋  | 120/155 [00:28<00:08,  4.14it/s]
 78%|███████▊  | 121/155 [00:28<00:08,  4.02it/s]
 79%|███████▊  | 122/155 [00:28<00:08,  4.12it/s]
 79%|███████▉  | 123/155 [00:29<00:07,  4.18it/s]
 80%|████████  | 124/155 [00:29<00:07,  4.09it/s]
 81%|████████  | 125/155 [00:29<00:07,  4.25it/s]
 81%|████████▏ | 126/155 [00:29<00:06,  4.26it/s]
 82%|████████▏ | 127/155 [00:30<00:06,  4.37it/s]
 83%|████████▎ | 128/155 [00:30<00:06,  4.24it/s]
 83%|████████▎ | 129/155 [00:30<00:06,  4.13it/s]
 84%|████████▍ | 130/155 [00:30<00:06,  4.07it/s]
 85%|████████▍ | 131/155 [00:31<00:06,  3.98it/s]
 85%|████████▌ | 132/155 [00:31<00:05,  4.16it/s]
 86%|████████▌ | 133/155 [00:31<00:05,  4.22it/s]
 86%|████████▋ | 134/155 [00:31<00:05,  4.14it/s]
 87%|████████▋ | 135/155 [00:31<00:04,  4.23it/s]
 88%|████████▊ | 136/155 [00:32<00:04,  4.31it/s]
 88%|████████▊ | 137/155 [00:32<00:04,  4.39it/s]
 89%|████████▉ | 138/155 [00:32<00:03,  4.26it/s]
 90%|████████▉ | 139/155 [00:32<00:03,  4.22it/s]
 90%|█████████ | 140/155 [00:33<00:03,  4.21it/s]
 91%|█████████ | 141/155 [00:33<00:03,  4.19it/s]
 92%|█████████▏| 142/155 [00:33<00:03,  4.31it/s]
 92%|█████████▏| 143/155 [00:33<00:02,  4.41it/s]
 93%|█████████▎| 144/155 [00:34<00:02,  4.19it/s]
 94%|█████████▎| 145/155 [00:34<00:02,  4.21it/s]
 94%|█████████▍| 146/155 [00:34<00:02,  4.32it/s]
 95%|█████████▍| 147/155 [00:34<00:01,  4.32it/s]
 95%|█████████▌| 148/155 [00:35<00:01,  4.42it/s]
 96%|█████████▌| 149/155 [00:35<00:01,  4.34it/s]
 97%|█████████▋| 150/155 [00:35<00:01,  4.40it/s]
 97%|█████████▋| 151/155 [00:35<00:00,  4.45it/s]
 98%|█████████▊| 152/155 [00:35<00:00,  4.53it/s]
 99%|█████████▊| 153/155 [00:36<00:00,  4.51it/s]
 99%|█████████▉| 154/155 [00:36<00:00,  4.19it/s]
100%|██████████| 155/155 [00:36<00:00,  4.24it/s]
+-------+------------------------+--------------------+-------------+-------------+-----------+----------+
| epoch |           lr           |     train_loss     | val_top1acc | val_top3acc | val_ndcg1 | val_mrr3 |
+-------+------------------------+--------------------+-------------+-------------+-----------+----------+
|   0   | 1.0000000000000023e-05 | 2.2853724935689868 |    43.42    |    76.27    |   67.87   |  57.81   |
|   1   |  9.99112027792722e-06  | 1.5891911364018136 |    52.55    |    82.72    |   74.75   |  66.10   |
|   2   | 9.964516155915175e-06  | 1.2577084753190586 |    58.79    |    87.16    |   78.59   |  71.44   |
|   3   | 9.920292628279128e-06  | 1.0084300179148344 |    61.43    |    88.79    |   80.23   |  73.58   |
|   4   | 9.858624225078883e-06  | 0.793933470176297  |    63.23    |    88.79    |   81.15   |  74.64   |
|   5   | 9.779754323328173e-06  | 0.6315311710126535 |    63.55    |    89.32    |   81.46   |  75.15   |
|   6   | 9.683994186497118e-06  | 0.5157908185600714 |    63.80    |    89.20    |   81.63   |  75.24   |
+-------+------------------------+--------------------+-------------+-------------+-----------+----------+
/ceph/hpc/home/eujongc/anaconda3/envs/latentops/lib/python3.9/site-packages/torch/utils/data/dataloader.py:554: UserWarning: This DataLoader will create 4 worker processes in total. Our suggested max number of worker in current system is 2, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(_create_warning_msg(
Train Epoch: [7]  [  0/229]  eta: 0:04:46  lr: 0.000010  loss: 0.3167  time: 1.2517  data: 0.1297  max mem: 30242
Train Epoch: [7]  [ 50/229]  eta: 0:03:26  lr: 0.000010  loss: 0.2933  time: 1.1711  data: 0.0001  max mem: 30242
Train Epoch: [7]  [100/229]  eta: 0:02:28  lr: 0.000010  loss: 0.3528  time: 1.1213  data: 0.0001  max mem: 30242
Train Epoch: [7]  [150/229]  eta: 0:01:30  lr: 0.000010  loss: 0.2378  time: 1.1404  data: 0.0001  max mem: 30242
Train Epoch: [7]  [200/229]  eta: 0:00:33  lr: 0.000010  loss: 0.3963  time: 1.1439  data: 0.0001  max mem: 30242
Train Epoch: [7]  [228/229]  eta: 0:00:01  lr: 0.000010  loss: 0.3979  time: 1.1369  data: 0.0001  max mem: 30242
2023-07-10 16:54:25,990 Train Epoch: [7] Total time: 0:04:22 (1.1473 s / it)
2023-07-10 16:54:25,993 Computing features for evaluation...

  0%|          | 0/154 [00:00<?, ?it/s]
  1%|          | 1/154 [00:00<00:52,  2.91it/s]
  1%|▏         | 2/154 [00:00<00:41,  3.67it/s]
  2%|▏         | 3/154 [00:00<00:38,  3.96it/s]
  3%|▎         | 4/154 [00:01<00:36,  4.13it/s]
  3%|▎         | 5/154 [00:01<00:36,  4.08it/s]
  4%|▍         | 6/154 [00:01<00:34,  4.23it/s]
  5%|▍         | 7/154 [00:01<00:33,  4.45it/s]
  5%|▌         | 8/154 [00:01<00:33,  4.35it/s]
  6%|▌         | 9/154 [00:02<00:33,  4.27it/s]
  6%|▋         | 10/154 [00:02<00:32,  4.37it/s]
  7%|▋         | 11/154 [00:02<00:33,  4.21it/s]
  8%|▊         | 12/154 [00:02<00:33,  4.19it/s]
  8%|▊         | 13/154 [00:03<00:33,  4.23it/s]
  9%|▉         | 14/154 [00:03<00:33,  4.20it/s]
 10%|▉         | 15/154 [00:03<00:32,  4.22it/s]
 10%|█         | 16/154 [00:03<00:31,  4.34it/s]
 11%|█         | 17/154 [00:04<00:31,  4.32it/s]
 12%|█▏        | 18/154 [00:04<00:31,  4.33it/s]
 12%|█▏        | 19/154 [00:04<00:32,  4.17it/s]
 13%|█▎        | 20/154 [00:04<00:32,  4.16it/s]
 14%|█▎        | 21/154 [00:04<00:30,  4.29it/s]
 14%|█▍        | 22/154 [00:05<00:29,  4.42it/s]
 15%|█▍        | 23/154 [00:05<00:29,  4.47it/s]
 16%|█▌        | 24/154 [00:05<00:29,  4.43it/s]
 16%|█▌        | 25/154 [00:05<00:29,  4.41it/s]
 17%|█▋        | 26/154 [00:06<00:29,  4.38it/s]
 18%|█▊        | 27/154 [00:06<00:28,  4.46it/s]
 18%|█▊        | 28/154 [00:06<00:28,  4.37it/s]
 19%|█▉        | 29/154 [00:06<00:28,  4.43it/s]
 19%|█▉        | 30/154 [00:07<00:27,  4.48it/s]
 20%|██        | 31/154 [00:07<00:27,  4.43it/s]
 21%|██        | 32/154 [00:07<00:27,  4.47it/s]
 21%|██▏       | 33/154 [00:07<00:27,  4.43it/s]
 22%|██▏       | 34/154 [00:07<00:27,  4.32it/s]
 23%|██▎       | 35/154 [00:08<00:27,  4.38it/s]
 23%|██▎       | 36/154 [00:08<00:27,  4.37it/s]
 24%|██▍       | 37/154 [00:08<00:27,  4.33it/s]
 25%|██▍       | 38/154 [00:08<00:26,  4.38it/s]
 25%|██▌       | 39/154 [00:09<00:25,  4.44it/s]
 26%|██▌       | 40/154 [00:09<00:25,  4.41it/s]
 27%|██▋       | 41/154 [00:09<00:26,  4.24it/s]
 27%|██▋       | 42/154 [00:09<00:26,  4.21it/s]
 28%|██▊       | 43/154 [00:10<00:26,  4.19it/s]
 29%|██▊       | 44/154 [00:10<00:25,  4.37it/s]
 29%|██▉       | 45/154 [00:10<00:25,  4.28it/s]
 30%|██▉       | 46/154 [00:10<00:24,  4.37it/s]
 31%|███       | 47/154 [00:10<00:24,  4.37it/s]
 31%|███       | 48/154 [00:11<00:24,  4.40it/s]
 32%|███▏      | 49/154 [00:11<00:24,  4.37it/s]
 32%|███▏      | 50/154 [00:11<00:24,  4.30it/s]
 33%|███▎      | 51/154 [00:11<00:23,  4.38it/s]
 34%|███▍      | 52/154 [00:12<00:23,  4.28it/s]
 34%|███▍      | 53/154 [00:12<00:23,  4.26it/s]
 35%|███▌      | 54/154 [00:12<00:22,  4.35it/s]
 36%|███▌      | 55/154 [00:12<00:23,  4.29it/s]
 36%|███▋      | 56/154 [00:13<00:23,  4.25it/s]
 37%|███▋      | 57/154 [00:13<00:22,  4.36it/s]
 38%|███▊      | 58/154 [00:13<00:22,  4.34it/s]
 38%|███▊      | 59/154 [00:13<00:21,  4.39it/s]
 39%|███▉      | 60/154 [00:13<00:22,  4.25it/s]
 40%|███▉      | 61/154 [00:14<00:21,  4.26it/s]
 40%|████      | 62/154 [00:14<00:21,  4.28it/s]
 41%|████      | 63/154 [00:14<00:21,  4.30it/s]
 42%|████▏     | 64/154 [00:14<00:20,  4.37it/s]
 42%|████▏     | 65/154 [00:15<00:21,  4.18it/s]
 43%|████▎     | 66/154 [00:15<00:21,  4.07it/s]
 44%|████▎     | 67/154 [00:15<00:21,  4.09it/s]
 44%|████▍     | 68/154 [00:15<00:20,  4.22it/s]
 45%|████▍     | 69/154 [00:16<00:20,  4.25it/s]
 45%|████▌     | 70/154 [00:16<00:19,  4.35it/s]
 46%|████▌     | 71/154 [00:16<00:19,  4.33it/s]
 47%|████▋     | 72/154 [00:16<00:19,  4.27it/s]
 47%|████▋     | 73/154 [00:17<00:18,  4.28it/s]
 48%|████▊     | 74/154 [00:17<00:18,  4.29it/s]
 49%|████▊     | 75/154 [00:17<00:18,  4.29it/s]
 49%|████▉     | 76/154 [00:17<00:18,  4.15it/s]
 50%|█████     | 77/154 [00:17<00:18,  4.26it/s]
 51%|█████     | 78/154 [00:18<00:18,  4.22it/s]
 51%|█████▏    | 79/154 [00:18<00:17,  4.29it/s]
 52%|█████▏    | 80/154 [00:18<00:17,  4.13it/s]
 53%|█████▎    | 81/154 [00:18<00:16,  4.31it/s]
 53%|█████▎    | 82/154 [00:19<00:16,  4.38it/s]
 54%|█████▍    | 83/154 [00:19<00:16,  4.22it/s]
 55%|█████▍    | 84/154 [00:19<00:16,  4.27it/s]
 55%|█████▌    | 85/154 [00:19<00:15,  4.43it/s]
 56%|█████▌    | 86/154 [00:20<00:15,  4.33it/s]
 56%|█████▋    | 87/154 [00:20<00:15,  4.33it/s]
 57%|█████▋    | 88/154 [00:20<00:15,  4.21it/s]
 58%|█████▊    | 89/154 [00:20<00:15,  4.22it/s]
 58%|█████▊    | 90/154 [00:20<00:14,  4.32it/s]
 59%|█████▉    | 91/154 [00:21<00:14,  4.33it/s]
 60%|█████▉    | 92/154 [00:21<00:15,  3.95it/s]
 60%|██████    | 93/154 [00:21<00:15,  3.99it/s]
 61%|██████    | 94/154 [00:22<00:15,  3.92it/s]
 62%|██████▏   | 95/154 [00:22<00:15,  3.93it/s]
 62%|██████▏   | 96/154 [00:22<00:14,  3.94it/s]
 63%|██████▎   | 97/154 [00:22<00:14,  4.01it/s]
 64%|██████▎   | 98/154 [00:22<00:13,  4.16it/s]
 64%|██████▍   | 99/154 [00:23<00:13,  4.11it/s]
 65%|██████▍   | 100/154 [00:23<00:13,  4.07it/s]
 66%|██████▌   | 101/154 [00:23<00:12,  4.16it/s]
 66%|██████▌   | 102/154 [00:23<00:12,  4.28it/s]
 67%|██████▋   | 103/154 [00:24<00:11,  4.28it/s]
 68%|██████▊   | 104/154 [00:24<00:11,  4.28it/s]
 68%|██████▊   | 105/154 [00:24<00:11,  4.29it/s]
 69%|██████▉   | 106/154 [00:24<00:11,  4.36it/s]
 69%|██████▉   | 107/154 [00:25<00:10,  4.31it/s]
 70%|███████   | 108/154 [00:25<00:11,  4.18it/s]
 71%|███████   | 109/154 [00:25<00:10,  4.29it/s]
 71%|███████▏  | 110/154 [00:25<00:10,  4.17it/s]
 72%|███████▏  | 111/154 [00:26<00:10,  4.26it/s]
 73%|███████▎  | 112/154 [00:26<00:09,  4.21it/s]
 73%|███████▎  | 113/154 [00:26<00:09,  4.24it/s]
 74%|███████▍  | 114/154 [00:26<00:09,  4.32it/s]
 75%|███████▍  | 115/154 [00:26<00:09,  4.32it/s]
 75%|███████▌  | 116/154 [00:27<00:08,  4.33it/s]
 76%|███████▌  | 117/154 [00:27<00:08,  4.38it/s]
 77%|███████▋  | 118/154 [00:27<00:08,  4.36it/s]
 77%|███████▋  | 119/154 [00:27<00:07,  4.42it/s]
 78%|███████▊  | 120/154 [00:28<00:07,  4.54it/s]
 79%|███████▊  | 121/154 [00:28<00:07,  4.53it/s]
 79%|███████▉  | 122/154 [00:28<00:07,  4.54it/s]
 80%|███████▉  | 123/154 [00:28<00:07,  4.34it/s]
 81%|████████  | 124/154 [00:29<00:06,  4.31it/s]
 81%|████████  | 125/154 [00:29<00:06,  4.39it/s]
 82%|████████▏ | 126/154 [00:29<00:06,  4.24it/s]
 82%|████████▏ | 127/154 [00:29<00:06,  4.27it/s]
 83%|████████▎ | 128/154 [00:29<00:06,  4.04it/s]
 84%|████████▍ | 129/154 [00:30<00:06,  4.13it/s]
 84%|████████▍ | 130/154 [00:30<00:05,  4.17it/s]
 85%|████████▌ | 131/154 [00:30<00:05,  4.21it/s]
 86%|████████▌ | 132/154 [00:30<00:05,  4.32it/s]
 86%|████████▋ | 133/154 [00:31<00:04,  4.26it/s]
 87%|████████▋ | 134/154 [00:31<00:04,  4.08it/s]
 88%|████████▊ | 135/154 [00:31<00:04,  4.16it/s]
 88%|████████▊ | 136/154 [00:31<00:04,  4.32it/s]
 89%|████████▉ | 137/154 [00:32<00:03,  4.36it/s]
 90%|████████▉ | 138/154 [00:32<00:03,  4.49it/s]
 90%|█████████ | 139/154 [00:32<00:03,  4.50it/s]
 91%|█████████ | 140/154 [00:32<00:03,  4.38it/s]
 92%|█████████▏| 141/154 [00:32<00:03,  4.32it/s]
 92%|█████████▏| 142/154 [00:33<00:02,  4.33it/s]
 93%|█████████▎| 143/154 [00:33<00:02,  4.34it/s]
 94%|█████████▎| 144/154 [00:33<00:02,  4.26it/s]
 94%|█████████▍| 145/154 [00:33<00:02,  4.42it/s]
 95%|█████████▍| 146/154 [00:34<00:01,  4.39it/s]
 95%|█████████▌| 147/154 [00:34<00:01,  4.25it/s]
 96%|█████████▌| 148/154 [00:34<00:01,  4.16it/s]
 97%|█████████▋| 149/154 [00:34<00:01,  4.31it/s]
 97%|█████████▋| 150/154 [00:35<00:00,  4.32it/s]
 98%|█████████▊| 151/154 [00:35<00:00,  4.21it/s]
 99%|█████████▊| 152/154 [00:35<00:00,  4.39it/s]
 99%|█████████▉| 153/154 [00:35<00:00,  4.26it/s]
100%|██████████| 154/154 [00:35<00:00,  4.28it/s]
+-------+------------------------+---------------------+-------------+-------------+-----------+----------+
| epoch |           lr           |      train_loss     | val_top1acc | val_top3acc | val_ndcg1 | val_mrr3 |
+-------+------------------------+---------------------+-------------+-------------+-----------+----------+
|   0   | 1.0000000000000023e-05 |  2.2853724935689868 |    43.42    |    76.27    |   67.87   |  57.81   |
|   1   |  9.99112027792722e-06  |  1.5891911364018136 |    52.55    |    82.72    |   74.75   |  66.10   |
|   2   | 9.964516155915175e-06  |  1.2577084753190586 |    58.79    |    87.16    |   78.59   |  71.44   |
|   3   | 9.920292628279128e-06  |  1.0084300179148344 |    61.43    |    88.79    |   80.23   |  73.58   |
|   4   | 9.858624225078883e-06  |  0.793933470176297  |    63.23    |    88.79    |   81.15   |  74.64   |
|   5   | 9.779754323328173e-06  |  0.6315311710126535 |    63.55    |    89.32    |   81.46   |  75.15   |
|   6   | 9.683994186497118e-06  |  0.5157908185600714 |    63.80    |    89.20    |   81.63   |  75.24   |
|   7   | 9.571721736097036e-06  | 0.40289456732408446 |    63.31    |    89.32    |   81.43   |  74.94   |
+-------+------------------------+---------------------+-------------+-------------+-----------+----------+
/ceph/hpc/home/eujongc/anaconda3/envs/latentops/lib/python3.9/site-packages/torch/utils/data/dataloader.py:554: UserWarning: This DataLoader will create 4 worker processes in total. Our suggested max number of worker in current system is 2, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(_create_warning_msg(
Train Epoch: [8]  [  0/229]  eta: 0:05:23  lr: 0.000009  loss: 0.2878  time: 1.4127  data: 0.1055  max mem: 30242
Train Epoch: [8]  [ 50/229]  eta: 0:03:27  lr: 0.000009  loss: 0.3318  time: 1.1515  data: 0.0001  max mem: 30242
Train Epoch: [8]  [100/229]  eta: 0:02:28  lr: 0.000009  loss: 0.3400  time: 1.1654  data: 0.0001  max mem: 30404
Train Epoch: [8]  [150/229]  eta: 0:01:31  lr: 0.000009  loss: 0.3515  time: 1.1512  data: 0.0001  max mem: 30404
Train Epoch: [8]  [200/229]  eta: 0:00:33  lr: 0.000009  loss: 0.4792  time: 1.1510  data: 0.0001  max mem: 30404
Train Epoch: [8]  [228/229]  eta: 0:00:01  lr: 0.000009  loss: 0.2651  time: 1.1688  data: 0.0001  max mem: 30404
2023-07-10 16:59:26,197 Train Epoch: [8] Total time: 0:04:23 (1.1518 s / it)
2023-07-10 16:59:26,200 Computing features for evaluation...

  0%|          | 0/154 [00:00<?, ?it/s]
  1%|          | 1/154 [00:00<00:51,  2.95it/s]
  1%|▏         | 2/154 [00:00<00:41,  3.70it/s]
  2%|▏         | 3/154 [00:00<00:38,  3.96it/s]
  3%|▎         | 4/154 [00:01<00:36,  4.12it/s]
  3%|▎         | 5/154 [00:01<00:36,  4.05it/s]
  4%|▍         | 6/154 [00:01<00:35,  4.20it/s]
  5%|▍         | 7/154 [00:01<00:33,  4.43it/s]
  5%|▌         | 8/154 [00:01<00:33,  4.34it/s]
  6%|▌         | 9/154 [00:02<00:33,  4.27it/s]
  6%|▋         | 10/154 [00:02<00:33,  4.36it/s]
  7%|▋         | 11/154 [00:02<00:33,  4.21it/s]
  8%|▊         | 12/154 [00:02<00:33,  4.19it/s]
  8%|▊         | 13/154 [00:03<00:33,  4.24it/s]
  9%|▉         | 14/154 [00:03<00:33,  4.20it/s]
 10%|▉         | 15/154 [00:03<00:32,  4.23it/s]
 10%|█         | 16/154 [00:03<00:31,  4.35it/s]
 11%|█         | 17/154 [00:04<00:31,  4.33it/s]
 12%|█▏        | 18/154 [00:04<00:31,  4.33it/s]
 12%|█▏        | 19/154 [00:04<00:32,  4.18it/s]
 13%|█▎        | 20/154 [00:04<00:32,  4.17it/s]
 14%|█▎        | 21/154 [00:04<00:30,  4.30it/s]
 14%|█▍        | 22/154 [00:05<00:29,  4.43it/s]
 15%|█▍        | 23/154 [00:05<00:29,  4.48it/s]
 16%|█▌        | 24/154 [00:05<00:29,  4.44it/s]
 16%|█▌        | 25/154 [00:05<00:29,  4.43it/s]
 17%|█▋        | 26/154 [00:06<00:29,  4.39it/s]
 18%|█▊        | 27/154 [00:06<00:28,  4.46it/s]
 18%|█▊        | 28/154 [00:06<00:28,  4.36it/s]
 19%|█▉        | 29/154 [00:06<00:28,  4.43it/s]
 19%|█▉        | 30/154 [00:07<00:27,  4.48it/s]
 20%|██        | 31/154 [00:07<00:27,  4.43it/s]
 21%|██        | 32/154 [00:07<00:27,  4.48it/s]
 21%|██▏       | 33/154 [00:07<00:27,  4.44it/s]
 22%|██▏       | 34/154 [00:07<00:27,  4.33it/s]
 23%|██▎       | 35/154 [00:08<00:27,  4.39it/s]
 23%|██▎       | 36/154 [00:08<00:26,  4.37it/s]
 24%|██▍       | 37/154 [00:08<00:26,  4.34it/s]
 25%|██▍       | 38/154 [00:08<00:26,  4.38it/s]
 25%|██▌       | 39/154 [00:09<00:25,  4.44it/s]
 26%|██▌       | 40/154 [00:09<00:25,  4.42it/s]
 27%|██▋       | 41/154 [00:09<00:26,  4.25it/s]
 27%|██▋       | 42/154 [00:09<00:26,  4.21it/s]
 28%|██▊       | 43/154 [00:10<00:26,  4.19it/s]
 29%|██▊       | 44/154 [00:10<00:25,  4.39it/s]
 29%|██▉       | 45/154 [00:10<00:25,  4.30it/s]
 30%|██▉       | 46/154 [00:10<00:24,  4.39it/s]
 31%|███       | 47/154 [00:10<00:24,  4.38it/s]
 31%|███       | 48/154 [00:11<00:24,  4.42it/s]
 32%|███▏      | 49/154 [00:11<00:23,  4.38it/s]
 32%|███▏      | 50/154 [00:11<00:24,  4.31it/s]
 33%|███▎      | 51/154 [00:11<00:23,  4.38it/s]
 34%|███▍      | 52/154 [00:12<00:23,  4.29it/s]
 34%|███▍      | 53/154 [00:12<00:23,  4.26it/s]
 35%|███▌      | 54/154 [00:12<00:22,  4.35it/s]
 36%|███▌      | 55/154 [00:12<00:23,  4.30it/s]
 36%|███▋      | 56/154 [00:13<00:23,  4.26it/s]
 37%|███▋      | 57/154 [00:13<00:22,  4.37it/s]
 38%|███▊      | 58/154 [00:13<00:22,  4.35it/s]
 38%|███▊      | 59/154 [00:13<00:21,  4.39it/s]
 39%|███▉      | 60/154 [00:13<00:22,  4.25it/s]
 40%|███▉      | 61/154 [00:14<00:21,  4.26it/s]
 40%|████      | 62/154 [00:14<00:21,  4.29it/s]
 41%|████      | 63/154 [00:14<00:21,  4.30it/s]
 42%|████▏     | 64/154 [00:14<00:20,  4.38it/s]
 42%|████▏     | 65/154 [00:15<00:21,  4.19it/s]
 43%|████▎     | 66/154 [00:15<00:21,  4.10it/s]
 44%|████▎     | 67/154 [00:15<00:21,  4.11it/s]
 44%|████▍     | 68/154 [00:15<00:20,  4.23it/s]
 45%|████▍     | 69/154 [00:16<00:19,  4.26it/s]
 45%|████▌     | 70/154 [00:16<00:19,  4.36it/s]
 46%|████▌     | 71/154 [00:16<00:19,  4.34it/s]
 47%|████▋     | 72/154 [00:16<00:19,  4.27it/s]
 47%|████▋     | 73/154 [00:16<00:18,  4.28it/s]
 48%|████▊     | 74/154 [00:17<00:18,  4.29it/s]
 49%|████▊     | 75/154 [00:17<00:18,  4.29it/s]
 49%|████▉     | 76/154 [00:17<00:18,  4.15it/s]
 50%|█████     | 77/154 [00:17<00:18,  4.26it/s]
 51%|█████     | 78/154 [00:18<00:17,  4.22it/s]
 51%|█████▏    | 79/154 [00:18<00:17,  4.29it/s]
 52%|█████▏    | 80/154 [00:18<00:17,  4.13it/s]
 53%|█████▎    | 81/154 [00:18<00:16,  4.31it/s]
 53%|█████▎    | 82/154 [00:19<00:16,  4.39it/s]
 54%|█████▍    | 83/154 [00:19<00:16,  4.23it/s]
 55%|█████▍    | 84/154 [00:19<00:16,  4.28it/s]
 55%|█████▌    | 85/154 [00:19<00:15,  4.43it/s]
 56%|█████▌    | 86/154 [00:20<00:15,  4.34it/s]
 56%|█████▋    | 87/154 [00:20<00:15,  4.33it/s]
 57%|█████▋    | 88/154 [00:20<00:15,  4.21it/s]
 58%|█████▊    | 89/154 [00:20<00:15,  4.22it/s]
 58%|█████▊    | 90/154 [00:20<00:14,  4.32it/s]
 59%|█████▉    | 91/154 [00:21<00:14,  4.32it/s]
 60%|█████▉    | 92/154 [00:21<00:15,  3.95it/s]
 60%|██████    | 93/154 [00:21<00:15,  3.99it/s]
 61%|██████    | 94/154 [00:22<00:15,  3.92it/s]
 62%|██████▏   | 95/154 [00:22<00:15,  3.93it/s]
 62%|██████▏   | 96/154 [00:22<00:14,  3.94it/s]
 63%|██████▎   | 97/154 [00:22<00:14,  4.01it/s]
 64%|██████▎   | 98/154 [00:22<00:13,  4.17it/s]
 64%|██████▍   | 99/154 [00:23<00:13,  4.12it/s]
 65%|██████▍   | 100/154 [00:23<00:13,  4.07it/s]
 66%|██████▌   | 101/154 [00:23<00:12,  4.16it/s]
 66%|██████▌   | 102/154 [00:23<00:12,  4.29it/s]
 67%|██████▋   | 103/154 [00:24<00:11,  4.29it/s]
 68%|██████▊   | 104/154 [00:24<00:11,  4.30it/s]
 68%|██████▊   | 105/154 [00:24<00:11,  4.30it/s]
 69%|██████▉   | 106/154 [00:24<00:11,  4.36it/s]
 69%|██████▉   | 107/154 [00:25<00:10,  4.32it/s]
 70%|███████   | 108/154 [00:25<00:11,  4.18it/s]
 71%|███████   | 109/154 [00:25<00:10,  4.30it/s]
 71%|███████▏  | 110/154 [00:25<00:10,  4.17it/s]
 72%|███████▏  | 111/154 [00:26<00:10,  4.26it/s]
 73%|███████▎  | 112/154 [00:26<00:09,  4.22it/s]
 73%|███████▎  | 113/154 [00:26<00:09,  4.26it/s]
 74%|███████▍  | 114/154 [00:26<00:09,  4.34it/s]
 75%|███████▍  | 115/154 [00:26<00:08,  4.35it/s]
 75%|███████▌  | 116/154 [00:27<00:08,  4.36it/s]
 76%|███████▌  | 117/154 [00:27<00:08,  4.40it/s]
 77%|███████▋  | 118/154 [00:27<00:08,  4.37it/s]
 77%|███████▋  | 119/154 [00:27<00:07,  4.43it/s]
 78%|███████▊  | 120/154 [00:28<00:07,  4.56it/s]
 79%|███████▊  | 121/154 [00:28<00:07,  4.54it/s]
 79%|███████▉  | 122/154 [00:28<00:07,  4.55it/s]
 80%|███████▉  | 123/154 [00:28<00:07,  4.34it/s]
 81%|████████  | 124/154 [00:28<00:06,  4.31it/s]
 81%|████████  | 125/154 [00:29<00:06,  4.39it/s]
 82%|████████▏ | 126/154 [00:29<00:06,  4.25it/s]
 82%|████████▏ | 127/154 [00:29<00:06,  4.27it/s]
 83%|████████▎ | 128/154 [00:29<00:06,  4.04it/s]
 84%|████████▍ | 129/154 [00:30<00:06,  4.13it/s]
 84%|████████▍ | 130/154 [00:30<00:05,  4.17it/s]
 85%|████████▌ | 131/154 [00:30<00:05,  4.21it/s]
 86%|████████▌ | 132/154 [00:30<00:05,  4.32it/s]
 86%|████████▋ | 133/154 [00:31<00:04,  4.26it/s]
 87%|████████▋ | 134/154 [00:31<00:04,  4.08it/s]
 88%|████████▊ | 135/154 [00:31<00:04,  4.16it/s]
 88%|████████▊ | 136/154 [00:31<00:04,  4.32it/s]
 89%|████████▉ | 137/154 [00:32<00:03,  4.37it/s]
 90%|████████▉ | 138/154 [00:32<00:03,  4.50it/s]
 90%|█████████ | 139/154 [00:32<00:03,  4.51it/s]
 91%|█████████ | 140/154 [00:32<00:03,  4.39it/s]
 92%|█████████▏| 141/154 [00:32<00:03,  4.32it/s]
 92%|█████████▏| 142/154 [00:33<00:02,  4.33it/s]
 93%|█████████▎| 143/154 [00:33<00:02,  4.34it/s]
 94%|█████████▎| 144/154 [00:33<00:02,  4.25it/s]
 94%|█████████▍| 145/154 [00:33<00:02,  4.41it/s]
 95%|█████████▍| 146/154 [00:34<00:01,  4.39it/s]
 95%|█████████▌| 147/154 [00:34<00:01,  4.25it/s]
 96%|█████████▌| 148/154 [00:34<00:01,  4.17it/s]
 97%|█████████▋| 149/154 [00:34<00:01,  4.31it/s]
 97%|█████████▋| 150/154 [00:35<00:01,  3.55it/s]
 98%|█████████▊| 151/154 [00:35<00:00,  3.66it/s]
 99%|█████████▊| 152/154 [00:35<00:00,  3.96it/s]
 99%|█████████▉| 153/154 [00:35<00:00,  3.97it/s]
100%|██████████| 154/154 [00:36<00:00,  4.27it/s]
2023-07-10 17:00:03,639 Computing features for evaluation...

  0%|          | 0/155 [00:00<?, ?it/s]/ceph/hpc/home/eujongc/anaconda3/envs/latentops/lib/python3.9/site-packages/torch/utils/data/dataloader.py:554: UserWarning: This DataLoader will create 4 worker processes in total. Our suggested max number of worker in current system is 2, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(_create_warning_msg(

  1%|          | 1/155 [00:00<00:50,  3.04it/s]
  1%|▏         | 2/155 [00:00<00:40,  3.77it/s]
  2%|▏         | 3/155 [00:00<00:37,  4.04it/s]
  3%|▎         | 4/155 [00:01<00:39,  3.78it/s]
  3%|▎         | 5/155 [00:01<00:39,  3.84it/s]
  4%|▍         | 6/155 [00:01<00:36,  4.06it/s]
  5%|▍         | 7/155 [00:01<00:36,  4.10it/s]
  5%|▌         | 8/155 [00:02<00:35,  4.18it/s]
  6%|▌         | 9/155 [00:02<00:34,  4.21it/s]
  6%|▋         | 10/155 [00:02<00:34,  4.26it/s]
  7%|▋         | 11/155 [00:02<00:34,  4.15it/s]
  8%|▊         | 12/155 [00:02<00:33,  4.22it/s]
  8%|▊         | 13/155 [00:03<00:34,  4.17it/s]
  9%|▉         | 14/155 [00:03<00:34,  4.10it/s]
 10%|▉         | 15/155 [00:03<00:34,  4.00it/s]
 10%|█         | 16/155 [00:03<00:32,  4.22it/s]
 11%|█         | 17/155 [00:04<00:33,  4.17it/s]
 12%|█▏        | 18/155 [00:04<00:33,  4.09it/s]
 12%|█▏        | 19/155 [00:04<00:32,  4.23it/s]
 13%|█▎        | 20/155 [00:04<00:32,  4.18it/s]
 14%|█▎        | 21/155 [00:05<00:31,  4.29it/s]
 14%|█▍        | 22/155 [00:05<00:29,  4.44it/s]
 15%|█▍        | 23/155 [00:05<00:30,  4.39it/s]
 15%|█▌        | 24/155 [00:05<00:30,  4.31it/s]
 16%|█▌        | 25/155 [00:06<00:29,  4.39it/s]
 17%|█▋        | 26/155 [00:06<00:30,  4.23it/s]
 17%|█▋        | 27/155 [00:06<00:30,  4.26it/s]
 18%|█▊        | 28/155 [00:06<00:29,  4.34it/s]
 19%|█▊        | 29/155 [00:06<00:29,  4.21it/s]
 19%|█▉        | 30/155 [00:07<00:30,  4.13it/s]
 20%|██        | 31/155 [00:07<00:30,  4.08it/s]
 21%|██        | 32/155 [00:07<00:29,  4.21it/s]
 21%|██▏       | 33/155 [00:07<00:28,  4.25it/s]
 22%|██▏       | 34/155 [00:08<00:28,  4.22it/s]
 23%|██▎       | 35/155 [00:08<00:28,  4.18it/s]
 23%|██▎       | 36/155 [00:08<00:28,  4.13it/s]
 24%|██▍       | 37/155 [00:08<00:29,  4.01it/s]
 25%|██▍       | 38/155 [00:09<00:28,  4.09it/s]
 25%|██▌       | 39/155 [00:09<00:27,  4.17it/s]
 26%|██▌       | 40/155 [00:09<00:26,  4.29it/s]
 26%|██▋       | 41/155 [00:09<00:27,  4.16it/s]
 27%|██▋       | 42/155 [00:10<00:26,  4.24it/s]
 28%|██▊       | 43/155 [00:10<00:26,  4.22it/s]
 28%|██▊       | 44/155 [00:10<00:26,  4.20it/s]
 29%|██▉       | 45/155 [00:10<00:25,  4.32it/s]
 30%|██▉       | 46/155 [00:11<00:26,  4.19it/s]
 30%|███       | 47/155 [00:11<00:25,  4.17it/s]
 31%|███       | 48/155 [00:11<00:25,  4.16it/s]
 32%|███▏      | 49/155 [00:11<00:24,  4.28it/s]
 32%|███▏      | 50/155 [00:11<00:25,  4.19it/s]
 33%|███▎      | 51/155 [00:12<00:24,  4.17it/s]
 34%|███▎      | 52/155 [00:12<00:25,  4.03it/s]
 34%|███▍      | 53/155 [00:12<00:24,  4.09it/s]
 35%|███▍      | 54/155 [00:12<00:23,  4.24it/s]
 35%|███▌      | 55/155 [00:13<00:23,  4.27it/s]
 36%|███▌      | 56/155 [00:13<00:23,  4.28it/s]
 37%|███▋      | 57/155 [00:13<00:23,  4.23it/s]
 37%|███▋      | 58/155 [00:13<00:23,  4.20it/s]
 38%|███▊      | 59/155 [00:14<00:22,  4.22it/s]
 39%|███▊      | 60/155 [00:14<00:21,  4.34it/s]
 39%|███▉      | 61/155 [00:14<00:23,  4.07it/s]
 40%|████      | 62/155 [00:14<00:22,  4.17it/s]
 41%|████      | 63/155 [00:15<00:21,  4.22it/s]
 41%|████▏     | 64/155 [00:15<00:21,  4.24it/s]
 42%|████▏     | 65/155 [00:15<00:20,  4.39it/s]
 43%|████▎     | 66/155 [00:15<00:20,  4.28it/s]
 43%|████▎     | 67/155 [00:15<00:20,  4.36it/s]
 44%|████▍     | 68/155 [00:16<00:19,  4.45it/s]
 45%|████▍     | 69/155 [00:16<00:19,  4.36it/s]
 45%|████▌     | 70/155 [00:16<00:19,  4.29it/s]
 46%|████▌     | 71/155 [00:16<00:19,  4.30it/s]
 46%|████▋     | 72/155 [00:17<00:20,  4.00it/s]
 47%|████▋     | 73/155 [00:17<00:21,  3.80it/s]
 48%|████▊     | 74/155 [00:17<00:20,  3.89it/s]
 48%|████▊     | 75/155 [00:17<00:19,  4.02it/s]
 49%|████▉     | 76/155 [00:18<00:19,  4.11it/s]
 50%|████▉     | 77/155 [00:18<00:18,  4.11it/s]
 50%|█████     | 78/155 [00:18<00:18,  4.13it/s]
 51%|█████     | 79/155 [00:18<00:17,  4.30it/s]
 52%|█████▏    | 80/155 [00:19<00:16,  4.45it/s]
 52%|█████▏    | 81/155 [00:19<00:17,  4.28it/s]
 53%|█████▎    | 82/155 [00:19<00:17,  4.29it/s]
 54%|█████▎    | 83/155 [00:19<00:17,  4.12it/s]
 54%|█████▍    | 84/155 [00:20<00:16,  4.23it/s]
 55%|█████▍    | 85/155 [00:20<00:16,  4.26it/s]
 55%|█████▌    | 86/155 [00:20<00:16,  4.29it/s]
 56%|█████▌    | 87/155 [00:20<00:15,  4.35it/s]
 57%|█████▋    | 88/155 [00:20<00:15,  4.42it/s]
 57%|█████▋    | 89/155 [00:21<00:14,  4.53it/s]
 58%|█████▊    | 90/155 [00:21<00:14,  4.48it/s]
 59%|█████▊    | 91/155 [00:21<00:14,  4.42it/s]
 59%|█████▉    | 92/155 [00:21<00:14,  4.47it/s]
 60%|██████    | 93/155 [00:22<00:13,  4.55it/s]
 61%|██████    | 94/155 [00:22<00:13,  4.52it/s]
 61%|██████▏   | 95/155 [00:22<00:13,  4.46it/s]
 62%|██████▏   | 96/155 [00:22<00:13,  4.36it/s]
 63%|██████▎   | 97/155 [00:22<00:13,  4.42it/s]
 63%|██████▎   | 98/155 [00:23<00:13,  4.34it/s]
 64%|██████▍   | 99/155 [00:23<00:12,  4.41it/s]
 65%|██████▍   | 100/155 [00:23<00:12,  4.31it/s]
 65%|██████▌   | 101/155 [00:23<00:12,  4.32it/s]
 66%|██████▌   | 102/155 [00:24<00:12,  4.33it/s]
 66%|██████▋   | 103/155 [00:24<00:12,  4.20it/s]
 67%|██████▋   | 104/155 [00:24<00:12,  4.23it/s]
 68%|██████▊   | 105/155 [00:24<00:11,  4.24it/s]
 68%|██████▊   | 106/155 [00:25<00:11,  4.21it/s]
 69%|██████▉   | 107/155 [00:25<00:11,  4.26it/s]
 70%|██████▉   | 108/155 [00:25<00:11,  4.22it/s]
 70%|███████   | 109/155 [00:25<00:10,  4.27it/s]
 71%|███████   | 110/155 [00:26<00:10,  4.28it/s]
 72%|███████▏  | 111/155 [00:26<00:09,  4.43it/s]
 72%|███████▏  | 112/155 [00:26<00:09,  4.34it/s]
 73%|███████▎  | 113/155 [00:26<00:09,  4.32it/s]
 74%|███████▎  | 114/155 [00:27<00:09,  4.14it/s]
 74%|███████▍  | 115/155 [00:27<00:09,  4.07it/s]
 75%|███████▍  | 116/155 [00:27<00:09,  4.21it/s]
 75%|███████▌  | 117/155 [00:27<00:09,  4.18it/s]
 76%|███████▌  | 118/155 [00:27<00:08,  4.36it/s]
 77%|███████▋  | 119/155 [00:28<00:08,  4.03it/s]
 77%|███████▋  | 120/155 [00:28<00:08,  4.12it/s]
 78%|███████▊  | 121/155 [00:28<00:08,  4.01it/s]
 79%|███████▊  | 122/155 [00:28<00:08,  4.10it/s]
 79%|███████▉  | 123/155 [00:29<00:07,  4.16it/s]
 80%|████████  | 124/155 [00:29<00:07,  4.08it/s]
 81%|████████  | 125/155 [00:29<00:07,  4.24it/s]
 81%|████████▏ | 126/155 [00:29<00:06,  4.24it/s]
 82%|████████▏ | 127/155 [00:30<00:06,  4.36it/s]
 83%|████████▎ | 128/155 [00:30<00:06,  4.22it/s]
 83%|████████▎ | 129/155 [00:30<00:06,  4.10it/s]
 84%|████████▍ | 130/155 [00:30<00:06,  4.05it/s]
 85%|████████▍ | 131/155 [00:31<00:06,  3.97it/s]
 85%|████████▌ | 132/155 [00:31<00:05,  4.14it/s]
 86%|████████▌ | 133/155 [00:31<00:05,  4.20it/s]
 86%|████████▋ | 134/155 [00:31<00:05,  4.12it/s]
 87%|████████▋ | 135/155 [00:32<00:04,  4.21it/s]
 88%|████████▊ | 136/155 [00:32<00:04,  4.29it/s]
 88%|████████▊ | 137/155 [00:32<00:04,  4.38it/s]
 89%|████████▉ | 138/155 [00:32<00:04,  4.25it/s]
 90%|████████▉ | 139/155 [00:32<00:03,  4.21it/s]
 90%|█████████ | 140/155 [00:33<00:03,  4.20it/s]
 91%|█████████ | 141/155 [00:33<00:03,  4.17it/s]
 92%|█████████▏| 142/155 [00:33<00:03,  4.29it/s]
 92%|█████████▏| 143/155 [00:33<00:02,  4.40it/s]
 93%|█████████▎| 144/155 [00:34<00:02,  4.18it/s]
 94%|█████████▎| 145/155 [00:34<00:02,  4.20it/s]
 94%|█████████▍| 146/155 [00:34<00:02,  4.30it/s]
 95%|█████████▍| 147/155 [00:34<00:01,  4.31it/s]
 95%|█████████▌| 148/155 [00:35<00:01,  4.40it/s]
 96%|█████████▌| 149/155 [00:35<00:01,  4.33it/s]
 97%|█████████▋| 150/155 [00:35<00:01,  4.38it/s]
 97%|█████████▋| 151/155 [00:35<00:00,  4.43it/s]
 98%|█████████▊| 152/155 [00:35<00:00,  4.51it/s]
 99%|█████████▊| 153/155 [00:36<00:00,  4.49it/s]
 99%|█████████▉| 154/155 [00:36<00:00,  4.17it/s]
100%|██████████| 155/155 [00:36<00:00,  4.23it/s]
+-------+------------------------+---------------------+-------------+-------------+-----------+----------+
| epoch |           lr           |      train_loss     | val_top1acc | val_top3acc | val_ndcg1 | val_mrr3 |
+-------+------------------------+---------------------+-------------+-------------+-----------+----------+
|   0   | 1.0000000000000023e-05 |  2.2853724935689868 |    43.42    |    76.27    |   67.87   |  57.81   |
|   1   |  9.99112027792722e-06  |  1.5891911364018136 |    52.55    |    82.72    |   74.75   |  66.10   |
|   2   | 9.964516155915175e-06  |  1.2577084753190586 |    58.79    |    87.16    |   78.59   |  71.44   |
|   3   | 9.920292628279128e-06  |  1.0084300179148344 |    61.43    |    88.79    |   80.23   |  73.58   |
|   4   | 9.858624225078883e-06  |  0.793933470176297  |    63.23    |    88.79    |   81.15   |  74.64   |
|   5   | 9.779754323328173e-06  |  0.6315311710126535 |    63.55    |    89.32    |   81.46   |  75.15   |
|   6   | 9.683994186497118e-06  |  0.5157908185600714 |    63.80    |    89.20    |   81.63   |  75.24   |
|   7   | 9.571721736097036e-06  | 0.40289456732408446 |    63.31    |    89.32    |   81.43   |  74.94   |
|   8   | 9.443380060197365e-06  | 0.33164142270666025 |    63.84    |    89.40    |   81.70   |  75.28   |
+-------+------------------------+---------------------+-------------+-------------+-----------+----------+
/ceph/hpc/home/eujongc/anaconda3/envs/latentops/lib/python3.9/site-packages/torch/utils/data/dataloader.py:554: UserWarning: This DataLoader will create 4 worker processes in total. Our suggested max number of worker in current system is 2, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(_create_warning_msg(
Train Epoch: [9]  [  0/229]  eta: 0:04:46  lr: 0.000009  loss: 0.2457  time: 1.2508  data: 0.0937  max mem: 30404
Train Epoch: [9]  [ 50/229]  eta: 0:03:24  lr: 0.000009  loss: 0.2221  time: 1.1280  data: 0.0001  max mem: 30404
Train Epoch: [9]  [100/229]  eta: 0:02:27  lr: 0.000009  loss: 0.1462  time: 1.1857  data: 0.0001  max mem: 30404
Train Epoch: [9]  [150/229]  eta: 0:01:30  lr: 0.000009  loss: 0.3292  time: 1.1295  data: 0.0001  max mem: 30404
Train Epoch: [9]  [200/229]  eta: 0:00:33  lr: 0.000009  loss: 0.2603  time: 1.1442  data: 0.0001  max mem: 30404
Train Epoch: [9]  [228/229]  eta: 0:00:01  lr: 0.000009  loss: 0.1740  time: 1.1674  data: 0.0001  max mem: 30404
2023-07-10 17:05:03,448 Train Epoch: [9] Total time: 0:04:22 (1.1473 s / it)
2023-07-10 17:05:03,452 Computing features for evaluation...

  0%|          | 0/154 [00:00<?, ?it/s]
  1%|          | 1/154 [00:00<00:53,  2.85it/s]
  1%|▏         | 2/154 [00:00<00:41,  3.63it/s]
  2%|▏         | 3/154 [00:00<00:38,  3.93it/s]
  3%|▎         | 4/154 [00:01<00:36,  4.12it/s]
  3%|▎         | 5/154 [00:01<00:36,  4.08it/s]
  4%|▍         | 6/154 [00:01<00:34,  4.24it/s]
  5%|▍         | 7/154 [00:01<00:33,  4.45it/s]
  5%|▌         | 8/154 [00:01<00:33,  4.35it/s]
  6%|▌         | 9/154 [00:02<00:33,  4.28it/s]
  6%|▋         | 10/154 [00:02<00:32,  4.37it/s]
  7%|▋         | 11/154 [00:02<00:33,  4.22it/s]
  8%|▊         | 12/154 [00:02<00:33,  4.19it/s]
  8%|▊         | 13/154 [00:03<00:33,  4.24it/s]
  9%|▉         | 14/154 [00:03<00:33,  4.20it/s]
 10%|▉         | 15/154 [00:03<00:32,  4.23it/s]
 10%|█         | 16/154 [00:03<00:31,  4.34it/s]
 11%|█         | 17/154 [00:04<00:31,  4.33it/s]
 12%|█▏        | 18/154 [00:04<00:31,  4.33it/s]
 12%|█▏        | 19/154 [00:04<00:32,  4.18it/s]
 13%|█▎        | 20/154 [00:04<00:32,  4.17it/s]
 14%|█▎        | 21/154 [00:04<00:30,  4.30it/s]
 14%|█▍        | 22/154 [00:05<00:29,  4.42it/s]
 15%|█▍        | 23/154 [00:05<00:29,  4.47it/s]
 16%|█▌        | 24/154 [00:05<00:29,  4.44it/s]
 16%|█▌        | 25/154 [00:05<00:29,  4.42it/s]
 17%|█▋        | 26/154 [00:06<00:29,  4.39it/s]
 18%|█▊        | 27/154 [00:06<00:28,  4.46it/s]
 18%|█▊        | 28/154 [00:06<00:28,  4.37it/s]
 19%|█▉        | 29/154 [00:06<00:28,  4.43it/s]
 19%|█▉        | 30/154 [00:07<00:27,  4.48it/s]
 20%|██        | 31/154 [00:07<00:27,  4.43it/s]
 21%|██        | 32/154 [00:07<00:27,  4.47it/s]
 21%|██▏       | 33/154 [00:07<00:27,  4.43it/s]
 22%|██▏       | 34/154 [00:07<00:27,  4.32it/s]
 23%|██▎       | 35/154 [00:08<00:27,  4.38it/s]
 23%|██▎       | 36/154 [00:08<00:27,  4.37it/s]
 24%|██▍       | 37/154 [00:08<00:26,  4.33it/s]
 25%|██▍       | 38/154 [00:08<00:26,  4.39it/s]
 25%|██▌       | 39/154 [00:09<00:25,  4.45it/s]
 26%|██▌       | 40/154 [00:09<00:25,  4.42it/s]
 27%|██▋       | 41/154 [00:09<00:26,  4.25it/s]
 27%|██▋       | 42/154 [00:09<00:26,  4.21it/s]
 28%|██▊       | 43/154 [00:10<00:26,  4.19it/s]
 29%|██▊       | 44/154 [00:10<00:25,  4.38it/s]
 29%|██▉       | 45/154 [00:10<00:25,  4.29it/s]
 30%|██▉       | 46/154 [00:10<00:24,  4.39it/s]
 31%|███       | 47/154 [00:10<00:24,  4.38it/s]
 31%|███       | 48/154 [00:11<00:24,  4.41it/s]
 32%|███▏      | 49/154 [00:11<00:23,  4.38it/s]
 32%|███▏      | 50/154 [00:11<00:24,  4.30it/s]
 33%|███▎      | 51/154 [00:11<00:23,  4.38it/s]
 34%|███▍      | 52/154 [00:12<00:23,  4.28it/s]
 34%|███▍      | 53/154 [00:12<00:23,  4.26it/s]
 35%|███▌      | 54/154 [00:12<00:22,  4.35it/s]
 36%|███▌      | 55/154 [00:12<00:23,  4.29it/s]
 36%|███▋      | 56/154 [00:13<00:23,  4.25it/s]
 37%|███▋      | 57/154 [00:13<00:22,  4.35it/s]
 38%|███▊      | 58/154 [00:13<00:22,  4.34it/s]
 38%|███▊      | 59/154 [00:13<00:21,  4.39it/s]
 39%|███▉      | 60/154 [00:13<00:22,  4.25it/s]
 40%|███▉      | 61/154 [00:14<00:21,  4.26it/s]
 40%|████      | 62/154 [00:14<00:21,  4.29it/s]
 41%|████      | 63/154 [00:14<00:21,  4.30it/s]
 42%|████▏     | 64/154 [00:14<00:20,  4.38it/s]
 42%|████▏     | 65/154 [00:15<00:21,  4.19it/s]
 43%|████▎     | 66/154 [00:15<00:21,  4.10it/s]
 44%|████▎     | 67/154 [00:15<00:21,  4.11it/s]
 44%|████▍     | 68/154 [00:15<00:20,  4.23it/s]
 45%|████▍     | 69/154 [00:16<00:19,  4.25it/s]
 45%|████▌     | 70/154 [00:16<00:19,  4.35it/s]
 46%|████▌     | 71/154 [00:16<00:19,  4.33it/s]
 47%|████▋     | 72/154 [00:16<00:19,  4.27it/s]
 47%|████▋     | 73/154 [00:16<00:18,  4.28it/s]
 48%|████▊     | 74/154 [00:17<00:18,  4.29it/s]
 49%|████▊     | 75/154 [00:17<00:18,  4.28it/s]
 49%|████▉     | 76/154 [00:17<00:18,  4.14it/s]
 50%|█████     | 77/154 [00:17<00:18,  4.26it/s]
 51%|█████     | 78/154 [00:18<00:18,  4.22it/s]
 51%|█████▏    | 79/154 [00:18<00:17,  4.28it/s]
 52%|█████▏    | 80/154 [00:18<00:17,  4.12it/s]
 53%|█████▎    | 81/154 [00:18<00:16,  4.31it/s]
 53%|█████▎    | 82/154 [00:19<00:16,  4.38it/s]
 54%|█████▍    | 83/154 [00:19<00:16,  4.23it/s]
 55%|█████▍    | 84/154 [00:19<00:16,  4.28it/s]
 55%|█████▌    | 85/154 [00:19<00:15,  4.44it/s]
 56%|█████▌    | 86/154 [00:20<00:15,  4.34it/s]
 56%|█████▋    | 87/154 [00:20<00:15,  4.34it/s]
 57%|█████▋    | 88/154 [00:20<00:15,  4.21it/s]
 58%|█████▊    | 89/154 [00:20<00:15,  4.22it/s]
 58%|█████▊    | 90/154 [00:20<00:14,  4.32it/s]
 59%|█████▉    | 91/154 [00:21<00:14,  4.32it/s]
 60%|█████▉    | 92/154 [00:21<00:15,  3.95it/s]
 60%|██████    | 93/154 [00:21<00:15,  3.99it/s]
 61%|██████    | 94/154 [00:22<00:15,  3.92it/s]
 62%|██████▏   | 95/154 [00:22<00:15,  3.92it/s]
 62%|██████▏   | 96/154 [00:22<00:14,  3.93it/s]
 63%|██████▎   | 97/154 [00:22<00:14,  4.00it/s]
 64%|██████▎   | 98/154 [00:22<00:13,  4.17it/s]
 64%|██████▍   | 99/154 [00:23<00:13,  4.11it/s]
 65%|██████▍   | 100/154 [00:23<00:13,  4.07it/s]
 66%|██████▌   | 101/154 [00:23<00:12,  4.16it/s]
 66%|██████▌   | 102/154 [00:23<00:12,  4.29it/s]
 67%|██████▋   | 103/154 [00:24<00:11,  4.28it/s]
 68%|██████▊   | 104/154 [00:24<00:11,  4.29it/s]
 68%|██████▊   | 105/154 [00:24<00:11,  4.30it/s]
 69%|██████▉   | 106/154 [00:24<00:10,  4.37it/s]
 69%|██████▉   | 107/154 [00:25<00:10,  4.32it/s]
 70%|███████   | 108/154 [00:25<00:10,  4.19it/s]
 71%|███████   | 109/154 [00:25<00:10,  4.30it/s]
 71%|███████▏  | 110/154 [00:25<00:10,  4.17it/s]
 72%|███████▏  | 111/154 [00:26<00:10,  4.26it/s]
 73%|███████▎  | 112/154 [00:26<00:09,  4.22it/s]
 73%|███████▎  | 113/154 [00:26<00:09,  4.26it/s]
 74%|███████▍  | 114/154 [00:26<00:09,  4.34it/s]
 75%|███████▍  | 115/154 [00:26<00:08,  4.35it/s]
 75%|███████▌  | 116/154 [00:27<00:08,  4.36it/s]
 76%|███████▌  | 117/154 [00:27<00:08,  4.40it/s]
 77%|███████▋  | 118/154 [00:27<00:08,  4.37it/s]
 77%|███████▋  | 119/154 [00:27<00:07,  4.43it/s]
 78%|███████▊  | 120/154 [00:28<00:07,  4.55it/s]
 79%|███████▊  | 121/154 [00:28<00:07,  4.54it/s]
 79%|███████▉  | 122/154 [00:28<00:07,  4.56it/s]
 80%|███████▉  | 123/154 [00:28<00:07,  4.35it/s]
 81%|████████  | 124/154 [00:28<00:06,  4.32it/s]
 81%|████████  | 125/154 [00:29<00:06,  4.40it/s]
 82%|████████▏ | 126/154 [00:29<00:06,  4.26it/s]
 82%|████████▏ | 127/154 [00:29<00:06,  4.28it/s]
 83%|████████▎ | 128/154 [00:29<00:06,  4.05it/s]
 84%|████████▍ | 129/154 [00:30<00:06,  4.14it/s]
 84%|████████▍ | 130/154 [00:30<00:05,  4.18it/s]
 85%|████████▌ | 131/154 [00:30<00:05,  4.22it/s]
 86%|████████▌ | 132/154 [00:30<00:05,  4.32it/s]
 86%|████████▋ | 133/154 [00:31<00:04,  4.26it/s]
 87%|████████▋ | 134/154 [00:31<00:04,  4.08it/s]
 88%|████████▊ | 135/154 [00:31<00:04,  4.16it/s]
 88%|████████▊ | 136/154 [00:31<00:04,  4.32it/s]
 89%|████████▉ | 137/154 [00:32<00:03,  4.37it/s]
 90%|████████▉ | 138/154 [00:32<00:03,  4.50it/s]
 90%|█████████ | 139/154 [00:32<00:03,  4.51it/s]
 91%|█████████ | 140/154 [00:32<00:03,  4.39it/s]
 92%|█████████▏| 141/154 [00:32<00:03,  4.32it/s]
 92%|█████████▏| 142/154 [00:33<00:02,  4.33it/s]
 93%|█████████▎| 143/154 [00:33<00:02,  4.34it/s]
 94%|█████████▎| 144/154 [00:33<00:02,  4.26it/s]
 94%|█████████▍| 145/154 [00:33<00:02,  4.42it/s]
 95%|█████████▍| 146/154 [00:34<00:01,  4.39it/s]
 95%|█████████▌| 147/154 [00:34<00:01,  4.26it/s]
 96%|█████████▌| 148/154 [00:34<00:01,  4.17it/s]
 97%|█████████▋| 149/154 [00:34<00:01,  4.31it/s]
 97%|█████████▋| 150/154 [00:35<00:00,  4.33it/s]
 98%|█████████▊| 151/154 [00:35<00:00,  4.21it/s]
 99%|█████████▊| 152/154 [00:35<00:00,  4.40it/s]
 99%|█████████▉| 153/154 [00:35<00:00,  4.27it/s]
100%|██████████| 154/154 [00:35<00:00,  4.29it/s]
2023-07-10 17:05:40,927 Computing features for evaluation...

  0%|          | 0/155 [00:00<?, ?it/s]/ceph/hpc/home/eujongc/anaconda3/envs/latentops/lib/python3.9/site-packages/torch/utils/data/dataloader.py:554: UserWarning: This DataLoader will create 4 worker processes in total. Our suggested max number of worker in current system is 2, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(_create_warning_msg(

  1%|          | 1/155 [00:00<00:56,  2.72it/s]
  1%|▏         | 2/155 [00:00<00:43,  3.55it/s]
  2%|▏         | 3/155 [00:00<00:38,  3.90it/s]
  3%|▎         | 4/155 [00:01<00:40,  3.71it/s]
  3%|▎         | 5/155 [00:01<00:39,  3.79it/s]
  4%|▍         | 6/155 [00:01<00:37,  4.02it/s]
  5%|▍         | 7/155 [00:01<00:36,  4.07it/s]
  5%|▌         | 8/155 [00:02<00:35,  4.17it/s]
  6%|▌         | 9/155 [00:02<00:34,  4.21it/s]
  6%|▋         | 10/155 [00:02<00:34,  4.26it/s]
  7%|▋         | 11/155 [00:02<00:34,  4.14it/s]
  8%|▊         | 12/155 [00:02<00:33,  4.22it/s]
  8%|▊         | 13/155 [00:03<00:34,  4.17it/s]
  9%|▉         | 14/155 [00:03<00:34,  4.10it/s]
 10%|▉         | 15/155 [00:03<00:34,  4.00it/s]
 10%|█         | 16/155 [00:03<00:32,  4.22it/s]
 11%|█         | 17/155 [00:04<00:33,  4.17it/s]
 12%|█▏        | 18/155 [00:04<00:33,  4.10it/s]
 12%|█▏        | 19/155 [00:04<00:32,  4.23it/s]
 13%|█▎        | 20/155 [00:04<00:32,  4.18it/s]
 14%|█▎        | 21/155 [00:05<00:31,  4.29it/s]
 14%|█▍        | 22/155 [00:05<00:30,  4.43it/s]
 15%|█▍        | 23/155 [00:05<00:30,  4.38it/s]
 15%|█▌        | 24/155 [00:05<00:30,  4.30it/s]
 16%|█▌        | 25/155 [00:06<00:29,  4.38it/s]
 17%|█▋        | 26/155 [00:06<00:30,  4.22it/s]
 17%|█▋        | 27/155 [00:06<00:30,  4.25it/s]
 18%|█▊        | 28/155 [00:06<00:29,  4.34it/s]
 19%|█▊        | 29/155 [00:07<00:29,  4.21it/s]
 19%|█▉        | 30/155 [00:07<00:30,  4.12it/s]
 20%|██        | 31/155 [00:07<00:30,  4.07it/s]
 21%|██        | 32/155 [00:07<00:29,  4.20it/s]
 21%|██▏       | 33/155 [00:07<00:28,  4.24it/s]
 22%|██▏       | 34/155 [00:08<00:28,  4.22it/s]
 23%|██▎       | 35/155 [00:08<00:28,  4.18it/s]
 23%|██▎       | 36/155 [00:08<00:28,  4.12it/s]
 24%|██▍       | 37/155 [00:08<00:29,  4.00it/s]
 25%|██▍       | 38/155 [00:09<00:28,  4.08it/s]
 25%|██▌       | 39/155 [00:09<00:27,  4.16it/s]
 26%|██▌       | 40/155 [00:09<00:26,  4.28it/s]
 26%|██▋       | 41/155 [00:09<00:27,  4.16it/s]
 27%|██▋       | 42/155 [00:10<00:26,  4.23it/s]
 28%|██▊       | 43/155 [00:10<00:26,  4.21it/s]
 28%|██▊       | 44/155 [00:10<00:26,  4.19it/s]
 29%|██▉       | 45/155 [00:10<00:25,  4.31it/s]
 30%|██▉       | 46/155 [00:11<00:26,  4.19it/s]
 30%|███       | 47/155 [00:11<00:25,  4.17it/s]
 31%|███       | 48/155 [00:11<00:25,  4.17it/s]
 32%|███▏      | 49/155 [00:11<00:24,  4.28it/s]
 32%|███▏      | 50/155 [00:12<00:25,  4.19it/s]
 33%|███▎      | 51/155 [00:12<00:24,  4.17it/s]
 34%|███▎      | 52/155 [00:12<00:25,  4.02it/s]
 34%|███▍      | 53/155 [00:12<00:24,  4.08it/s]
 35%|███▍      | 54/155 [00:13<00:23,  4.24it/s]
 35%|███▌      | 55/155 [00:13<00:23,  4.27it/s]
 36%|███▌      | 56/155 [00:13<00:23,  4.28it/s]
 37%|███▋      | 57/155 [00:13<00:23,  4.23it/s]
 37%|███▋      | 58/155 [00:13<00:23,  4.20it/s]
 38%|███▊      | 59/155 [00:14<00:22,  4.22it/s]
 39%|███▊      | 60/155 [00:14<00:21,  4.33it/s]
 39%|███▉      | 61/155 [00:14<00:23,  4.07it/s]
 40%|████      | 62/155 [00:14<00:22,  4.17it/s]
 41%|████      | 63/155 [00:15<00:21,  4.22it/s]
 41%|████▏     | 64/155 [00:15<00:21,  4.24it/s]
 42%|████▏     | 65/155 [00:15<00:20,  4.39it/s]
 43%|████▎     | 66/155 [00:15<00:20,  4.28it/s]
 43%|████▎     | 67/155 [00:16<00:20,  4.36it/s]
 44%|████▍     | 68/155 [00:16<00:19,  4.45it/s]
 45%|████▍     | 69/155 [00:16<00:19,  4.36it/s]
 45%|████▌     | 70/155 [00:16<00:19,  4.29it/s]
 46%|████▌     | 71/155 [00:16<00:19,  4.30it/s]
 46%|████▋     | 72/155 [00:17<00:20,  4.00it/s]
 47%|████▋     | 73/155 [00:17<00:21,  3.80it/s]
 48%|████▊     | 74/155 [00:17<00:20,  3.88it/s]
 48%|████▊     | 75/155 [00:18<00:19,  4.03it/s]
 49%|████▉     | 76/155 [00:18<00:19,  4.11it/s]
 50%|████▉     | 77/155 [00:18<00:18,  4.11it/s]
 50%|█████     | 78/155 [00:18<00:18,  4.12it/s]
 51%|█████     | 79/155 [00:18<00:17,  4.30it/s]
 52%|█████▏    | 80/155 [00:19<00:16,  4.45it/s]
 52%|█████▏    | 81/155 [00:19<00:17,  4.27it/s]
 53%|█████▎    | 82/155 [00:19<00:17,  4.29it/s]
 54%|█████▎    | 83/155 [00:19<00:17,  4.12it/s]
 54%|█████▍    | 84/155 [00:20<00:16,  4.24it/s]
 55%|█████▍    | 85/155 [00:20<00:16,  4.26it/s]
 55%|█████▌    | 86/155 [00:20<00:16,  4.29it/s]
 56%|█████▌    | 87/155 [00:20<00:15,  4.35it/s]
 57%|█████▋    | 88/155 [00:21<00:15,  4.42it/s]
 57%|█████▋    | 89/155 [00:21<00:14,  4.53it/s]
 58%|█████▊    | 90/155 [00:21<00:14,  4.48it/s]
 59%|█████▊    | 91/155 [00:21<00:14,  4.43it/s]
 59%|█████▉    | 92/155 [00:21<00:14,  4.47it/s]
 60%|██████    | 93/155 [00:22<00:13,  4.55it/s]
 61%|██████    | 94/155 [00:22<00:13,  4.53it/s]
 61%|██████▏   | 95/155 [00:22<00:13,  4.46it/s]
 62%|██████▏   | 96/155 [00:22<00:13,  4.36it/s]
 63%|██████▎   | 97/155 [00:23<00:13,  4.43it/s]
 63%|██████▎   | 98/155 [00:23<00:13,  4.35it/s]
 64%|██████▍   | 99/155 [00:23<00:12,  4.41it/s]
 65%|██████▍   | 100/155 [00:23<00:12,  4.31it/s]
 65%|██████▌   | 101/155 [00:23<00:12,  4.31it/s]
 66%|██████▌   | 102/155 [00:24<00:12,  4.32it/s]
 66%|██████▋   | 103/155 [00:24<00:12,  4.19it/s]
 67%|██████▋   | 104/155 [00:24<00:12,  4.23it/s]
 68%|██████▊   | 105/155 [00:24<00:11,  4.23it/s]
 68%|██████▊   | 106/155 [00:25<00:11,  4.21it/s]
 69%|██████▉   | 107/155 [00:25<00:11,  4.26it/s]
 70%|██████▉   | 108/155 [00:25<00:11,  4.22it/s]
 70%|███████   | 109/155 [00:25<00:10,  4.27it/s]
 71%|███████   | 110/155 [00:26<00:10,  4.28it/s]
 72%|███████▏  | 111/155 [00:26<00:09,  4.43it/s]
 72%|███████▏  | 112/155 [00:26<00:09,  4.34it/s]
 73%|███████▎  | 113/155 [00:26<00:09,  4.32it/s]
 74%|███████▎  | 114/155 [00:27<00:09,  4.14it/s]
 74%|███████▍  | 115/155 [00:27<00:09,  4.07it/s]
 75%|███████▍  | 116/155 [00:27<00:09,  4.20it/s]
 75%|███████▌  | 117/155 [00:27<00:09,  4.18it/s]
 76%|███████▌  | 118/155 [00:27<00:08,  4.36it/s]
 77%|███████▋  | 119/155 [00:28<00:08,  4.03it/s]
 77%|███████▋  | 120/155 [00:28<00:08,  4.12it/s]
 78%|███████▊  | 121/155 [00:28<00:08,  4.00it/s]
 79%|███████▊  | 122/155 [00:28<00:08,  4.10it/s]
 79%|███████▉  | 123/155 [00:29<00:07,  4.17it/s]
 80%|████████  | 124/155 [00:29<00:07,  4.08it/s]
 81%|████████  | 125/155 [00:29<00:07,  4.24it/s]
 81%|████████▏ | 126/155 [00:29<00:06,  4.25it/s]
 82%|████████▏ | 127/155 [00:30<00:06,  4.36it/s]
 83%|████████▎ | 128/155 [00:30<00:06,  4.23it/s]
 83%|████████▎ | 129/155 [00:30<00:06,  4.12it/s]
 84%|████████▍ | 130/155 [00:30<00:06,  4.06it/s]
 85%|████████▍ | 131/155 [00:31<00:06,  3.98it/s]
 85%|████████▌ | 132/155 [00:31<00:05,  4.15it/s]
 86%|████████▌ | 133/155 [00:31<00:05,  4.21it/s]
 86%|████████▋ | 134/155 [00:31<00:05,  4.13it/s]
 87%|████████▋ | 135/155 [00:32<00:04,  4.22it/s]
 88%|████████▊ | 136/155 [00:32<00:04,  4.30it/s]
 88%|████████▊ | 137/155 [00:32<00:04,  4.38it/s]
 89%|████████▉ | 138/155 [00:32<00:04,  4.25it/s]
 90%|████████▉ | 139/155 [00:33<00:03,  4.21it/s]
 90%|█████████ | 140/155 [00:33<00:03,  4.20it/s]
 91%|█████████ | 141/155 [00:33<00:03,  4.17it/s]
 92%|█████████▏| 142/155 [00:33<00:03,  4.29it/s]
 92%|█████████▏| 143/155 [00:33<00:02,  4.40it/s]
 93%|█████████▎| 144/155 [00:34<00:02,  4.18it/s]
 94%|█████████▎| 145/155 [00:34<00:02,  4.20it/s]
 94%|█████████▍| 146/155 [00:34<00:02,  4.31it/s]
 95%|█████████▍| 147/155 [00:34<00:01,  4.32it/s]
 95%|█████████▌| 148/155 [00:35<00:01,  4.41it/s]
 96%|█████████▌| 149/155 [00:35<00:01,  4.34it/s]
 97%|█████████▋| 150/155 [00:35<00:01,  4.39it/s]
 97%|█████████▋| 151/155 [00:35<00:00,  4.44it/s]
 98%|█████████▊| 152/155 [00:36<00:00,  4.52it/s]
 99%|█████████▊| 153/155 [00:36<00:00,  4.50it/s]
 99%|█████████▉| 154/155 [00:36<00:00,  4.18it/s]
100%|██████████| 155/155 [00:36<00:00,  4.23it/s]
+-------+------------------------+---------------------+-------------+-------------+-----------+----------+
| epoch |           lr           |      train_loss     | val_top1acc | val_top3acc | val_ndcg1 | val_mrr3 |
+-------+------------------------+---------------------+-------------+-------------+-----------+----------+
|   0   | 1.0000000000000023e-05 |  2.2853724935689868 |    43.42    |    76.27    |   67.87   |  57.81   |
|   1   |  9.99112027792722e-06  |  1.5891911364018136 |    52.55    |    82.72    |   74.75   |  66.10   |
|   2   | 9.964516155915175e-06  |  1.2577084753190586 |    58.79    |    87.16    |   78.59   |  71.44   |
|   3   | 9.920292628279128e-06  |  1.0084300179148344 |    61.43    |    88.79    |   80.23   |  73.58   |
|   4   | 9.858624225078883e-06  |  0.793933470176297  |    63.23    |    88.79    |   81.15   |  74.64   |
|   5   | 9.779754323328173e-06  |  0.6315311710126535 |    63.55    |    89.32    |   81.46   |  75.15   |
|   6   | 9.683994186497118e-06  |  0.5157908185600714 |    63.80    |    89.20    |   81.63   |  75.24   |
|   7   | 9.571721736097036e-06  | 0.40289456732408446 |    63.31    |    89.32    |   81.43   |  74.94   |
|   8   | 9.443380060197365e-06  | 0.33164142270666025 |    63.84    |    89.40    |   81.70   |  75.28   |
|   9   | 9.299475664759066e-06  |  0.2792239639924343 |    64.41    |    89.44    |   81.95   |  75.58   |
+-------+------------------------+---------------------+-------------+-------------+-----------+----------+
/ceph/hpc/home/eujongc/anaconda3/envs/latentops/lib/python3.9/site-packages/torch/utils/data/dataloader.py:554: UserWarning: This DataLoader will create 4 worker processes in total. Our suggested max number of worker in current system is 2, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(_create_warning_msg(
Train Epoch: [10]  [  0/229]  eta: 0:04:38  lr: 0.000009  loss: 0.2444  time: 1.2179  data: 0.0887  max mem: 30404
Train Epoch: [10]  [ 50/229]  eta: 0:03:28  lr: 0.000009  loss: 0.4755  time: 1.1653  data: 0.0001  max mem: 30404
Train Epoch: [10]  [100/229]  eta: 0:02:29  lr: 0.000009  loss: 0.0448  time: 1.1534  data: 0.0001  max mem: 30404
Train Epoch: [10]  [150/229]  eta: 0:01:30  lr: 0.000009  loss: 0.3250  time: 1.1071  data: 0.0001  max mem: 30404
Train Epoch: [10]  [200/229]  eta: 0:00:33  lr: 0.000009  loss: 0.1360  time: 1.1761  data: 0.0001  max mem: 30404
Train Epoch: [10]  [228/229]  eta: 0:00:01  lr: 0.000009  loss: 0.1340  time: 1.1267  data: 0.0001  max mem: 30404
2023-07-10 17:10:41,021 Train Epoch: [10] Total time: 0:04:22 (1.1484 s / it)
2023-07-10 17:10:41,024 Computing features for evaluation...

  0%|          | 0/154 [00:00<?, ?it/s]
  1%|          | 1/154 [00:00<00:51,  2.96it/s]
  1%|▏         | 2/154 [00:00<00:41,  3.69it/s]
  2%|▏         | 3/154 [00:00<00:38,  3.97it/s]
  3%|▎         | 4/154 [00:01<00:36,  4.15it/s]
  3%|▎         | 5/154 [00:01<00:36,  4.10it/s]
  4%|▍         | 6/154 [00:01<00:34,  4.25it/s]
  5%|▍         | 7/154 [00:01<00:32,  4.47it/s]
  5%|▌         | 8/154 [00:01<00:33,  4.36it/s]
  6%|▌         | 9/154 [00:02<00:33,  4.28it/s]
  6%|▋         | 10/154 [00:02<00:32,  4.38it/s]
  7%|▋         | 11/154 [00:02<00:33,  4.22it/s]
  8%|▊         | 12/154 [00:02<00:33,  4.20it/s]
  8%|▊         | 13/154 [00:03<00:33,  4.25it/s]
  9%|▉         | 14/154 [00:03<00:33,  4.20it/s]
 10%|▉         | 15/154 [00:03<00:32,  4.23it/s]
 10%|█         | 16/154 [00:03<00:31,  4.35it/s]
 11%|█         | 17/154 [00:04<00:31,  4.34it/s]
 12%|█▏        | 18/154 [00:04<00:31,  4.34it/s]
 12%|█▏        | 19/154 [00:04<00:32,  4.19it/s]
 13%|█▎        | 20/154 [00:04<00:32,  4.17it/s]
 14%|█▎        | 21/154 [00:04<00:30,  4.31it/s]
 14%|█▍        | 22/154 [00:05<00:29,  4.43it/s]
 15%|█▍        | 23/154 [00:05<00:29,  4.49it/s]
 16%|█▌        | 24/154 [00:05<00:29,  4.45it/s]
 16%|█▌        | 25/154 [00:05<00:29,  4.43it/s]
 17%|█▋        | 26/154 [00:06<00:29,  4.40it/s]
 18%|█▊        | 27/154 [00:06<00:28,  4.47it/s]
 18%|█▊        | 28/154 [00:06<00:28,  4.38it/s]
 19%|█▉        | 29/154 [00:06<00:28,  4.44it/s]
 19%|█▉        | 30/154 [00:06<00:27,  4.49it/s]
 20%|██        | 31/154 [00:07<00:27,  4.44it/s]
 21%|██        | 32/154 [00:07<00:27,  4.48it/s]
 21%|██▏       | 33/154 [00:07<00:27,  4.45it/s]
 22%|██▏       | 34/154 [00:07<00:27,  4.33it/s]
 23%|██▎       | 35/154 [00:08<00:27,  4.39it/s]
 23%|██▎       | 36/154 [00:08<00:26,  4.38it/s]
 24%|██▍       | 37/154 [00:08<00:26,  4.34it/s]
 25%|██▍       | 38/154 [00:08<00:26,  4.40it/s]
 25%|██▌       | 39/154 [00:09<00:25,  4.46it/s]
 26%|██▌       | 40/154 [00:09<00:25,  4.43it/s]
 27%|██▋       | 41/154 [00:09<00:26,  4.26it/s]
 27%|██▋       | 42/154 [00:09<00:26,  4.23it/s]
 28%|██▊       | 43/154 [00:09<00:26,  4.21it/s]
 29%|██▊       | 44/154 [00:10<00:24,  4.40it/s]
 29%|██▉       | 45/154 [00:10<00:25,  4.31it/s]
 30%|██▉       | 46/154 [00:10<00:24,  4.40it/s]
 31%|███       | 47/154 [00:10<00:24,  4.39it/s]
 31%|███       | 48/154 [00:11<00:23,  4.43it/s]
 32%|███▏      | 49/154 [00:11<00:23,  4.40it/s]
 32%|███▏      | 50/154 [00:11<00:24,  4.32it/s]
 33%|███▎      | 51/154 [00:11<00:23,  4.39it/s]
 34%|███▍      | 52/154 [00:12<00:23,  4.29it/s]
 34%|███▍      | 53/154 [00:12<00:23,  4.27it/s]
 35%|███▌      | 54/154 [00:12<00:22,  4.36it/s]
 36%|███▌      | 55/154 [00:12<00:23,  4.30it/s]
 36%|███▋      | 56/154 [00:12<00:23,  4.25it/s]
 37%|███▋      | 57/154 [00:13<00:22,  4.37it/s]
 38%|███▊      | 58/154 [00:13<00:22,  4.36it/s]
 38%|███▊      | 59/154 [00:13<00:21,  4.41it/s]
 39%|███▉      | 60/154 [00:13<00:22,  4.26it/s]
 40%|███▉      | 61/154 [00:14<00:21,  4.27it/s]
 40%|████      | 62/154 [00:14<00:21,  4.30it/s]
 41%|████      | 63/154 [00:14<00:21,  4.31it/s]
 42%|████▏     | 64/154 [00:14<00:20,  4.39it/s]
 42%|████▏     | 65/154 [00:15<00:21,  4.19it/s]
 43%|████▎     | 66/154 [00:15<00:21,  4.10it/s]
 44%|████▎     | 67/154 [00:15<00:21,  4.11it/s]
 44%|████▍     | 68/154 [00:15<00:20,  4.23it/s]
 45%|████▍     | 69/154 [00:16<00:19,  4.26it/s]
 45%|████▌     | 70/154 [00:16<00:19,  4.36it/s]
 46%|████▌     | 71/154 [00:16<00:19,  4.34it/s]
 47%|████▋     | 72/154 [00:16<00:19,  4.29it/s]
 47%|████▋     | 73/154 [00:16<00:18,  4.29it/s]
 48%|████▊     | 74/154 [00:17<00:18,  4.31it/s]
 49%|████▊     | 75/154 [00:17<00:18,  4.30it/s]
 49%|████▉     | 76/154 [00:17<00:18,  4.16it/s]
 50%|█████     | 77/154 [00:17<00:18,  4.27it/s]
 51%|█████     | 78/154 [00:18<00:17,  4.22it/s]
 51%|█████▏    | 79/154 [00:18<00:17,  4.29it/s]
 52%|█████▏    | 80/154 [00:18<00:17,  4.13it/s]
 53%|█████▎    | 81/154 [00:18<00:16,  4.31it/s]
 53%|█████▎    | 82/154 [00:19<00:16,  4.39it/s]
 54%|█████▍    | 83/154 [00:19<00:16,  4.24it/s]
 55%|█████▍    | 84/154 [00:19<00:16,  4.29it/s]
 55%|█████▌    | 85/154 [00:19<00:15,  4.45it/s]
 56%|█████▌    | 86/154 [00:19<00:15,  4.35it/s]
 56%|█████▋    | 87/154 [00:20<00:15,  4.33it/s]
 57%|█████▋    | 88/154 [00:20<00:15,  4.22it/s]
 58%|█████▊    | 89/154 [00:20<00:15,  4.23it/s]
 58%|█████▊    | 90/154 [00:20<00:14,  4.33it/s]
 59%|█████▉    | 91/154 [00:21<00:14,  4.34it/s]
 60%|█████▉    | 92/154 [00:21<00:15,  3.96it/s]
 60%|██████    | 93/154 [00:21<00:15,  4.00it/s]
 61%|██████    | 94/154 [00:21<00:15,  3.93it/s]
 62%|██████▏   | 95/154 [00:22<00:14,  3.93it/s]
 62%|██████▏   | 96/154 [00:22<00:14,  3.95it/s]
 63%|██████▎   | 97/154 [00:22<00:14,  4.01it/s]
 64%|██████▎   | 98/154 [00:22<00:13,  4.18it/s]
 64%|██████▍   | 99/154 [00:23<00:13,  4.13it/s]
 65%|██████▍   | 100/154 [00:23<00:13,  4.08it/s]
 66%|██████▌   | 101/154 [00:23<00:12,  4.17it/s]
 66%|██████▌   | 102/154 [00:23<00:12,  4.29it/s]
 67%|██████▋   | 103/154 [00:24<00:11,  4.29it/s]
 68%|██████▊   | 104/154 [00:24<00:11,  4.31it/s]
 68%|██████▊   | 105/154 [00:24<00:11,  4.31it/s]
 69%|██████▉   | 106/154 [00:24<00:10,  4.38it/s]
 69%|██████▉   | 107/154 [00:25<00:10,  4.32it/s]
 70%|███████   | 108/154 [00:25<00:10,  4.19it/s]
 71%|███████   | 109/154 [00:25<00:10,  4.31it/s]
 71%|███████▏  | 110/154 [00:25<00:10,  4.19it/s]
 72%|███████▏  | 111/154 [00:25<00:10,  4.28it/s]
 73%|███████▎  | 112/154 [00:26<00:09,  4.24it/s]
 73%|███████▎  | 113/154 [00:26<00:09,  4.27it/s]
 74%|███████▍  | 114/154 [00:26<00:09,  4.35it/s]
 75%|███████▍  | 115/154 [00:26<00:08,  4.36it/s]
 75%|███████▌  | 116/154 [00:27<00:08,  4.37it/s]
 76%|███████▌  | 117/154 [00:27<00:08,  4.41it/s]
 77%|███████▋  | 118/154 [00:27<00:08,  4.38it/s]
 77%|███████▋  | 119/154 [00:27<00:07,  4.44it/s]
 78%|███████▊  | 120/154 [00:27<00:07,  4.56it/s]
 79%|███████▊  | 121/154 [00:28<00:07,  4.55it/s]
 79%|███████▉  | 122/154 [00:28<00:07,  4.57it/s]
 80%|███████▉  | 123/154 [00:28<00:07,  4.36it/s]
 81%|████████  | 124/154 [00:28<00:06,  4.33it/s]
 81%|████████  | 125/154 [00:29<00:06,  4.41it/s]
 82%|████████▏ | 126/154 [00:29<00:06,  4.26it/s]
 82%|████████▏ | 127/154 [00:29<00:06,  4.29it/s]
 83%|████████▎ | 128/154 [00:29<00:06,  4.06it/s]
 84%|████████▍ | 129/154 [00:30<00:06,  4.14it/s]
 84%|████████▍ | 130/154 [00:30<00:05,  4.18it/s]
 85%|████████▌ | 131/154 [00:30<00:05,  4.22it/s]
 86%|████████▌ | 132/154 [00:30<00:05,  4.33it/s]
 86%|████████▋ | 133/154 [00:31<00:05,  3.56it/s]
 87%|████████▋ | 134/154 [00:31<00:05,  3.61it/s]
 88%|████████▊ | 135/154 [00:31<00:04,  3.81it/s]
 88%|████████▊ | 136/154 [00:31<00:04,  4.05it/s]
 89%|████████▉ | 137/154 [00:32<00:04,  4.17it/s]
 90%|████████▉ | 138/154 [00:32<00:03,  4.35it/s]
 90%|█████████ | 139/154 [00:32<00:03,  4.42it/s]
 91%|█████████ | 140/154 [00:32<00:03,  4.33it/s]
 92%|█████████▏| 141/154 [00:33<00:03,  4.28it/s]
 92%|█████████▏| 142/154 [00:33<00:02,  4.31it/s]
 93%|█████████▎| 143/154 [00:33<00:02,  4.33it/s]
 94%|█████████▎| 144/154 [00:33<00:02,  4.26it/s]
 94%|█████████▍| 145/154 [00:33<00:02,  4.42it/s]
 95%|█████████▍| 146/154 [00:34<00:01,  4.40it/s]
 95%|█████████▌| 147/154 [00:34<00:01,  4.26it/s]
 96%|█████████▌| 148/154 [00:34<00:01,  4.18it/s]
 97%|█████████▋| 149/154 [00:34<00:01,  4.32it/s]
 97%|█████████▋| 150/154 [00:35<00:00,  4.34it/s]
 98%|█████████▊| 151/154 [00:35<00:00,  4.23it/s]
 99%|█████████▊| 152/154 [00:35<00:00,  4.41it/s]
 99%|█████████▉| 153/154 [00:35<00:00,  4.28it/s]
100%|██████████| 154/154 [00:35<00:00,  4.28it/s]
2023-07-10 17:11:18,547 Computing features for evaluation...

  0%|          | 0/155 [00:00<?, ?it/s]/ceph/hpc/home/eujongc/anaconda3/envs/latentops/lib/python3.9/site-packages/torch/utils/data/dataloader.py:554: UserWarning: This DataLoader will create 4 worker processes in total. Our suggested max number of worker in current system is 2, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(_create_warning_msg(

  1%|          | 1/155 [00:00<00:55,  2.77it/s]
  1%|▏         | 2/155 [00:00<00:42,  3.59it/s]
  2%|▏         | 3/155 [00:00<00:38,  3.93it/s]
  3%|▎         | 4/155 [00:01<00:40,  3.73it/s]
  3%|▎         | 5/155 [00:01<00:39,  3.81it/s]
  4%|▍         | 6/155 [00:01<00:36,  4.04it/s]
  5%|▍         | 7/155 [00:01<00:36,  4.09it/s]
  5%|▌         | 8/155 [00:02<00:35,  4.18it/s]
  6%|▌         | 9/155 [00:02<00:34,  4.23it/s]
  6%|▋         | 10/155 [00:02<00:33,  4.27it/s]
  7%|▋         | 11/155 [00:02<00:34,  4.15it/s]
  8%|▊         | 12/155 [00:02<00:33,  4.22it/s]
  8%|▊         | 13/155 [00:03<00:34,  4.17it/s]
  9%|▉         | 14/155 [00:03<00:34,  4.11it/s]
 10%|▉         | 15/155 [00:03<00:34,  4.01it/s]
 10%|█         | 16/155 [00:03<00:32,  4.24it/s]
 11%|█         | 17/155 [00:04<00:32,  4.19it/s]
 12%|█▏        | 18/155 [00:04<00:33,  4.11it/s]
 12%|█▏        | 19/155 [00:04<00:32,  4.24it/s]
 13%|█▎        | 20/155 [00:04<00:32,  4.20it/s]
 14%|█▎        | 21/155 [00:05<00:31,  4.31it/s]
 14%|█▍        | 22/155 [00:05<00:29,  4.45it/s]
 15%|█▍        | 23/155 [00:05<00:29,  4.40it/s]
 15%|█▌        | 24/155 [00:05<00:30,  4.32it/s]
 16%|█▌        | 25/155 [00:06<00:29,  4.40it/s]
 17%|█▋        | 26/155 [00:06<00:30,  4.24it/s]
 17%|█▋        | 27/155 [00:06<00:29,  4.28it/s]
 18%|█▊        | 28/155 [00:06<00:29,  4.35it/s]
 19%|█▊        | 29/155 [00:06<00:29,  4.22it/s]
 19%|█▉        | 30/155 [00:07<00:30,  4.13it/s]
 20%|██        | 31/155 [00:07<00:30,  4.09it/s]
 21%|██        | 32/155 [00:07<00:29,  4.23it/s]
 21%|██▏       | 33/155 [00:07<00:28,  4.26it/s]
 22%|██▏       | 34/155 [00:08<00:28,  4.23it/s]
 23%|██▎       | 35/155 [00:08<00:28,  4.19it/s]
 23%|██▎       | 36/155 [00:08<00:28,  4.14it/s]
 24%|██▍       | 37/155 [00:08<00:29,  4.02it/s]
 25%|██▍       | 38/155 [00:09<00:28,  4.10it/s]
 25%|██▌       | 39/155 [00:09<00:27,  4.17it/s]
 26%|██▌       | 40/155 [00:09<00:26,  4.30it/s]
 26%|██▋       | 41/155 [00:09<00:27,  4.18it/s]
 27%|██▋       | 42/155 [00:10<00:26,  4.25it/s]
 28%|██▊       | 43/155 [00:10<00:26,  4.23it/s]
 28%|██▊       | 44/155 [00:10<00:26,  4.21it/s]
 29%|██▉       | 45/155 [00:10<00:25,  4.33it/s]
 30%|██▉       | 46/155 [00:11<00:25,  4.20it/s]
 30%|███       | 47/155 [00:11<00:25,  4.19it/s]
 31%|███       | 48/155 [00:11<00:25,  4.18it/s]
 32%|███▏      | 49/155 [00:11<00:24,  4.30it/s]
 32%|███▏      | 50/155 [00:11<00:24,  4.21it/s]
 33%|███▎      | 51/155 [00:12<00:24,  4.18it/s]
 34%|███▎      | 52/155 [00:12<00:25,  4.04it/s]
 34%|███▍      | 53/155 [00:12<00:24,  4.10it/s]
 35%|███▍      | 54/155 [00:12<00:23,  4.25it/s]
 35%|███▌      | 55/155 [00:13<00:23,  4.29it/s]
 36%|███▌      | 56/155 [00:13<00:23,  4.29it/s]
 37%|███▋      | 57/155 [00:13<00:23,  4.24it/s]
 37%|███▋      | 58/155 [00:13<00:23,  4.21it/s]
 38%|███▊      | 59/155 [00:14<00:22,  4.23it/s]
 39%|███▊      | 60/155 [00:14<00:21,  4.35it/s]
 39%|███▉      | 61/155 [00:14<00:22,  4.09it/s]
 40%|████      | 62/155 [00:14<00:22,  4.18it/s]
 41%|████      | 63/155 [00:15<00:21,  4.24it/s]
 41%|████▏     | 64/155 [00:15<00:21,  4.25it/s]
 42%|████▏     | 65/155 [00:15<00:20,  4.40it/s]
 43%|████▎     | 66/155 [00:15<00:20,  4.26it/s]
 43%|████▎     | 67/155 [00:15<00:20,  4.35it/s]
 44%|████▍     | 68/155 [00:16<00:19,  4.43it/s]
 45%|████▍     | 69/155 [00:16<00:19,  4.35it/s]
 45%|████▌     | 70/155 [00:16<00:19,  4.29it/s]
 46%|████▌     | 71/155 [00:16<00:19,  4.31it/s]
 46%|████▋     | 72/155 [00:17<00:20,  4.01it/s]
 47%|████▋     | 73/155 [00:17<00:21,  3.82it/s]
 48%|████▊     | 74/155 [00:17<00:20,  3.90it/s]
 48%|████▊     | 75/155 [00:17<00:19,  4.04it/s]
 49%|████▉     | 76/155 [00:18<00:19,  4.12it/s]
 50%|████▉     | 77/155 [00:18<00:18,  4.12it/s]
 50%|█████     | 78/155 [00:18<00:18,  4.14it/s]
 51%|█████     | 79/155 [00:18<00:17,  4.32it/s]
 52%|█████▏    | 80/155 [00:19<00:16,  4.47it/s]
 52%|█████▏    | 81/155 [00:19<00:17,  4.29it/s]
 53%|█████▎    | 82/155 [00:19<00:16,  4.31it/s]
 54%|█████▎    | 83/155 [00:19<00:17,  4.14it/s]
 54%|█████▍    | 84/155 [00:20<00:16,  4.25it/s]
 55%|█████▍    | 85/155 [00:20<00:16,  4.27it/s]
 55%|█████▌    | 86/155 [00:20<00:16,  4.31it/s]
 56%|█████▌    | 87/155 [00:20<00:15,  4.37it/s]
 57%|█████▋    | 88/155 [00:20<00:15,  4.44it/s]
 57%|█████▋    | 89/155 [00:21<00:14,  4.55it/s]
 58%|█████▊    | 90/155 [00:21<00:14,  4.50it/s]
 59%|█████▊    | 91/155 [00:21<00:14,  4.45it/s]
 59%|█████▉    | 92/155 [00:21<00:14,  4.50it/s]
 60%|██████    | 93/155 [00:22<00:13,  4.57it/s]
 61%|██████    | 94/155 [00:22<00:13,  4.54it/s]
 61%|██████▏   | 95/155 [00:22<00:13,  4.48it/s]
 62%|██████▏   | 96/155 [00:22<00:13,  4.37it/s]
 63%|██████▎   | 97/155 [00:22<00:13,  4.44it/s]
 63%|██████▎   | 98/155 [00:23<00:13,  4.35it/s]
 64%|██████▍   | 99/155 [00:23<00:12,  4.42it/s]
 65%|██████▍   | 100/155 [00:23<00:12,  4.31it/s]
 65%|██████▌   | 101/155 [00:23<00:12,  4.31it/s]
 66%|██████▌   | 102/155 [00:24<00:12,  4.32it/s]
 66%|██████▋   | 103/155 [00:24<00:12,  4.19it/s]
 67%|██████▋   | 104/155 [00:24<00:12,  4.22it/s]
 68%|██████▊   | 105/155 [00:24<00:11,  4.22it/s]
 68%|██████▊   | 106/155 [00:25<00:11,  4.20it/s]
 69%|██████▉   | 107/155 [00:25<00:11,  4.26it/s]
 70%|██████▉   | 108/155 [00:25<00:11,  4.21it/s]
 70%|███████   | 109/155 [00:25<00:10,  4.27it/s]
 71%|███████   | 110/155 [00:26<00:10,  4.28it/s]
 72%|███████▏  | 111/155 [00:26<00:09,  4.44it/s]
 72%|███████▏  | 112/155 [00:26<00:09,  4.35it/s]
 73%|███████▎  | 113/155 [00:26<00:09,  4.32it/s]
 74%|███████▎  | 114/155 [00:26<00:09,  4.14it/s]
 74%|███████▍  | 115/155 [00:27<00:09,  4.07it/s]
 75%|███████▍  | 116/155 [00:27<00:09,  4.21it/s]
 75%|███████▌  | 117/155 [00:27<00:09,  4.18it/s]
 76%|███████▌  | 118/155 [00:27<00:08,  4.36it/s]
 77%|███████▋  | 119/155 [00:28<00:08,  4.04it/s]
 77%|███████▋  | 120/155 [00:28<00:08,  4.12it/s]
 78%|███████▊  | 121/155 [00:28<00:08,  4.01it/s]
 79%|███████▊  | 122/155 [00:28<00:08,  4.11it/s]
 79%|███████▉  | 123/155 [00:29<00:07,  4.17it/s]
 80%|████████  | 124/155 [00:29<00:07,  4.08it/s]
 81%|████████  | 125/155 [00:29<00:07,  4.25it/s]
 81%|████████▏ | 126/155 [00:29<00:06,  4.25it/s]
 82%|████████▏ | 127/155 [00:30<00:06,  4.36it/s]
 83%|████████▎ | 128/155 [00:30<00:06,  4.22it/s]
 83%|████████▎ | 129/155 [00:30<00:06,  4.12it/s]
 84%|████████▍ | 130/155 [00:30<00:06,  4.06it/s]
 85%|████████▍ | 131/155 [00:31<00:06,  3.98it/s]
 85%|████████▌ | 132/155 [00:31<00:05,  4.15it/s]
 86%|████████▌ | 133/155 [00:31<00:05,  4.21it/s]
 86%|████████▋ | 134/155 [00:31<00:05,  4.12it/s]
 87%|████████▋ | 135/155 [00:32<00:04,  4.21it/s]
 88%|████████▊ | 136/155 [00:32<00:04,  4.29it/s]
 88%|████████▊ | 137/155 [00:32<00:04,  4.38it/s]
 89%|████████▉ | 138/155 [00:32<00:04,  4.25it/s]
 90%|████████▉ | 139/155 [00:32<00:03,  4.21it/s]
 90%|█████████ | 140/155 [00:33<00:03,  4.20it/s]
 91%|█████████ | 141/155 [00:33<00:03,  4.17it/s]
 92%|█████████▏| 142/155 [00:33<00:03,  4.30it/s]
 92%|█████████▏| 143/155 [00:33<00:02,  4.40it/s]
 93%|█████████▎| 144/155 [00:34<00:02,  4.18it/s]
 94%|█████████▎| 145/155 [00:34<00:02,  4.20it/s]
 94%|█████████▍| 146/155 [00:34<00:02,  4.31it/s]
 95%|█████████▍| 147/155 [00:34<00:01,  4.32it/s]
 95%|█████████▌| 148/155 [00:35<00:01,  4.41it/s]
 96%|█████████▌| 149/155 [00:35<00:01,  4.33it/s]
 97%|█████████▋| 150/155 [00:35<00:01,  4.39it/s]
 97%|█████████▋| 151/155 [00:35<00:00,  4.44it/s]
 98%|█████████▊| 152/155 [00:35<00:00,  4.51it/s]
 99%|█████████▊| 153/155 [00:36<00:00,  4.50it/s]
 99%|█████████▉| 154/155 [00:36<00:00,  4.18it/s]
100%|██████████| 155/155 [00:36<00:00,  4.24it/s]
+-------+------------------------+---------------------+-------------+-------------+-----------+----------+
| epoch |           lr           |      train_loss     | val_top1acc | val_top3acc | val_ndcg1 | val_mrr3 |
+-------+------------------------+---------------------+-------------+-------------+-----------+----------+
|   0   | 1.0000000000000023e-05 |  2.2853724935689868 |    43.42    |    76.27    |   67.87   |  57.81   |
|   1   |  9.99112027792722e-06  |  1.5891911364018136 |    52.55    |    82.72    |   74.75   |  66.10   |
|   2   | 9.964516155915175e-06  |  1.2577084753190586 |    58.79    |    87.16    |   78.59   |  71.44   |
|   3   | 9.920292628279128e-06  |  1.0084300179148344 |    61.43    |    88.79    |   80.23   |  73.58   |
|   4   | 9.858624225078883e-06  |  0.793933470176297  |    63.23    |    88.79    |   81.15   |  74.64   |
|   5   | 9.779754323328173e-06  |  0.6315311710126535 |    63.55    |    89.32    |   81.46   |  75.15   |
|   6   | 9.683994186497118e-06  |  0.5157908185600714 |    63.80    |    89.20    |   81.63   |  75.24   |
|   7   | 9.571721736097036e-06  | 0.40289456732408446 |    63.31    |    89.32    |   81.43   |  74.94   |
|   8   | 9.443380060197365e-06  | 0.33164142270666025 |    63.84    |    89.40    |   81.70   |  75.28   |
|   9   | 9.299475664759066e-06  |  0.2792239639924343 |    64.41    |    89.44    |   81.95   |  75.58   |
|   10  |  9.14057647468731e-06  | 0.22005202779017682 |    64.82    |    89.56    |   82.09   |  75.90   |
+-------+------------------------+---------------------+-------------+-------------+-----------+----------+
/ceph/hpc/home/eujongc/anaconda3/envs/latentops/lib/python3.9/site-packages/torch/utils/data/dataloader.py:554: UserWarning: This DataLoader will create 4 worker processes in total. Our suggested max number of worker in current system is 2, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(_create_warning_msg(
Train Epoch: [11]  [  0/229]  eta: 0:05:15  lr: 0.000009  loss: 0.1288  time: 1.3771  data: 0.0894  max mem: 30404
Train Epoch: [11]  [ 50/229]  eta: 0:03:27  lr: 0.000009  loss: 0.3364  time: 1.1244  data: 0.0001  max mem: 30404
Train Epoch: [11]  [100/229]  eta: 0:02:30  lr: 0.000009  loss: 0.1300  time: 1.1855  data: 0.0001  max mem: 30404
Train Epoch: [11]  [150/229]  eta: 0:01:31  lr: 0.000009  loss: 0.5164  time: 1.1493  data: 0.0001  max mem: 30404
Train Epoch: [11]  [200/229]  eta: 0:00:33  lr: 0.000009  loss: 0.3344  time: 1.1537  data: 0.0001  max mem: 30404
Train Epoch: [11]  [228/229]  eta: 0:00:01  lr: 0.000009  loss: 0.2718  time: 1.1257  data: 0.0001  max mem: 30404
2023-07-10 17:16:19,636 Train Epoch: [11] Total time: 0:04:24 (1.1530 s / it)
2023-07-10 17:16:19,640 Computing features for evaluation...

  0%|          | 0/154 [00:00<?, ?it/s]
  1%|          | 1/154 [00:00<00:51,  2.95it/s]
  1%|▏         | 2/154 [00:00<00:41,  3.69it/s]
  2%|▏         | 3/154 [00:00<00:38,  3.97it/s]
  3%|▎         | 4/154 [00:01<00:36,  4.14it/s]
  3%|▎         | 5/154 [00:01<00:36,  4.08it/s]
  4%|▍         | 6/154 [00:01<00:34,  4.23it/s]
  5%|▍         | 7/154 [00:01<00:33,  4.45it/s]
  5%|▌         | 8/154 [00:01<00:33,  4.35it/s]
  6%|▌         | 9/154 [00:02<00:33,  4.27it/s]
  6%|▋         | 10/154 [00:02<00:33,  4.36it/s]
  7%|▋         | 11/154 [00:02<00:34,  4.21it/s]
  8%|▊         | 12/154 [00:02<00:33,  4.18it/s]
  8%|▊         | 13/154 [00:03<00:33,  4.23it/s]
  9%|▉         | 14/154 [00:03<00:33,  4.19it/s]
 10%|▉         | 15/154 [00:03<00:32,  4.22it/s]
 10%|█         | 16/154 [00:03<00:31,  4.33it/s]
 11%|█         | 17/154 [00:04<00:31,  4.31it/s]
 12%|█▏        | 18/154 [00:04<00:31,  4.32it/s]
 12%|█▏        | 19/154 [00:04<00:32,  4.17it/s]
 13%|█▎        | 20/154 [00:04<00:32,  4.15it/s]
 14%|█▎        | 21/154 [00:04<00:31,  4.28it/s]
 14%|█▍        | 22/154 [00:05<00:29,  4.41it/s]
 15%|█▍        | 23/154 [00:05<00:29,  4.47it/s]
 16%|█▌        | 24/154 [00:05<00:29,  4.43it/s]
 16%|█▌        | 25/154 [00:05<00:29,  4.41it/s]
 17%|█▋        | 26/154 [00:06<00:29,  4.38it/s]
 18%|█▊        | 27/154 [00:06<00:28,  4.45it/s]
 18%|█▊        | 28/154 [00:06<00:28,  4.35it/s]
 19%|█▉        | 29/154 [00:06<00:28,  4.42it/s]
 19%|█▉        | 30/154 [00:07<00:27,  4.47it/s]
 20%|██        | 31/154 [00:07<00:27,  4.43it/s]
 21%|██        | 32/154 [00:07<00:27,  4.46it/s]
 21%|██▏       | 33/154 [00:07<00:27,  4.42it/s]
 22%|██▏       | 34/154 [00:07<00:27,  4.32it/s]
 23%|██▎       | 35/154 [00:08<00:27,  4.38it/s]
 23%|██▎       | 36/154 [00:08<00:27,  4.36it/s]
 24%|██▍       | 37/154 [00:08<00:27,  4.33it/s]
 25%|██▍       | 38/154 [00:08<00:26,  4.38it/s]
 25%|██▌       | 39/154 [00:09<00:25,  4.44it/s]
 26%|██▌       | 40/154 [00:09<00:25,  4.41it/s]
 27%|██▋       | 41/154 [00:09<00:26,  4.25it/s]
 27%|██▋       | 42/154 [00:09<00:26,  4.21it/s]
 28%|██▊       | 43/154 [00:10<00:26,  4.19it/s]
 29%|██▊       | 44/154 [00:10<00:25,  4.38it/s]
 29%|██▉       | 45/154 [00:10<00:25,  4.29it/s]
 30%|██▉       | 46/154 [00:10<00:24,  4.38it/s]
 31%|███       | 47/154 [00:10<00:24,  4.37it/s]
 31%|███       | 48/154 [00:11<00:24,  4.41it/s]
 32%|███▏      | 49/154 [00:11<00:23,  4.38it/s]
 32%|███▏      | 50/154 [00:11<00:24,  4.30it/s]
 33%|███▎      | 51/154 [00:11<00:23,  4.37it/s]
 34%|███▍      | 52/154 [00:12<00:23,  4.28it/s]
 34%|███▍      | 53/154 [00:12<00:23,  4.25it/s]
 35%|███▌      | 54/154 [00:12<00:23,  4.35it/s]
 36%|███▌      | 55/154 [00:12<00:23,  4.29it/s]
 36%|███▋      | 56/154 [00:13<00:23,  4.24it/s]
 37%|███▋      | 57/154 [00:13<00:22,  4.35it/s]
 38%|███▊      | 58/154 [00:13<00:22,  4.34it/s]
 38%|███▊      | 59/154 [00:13<00:21,  4.38it/s]
 39%|███▉      | 60/154 [00:13<00:22,  4.24it/s]
 40%|███▉      | 61/154 [00:14<00:21,  4.25it/s]
 40%|████      | 62/154 [00:14<00:21,  4.27it/s]
 41%|████      | 63/154 [00:14<00:21,  4.27it/s]
 42%|████▏     | 64/154 [00:14<00:20,  4.36it/s]
 42%|████▏     | 65/154 [00:15<00:21,  4.17it/s]
 43%|████▎     | 66/154 [00:15<00:21,  4.08it/s]
 44%|████▎     | 67/154 [00:15<00:21,  4.09it/s]
 44%|████▍     | 68/154 [00:15<00:20,  4.22it/s]
 45%|████▍     | 69/154 [00:16<00:20,  4.24it/s]
 45%|████▌     | 70/154 [00:16<00:19,  4.34it/s]
 46%|████▌     | 71/154 [00:16<00:19,  4.32it/s]
 47%|████▋     | 72/154 [00:16<00:19,  4.27it/s]
 47%|████▋     | 73/154 [00:17<00:18,  4.28it/s]
 48%|████▊     | 74/154 [00:17<00:18,  4.29it/s]
 49%|████▊     | 75/154 [00:17<00:18,  4.28it/s]
 49%|████▉     | 76/154 [00:17<00:18,  4.14it/s]
 50%|█████     | 77/154 [00:17<00:18,  4.25it/s]
 51%|█████     | 78/154 [00:18<00:18,  4.21it/s]
 51%|█████▏    | 79/154 [00:18<00:17,  4.28it/s]
 52%|█████▏    | 80/154 [00:18<00:17,  4.12it/s]
 53%|█████▎    | 81/154 [00:18<00:16,  4.30it/s]
 53%|█████▎    | 82/154 [00:19<00:16,  4.38it/s]
 54%|█████▍    | 83/154 [00:19<00:16,  4.22it/s]
 55%|█████▍    | 84/154 [00:19<00:16,  4.27it/s]
 55%|█████▌    | 85/154 [00:19<00:15,  4.43it/s]
 56%|█████▌    | 86/154 [00:20<00:15,  4.33it/s]
 56%|█████▋    | 87/154 [00:20<00:15,  4.33it/s]
 57%|█████▋    | 88/154 [00:20<00:15,  4.20it/s]
 58%|█████▊    | 89/154 [00:20<00:15,  4.21it/s]
 58%|█████▊    | 90/154 [00:20<00:14,  4.31it/s]
 59%|█████▉    | 91/154 [00:21<00:14,  4.32it/s]
 60%|█████▉    | 92/154 [00:21<00:15,  3.94it/s]
 60%|██████    | 93/154 [00:21<00:15,  3.98it/s]
 61%|██████    | 94/154 [00:22<00:15,  3.91it/s]
 62%|██████▏   | 95/154 [00:22<00:15,  3.92it/s]
 62%|██████▏   | 96/154 [00:22<00:14,  3.93it/s]
 63%|██████▎   | 97/154 [00:22<00:14,  4.00it/s]
 64%|██████▎   | 98/154 [00:23<00:13,  4.16it/s]
 64%|██████▍   | 99/154 [00:23<00:13,  4.11it/s]
 65%|██████▍   | 100/154 [00:23<00:13,  4.07it/s]
 66%|██████▌   | 101/154 [00:23<00:12,  4.15it/s]
 66%|██████▌   | 102/154 [00:23<00:12,  4.28it/s]
 67%|██████▋   | 103/154 [00:24<00:11,  4.28it/s]
 68%|██████▊   | 104/154 [00:24<00:11,  4.29it/s]
 68%|██████▊   | 105/154 [00:24<00:11,  4.29it/s]
 69%|██████▉   | 106/154 [00:24<00:11,  4.35it/s]
 69%|██████▉   | 107/154 [00:25<00:10,  4.31it/s]
 70%|███████   | 108/154 [00:25<00:11,  4.17it/s]
 71%|███████   | 109/154 [00:25<00:10,  4.29it/s]
 71%|███████▏  | 110/154 [00:25<00:10,  4.17it/s]
 72%|███████▏  | 111/154 [00:26<00:10,  4.26it/s]
 73%|███████▎  | 112/154 [00:26<00:09,  4.21it/s]
 73%|███████▎  | 113/154 [00:26<00:09,  4.25it/s]
 74%|███████▍  | 114/154 [00:26<00:09,  4.33it/s]
 75%|███████▍  | 115/154 [00:26<00:08,  4.34it/s]
 75%|███████▌  | 116/154 [00:27<00:08,  4.35it/s]
 76%|███████▌  | 117/154 [00:27<00:08,  4.39it/s]
 77%|███████▋  | 118/154 [00:27<00:08,  4.36it/s]
 77%|███████▋  | 119/154 [00:27<00:07,  4.42it/s]
 78%|███████▊  | 120/154 [00:28<00:07,  4.55it/s]
 79%|███████▊  | 121/154 [00:28<00:07,  4.54it/s]
 79%|███████▉  | 122/154 [00:28<00:07,  4.55it/s]
 80%|███████▉  | 123/154 [00:28<00:07,  4.34it/s]
 81%|████████  | 124/154 [00:29<00:06,  4.31it/s]
 81%|████████  | 125/154 [00:29<00:06,  4.39it/s]
 82%|████████▏ | 126/154 [00:29<00:06,  4.24it/s]
 82%|████████▏ | 127/154 [00:29<00:06,  4.27it/s]
 83%|████████▎ | 128/154 [00:30<00:06,  4.04it/s]
 84%|████████▍ | 129/154 [00:30<00:06,  4.13it/s]
 84%|████████▍ | 130/154 [00:30<00:05,  4.17it/s]
 85%|████████▌ | 131/154 [00:30<00:05,  4.21it/s]
 86%|████████▌ | 132/154 [00:30<00:05,  4.31it/s]
 86%|████████▋ | 133/154 [00:31<00:04,  4.25it/s]
 87%|████████▋ | 134/154 [00:31<00:04,  4.08it/s]
 88%|████████▊ | 135/154 [00:31<00:04,  4.16it/s]
 88%|████████▊ | 136/154 [00:31<00:04,  4.32it/s]
 89%|████████▉ | 137/154 [00:32<00:03,  4.36it/s]
 90%|████████▉ | 138/154 [00:32<00:03,  4.49it/s]
 90%|█████████ | 139/154 [00:32<00:03,  4.51it/s]
 91%|█████████ | 140/154 [00:32<00:03,  4.39it/s]
 92%|█████████▏| 141/154 [00:33<00:03,  4.32it/s]
 92%|█████████▏| 142/154 [00:33<00:02,  4.32it/s]
 93%|█████████▎| 143/154 [00:33<00:02,  4.33it/s]
 94%|█████████▎| 144/154 [00:33<00:02,  4.25it/s]
 94%|█████████▍| 145/154 [00:33<00:02,  4.41it/s]
 95%|█████████▍| 146/154 [00:34<00:01,  4.39it/s]
 95%|█████████▌| 147/154 [00:34<00:01,  4.25it/s]
 96%|█████████▌| 148/154 [00:34<00:01,  4.17it/s]
 97%|█████████▋| 149/154 [00:34<00:01,  4.31it/s]
 97%|█████████▋| 150/154 [00:35<00:00,  4.32it/s]
 98%|█████████▊| 151/154 [00:35<00:00,  4.21it/s]
 99%|█████████▊| 152/154 [00:35<00:00,  4.39it/s]
 99%|█████████▉| 153/154 [00:35<00:00,  4.26it/s]
100%|██████████| 154/154 [00:35<00:00,  4.28it/s]
+-------+------------------------+---------------------+-------------+-------------+-----------+----------+
| epoch |           lr           |      train_loss     | val_top1acc | val_top3acc | val_ndcg1 | val_mrr3 |
+-------+------------------------+---------------------+-------------+-------------+-----------+----------+
|   0   | 1.0000000000000023e-05 |  2.2853724935689868 |    43.42    |    76.27    |   67.87   |  57.81   |
|   1   |  9.99112027792722e-06  |  1.5891911364018136 |    52.55    |    82.72    |   74.75   |  66.10   |
|   2   | 9.964516155915175e-06  |  1.2577084753190586 |    58.79    |    87.16    |   78.59   |  71.44   |
|   3   | 9.920292628279128e-06  |  1.0084300179148344 |    61.43    |    88.79    |   80.23   |  73.58   |
|   4   | 9.858624225078883e-06  |  0.793933470176297  |    63.23    |    88.79    |   81.15   |  74.64   |
|   5   | 9.779754323328173e-06  |  0.6315311710126535 |    63.55    |    89.32    |   81.46   |  75.15   |
|   6   | 9.683994186497118e-06  |  0.5157908185600714 |    63.80    |    89.20    |   81.63   |  75.24   |
|   7   | 9.571721736097036e-06  | 0.40289456732408446 |    63.31    |    89.32    |   81.43   |  74.94   |
|   8   | 9.443380060197365e-06  | 0.33164142270666025 |    63.84    |    89.40    |   81.70   |  75.28   |
|   9   | 9.299475664759066e-06  |  0.2792239639924343 |    64.41    |    89.44    |   81.95   |  75.58   |
|   10  |  9.14057647468731e-06  | 0.22005202779017682 |    64.82    |    89.56    |   82.09   |  75.90   |
|   11  | 8.967309592491076e-06  | 0.19639288333110413 |    63.92    |    89.60    |   81.69   |  75.39   |
+-------+------------------------+---------------------+-------------+-------------+-----------+----------+
/ceph/hpc/home/eujongc/anaconda3/envs/latentops/lib/python3.9/site-packages/torch/utils/data/dataloader.py:554: UserWarning: This DataLoader will create 4 worker processes in total. Our suggested max number of worker in current system is 2, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(_create_warning_msg(
Train Epoch: [12]  [  0/229]  eta: 0:04:47  lr: 0.000009  loss: 0.1336  time: 1.2550  data: 0.0890  max mem: 30404
Train Epoch: [12]  [ 50/229]  eta: 0:03:23  lr: 0.000009  loss: 0.1300  time: 1.1452  data: 0.0001  max mem: 30404
Train Epoch: [12]  [100/229]  eta: 0:02:27  lr: 0.000009  loss: 0.2814  time: 1.1279  data: 0.0001  max mem: 30404
Train Epoch: [12]  [150/229]  eta: 0:01:30  lr: 0.000009  loss: 0.1644  time: 1.1400  data: 0.0001  max mem: 30404
Train Epoch: [12]  [200/229]  eta: 0:00:33  lr: 0.000009  loss: 0.2436  time: 1.1543  data: 0.0001  max mem: 30404
Train Epoch: [12]  [228/229]  eta: 0:00:01  lr: 0.000009  loss: 0.1341  time: 1.1784  data: 0.0001  max mem: 30404
2023-07-10 17:21:18,696 Train Epoch: [12] Total time: 0:04:22 (1.1470 s / it)
2023-07-10 17:21:18,700 Computing features for evaluation...

  0%|          | 0/154 [00:00<?, ?it/s]
  1%|          | 1/154 [00:00<00:52,  2.94it/s]
  1%|▏         | 2/154 [00:00<00:41,  3.69it/s]
  2%|▏         | 3/154 [00:00<00:38,  3.97it/s]
  3%|▎         | 4/154 [00:01<00:36,  4.15it/s]
  3%|▎         | 5/154 [00:01<00:36,  4.10it/s]
  4%|▍         | 6/154 [00:01<00:34,  4.25it/s]
  5%|▍         | 7/154 [00:01<00:32,  4.46it/s]
  5%|▌         | 8/154 [00:01<00:33,  4.36it/s]
  6%|▌         | 9/154 [00:02<00:33,  4.29it/s]
  6%|▋         | 10/154 [00:02<00:32,  4.39it/s]
  7%|▋         | 11/154 [00:02<00:33,  4.23it/s]
  8%|▊         | 12/154 [00:02<00:33,  4.21it/s]
  8%|▊         | 13/154 [00:03<00:33,  4.25it/s]
  9%|▉         | 14/154 [00:03<00:33,  4.21it/s]
 10%|▉         | 15/154 [00:03<00:32,  4.23it/s]
 10%|█         | 16/154 [00:03<00:31,  4.35it/s]
 11%|█         | 17/154 [00:04<00:31,  4.34it/s]
 12%|█▏        | 18/154 [00:04<00:31,  4.34it/s]
 12%|█▏        | 19/154 [00:04<00:32,  4.19it/s]
 13%|█▎        | 20/154 [00:04<00:32,  4.18it/s]
 14%|█▎        | 21/154 [00:04<00:30,  4.31it/s]
 14%|█▍        | 22/154 [00:05<00:29,  4.44it/s]
 15%|█▍        | 23/154 [00:05<00:29,  4.48it/s]
 16%|█▌        | 24/154 [00:05<00:29,  4.45it/s]
 16%|█▌        | 25/154 [00:05<00:29,  4.43it/s]
 17%|█▋        | 26/154 [00:06<00:29,  4.40it/s]
 18%|█▊        | 27/154 [00:06<00:28,  4.47it/s]
 18%|█▊        | 28/154 [00:06<00:28,  4.37it/s]
 19%|█▉        | 29/154 [00:06<00:28,  4.43it/s]
 19%|█▉        | 30/154 [00:06<00:27,  4.49it/s]
 20%|██        | 31/154 [00:07<00:27,  4.44it/s]
 21%|██        | 32/154 [00:07<00:27,  4.49it/s]
 21%|██▏       | 33/154 [00:07<00:27,  4.44it/s]
 22%|██▏       | 34/154 [00:07<00:27,  4.33it/s]
 23%|██▎       | 35/154 [00:08<00:27,  4.39it/s]
 23%|██▎       | 36/154 [00:08<00:26,  4.37it/s]
 24%|██▍       | 37/154 [00:08<00:26,  4.34it/s]
 25%|██▍       | 38/154 [00:08<00:26,  4.39it/s]
 25%|██▌       | 39/154 [00:09<00:25,  4.45it/s]
 26%|██▌       | 40/154 [00:09<00:25,  4.42it/s]
 27%|██▋       | 41/154 [00:09<00:26,  4.26it/s]
 27%|██▋       | 42/154 [00:09<00:26,  4.22it/s]
 28%|██▊       | 43/154 [00:09<00:26,  4.20it/s]
 29%|██▊       | 44/154 [00:10<00:25,  4.39it/s]
 29%|██▉       | 45/154 [00:10<00:25,  4.30it/s]
 30%|██▉       | 46/154 [00:10<00:24,  4.39it/s]
 31%|███       | 47/154 [00:10<00:24,  4.38it/s]
 31%|███       | 48/154 [00:11<00:23,  4.42it/s]
 32%|███▏      | 49/154 [00:11<00:23,  4.39it/s]
 32%|███▏      | 50/154 [00:11<00:24,  4.31it/s]
 33%|███▎      | 51/154 [00:11<00:23,  4.39it/s]
 34%|███▍      | 52/154 [00:12<00:23,  4.29it/s]
 34%|███▍      | 53/154 [00:12<00:23,  4.26it/s]
 35%|███▌      | 54/154 [00:12<00:22,  4.36it/s]
 36%|███▌      | 55/154 [00:12<00:23,  4.30it/s]
 36%|███▋      | 56/154 [00:12<00:23,  4.25it/s]
 37%|███▋      | 57/154 [00:13<00:22,  4.36it/s]
 38%|███▊      | 58/154 [00:13<00:22,  4.35it/s]
 38%|███▊      | 59/154 [00:13<00:21,  4.39it/s]
 39%|███▉      | 60/154 [00:13<00:22,  4.24it/s]
 40%|███▉      | 61/154 [00:14<00:21,  4.25it/s]
 40%|████      | 62/154 [00:14<00:21,  4.28it/s]
 41%|████      | 63/154 [00:14<00:21,  4.29it/s]
 42%|████▏     | 64/154 [00:14<00:20,  4.37it/s]
 42%|████▏     | 65/154 [00:15<00:21,  4.17it/s]
 43%|████▎     | 66/154 [00:15<00:21,  4.08it/s]
 44%|████▎     | 67/154 [00:15<00:21,  4.09it/s]
 44%|████▍     | 68/154 [00:15<00:20,  4.21it/s]
 45%|████▍     | 69/154 [00:16<00:20,  4.22it/s]
 45%|████▌     | 70/154 [00:16<00:19,  4.32it/s]
 46%|████▌     | 71/154 [00:16<00:19,  4.31it/s]
 47%|████▋     | 72/154 [00:16<00:19,  4.25it/s]
 47%|████▋     | 73/154 [00:16<00:19,  4.26it/s]
 48%|████▊     | 74/154 [00:17<00:18,  4.27it/s]
 49%|████▊     | 75/154 [00:17<00:18,  4.27it/s]
 49%|████▉     | 76/154 [00:17<00:18,  4.13it/s]
 50%|█████     | 77/154 [00:17<00:18,  4.24it/s]
 51%|█████     | 78/154 [00:18<00:18,  4.20it/s]
 51%|█████▏    | 79/154 [00:18<00:17,  4.27it/s]
 52%|█████▏    | 80/154 [00:18<00:17,  4.11it/s]
 53%|█████▎    | 81/154 [00:18<00:16,  4.29it/s]
 53%|█████▎    | 82/154 [00:19<00:16,  4.37it/s]
 54%|█████▍    | 83/154 [00:19<00:16,  4.21it/s]
 55%|█████▍    | 84/154 [00:19<00:16,  4.26it/s]
 55%|█████▌    | 85/154 [00:19<00:15,  4.42it/s]
 56%|█████▌    | 86/154 [00:20<00:15,  4.32it/s]
 56%|█████▋    | 87/154 [00:20<00:15,  4.32it/s]
 57%|█████▋    | 88/154 [00:20<00:15,  4.20it/s]
 58%|█████▊    | 89/154 [00:20<00:15,  4.20it/s]
 58%|█████▊    | 90/154 [00:20<00:14,  4.30it/s]
 59%|█████▉    | 91/154 [00:21<00:14,  4.31it/s]
 60%|█████▉    | 92/154 [00:21<00:15,  3.93it/s]
 60%|██████    | 93/154 [00:21<00:15,  3.97it/s]
 61%|██████    | 94/154 [00:22<00:15,  3.90it/s]
 62%|██████▏   | 95/154 [00:22<00:15,  3.91it/s]
 62%|██████▏   | 96/154 [00:22<00:14,  3.92it/s]
 63%|██████▎   | 97/154 [00:22<00:14,  3.98it/s]
 64%|██████▎   | 98/154 [00:22<00:13,  4.15it/s]
 64%|██████▍   | 99/154 [00:23<00:13,  4.09it/s]
 65%|██████▍   | 100/154 [00:23<00:13,  4.05it/s]
 66%|██████▌   | 101/154 [00:23<00:12,  4.14it/s]
 66%|██████▌   | 102/154 [00:23<00:12,  4.26it/s]
 67%|██████▋   | 103/154 [00:24<00:11,  4.26it/s]
 68%|██████▊   | 104/154 [00:24<00:11,  4.27it/s]
 68%|██████▊   | 105/154 [00:24<00:11,  4.28it/s]
 69%|██████▉   | 106/154 [00:24<00:11,  4.34it/s]
 69%|██████▉   | 107/154 [00:25<00:10,  4.30it/s]
 70%|███████   | 108/154 [00:25<00:11,  4.17it/s]
 71%|███████   | 109/154 [00:25<00:10,  4.29it/s]
 71%|███████▏  | 110/154 [00:25<00:10,  4.17it/s]
 72%|███████▏  | 111/154 [00:26<00:10,  4.26it/s]
 73%|███████▎  | 112/154 [00:26<00:09,  4.21it/s]
 73%|███████▎  | 113/154 [00:26<00:09,  4.24it/s]
 74%|███████▍  | 114/154 [00:26<00:09,  4.33it/s]
 75%|███████▍  | 115/154 [00:26<00:08,  4.34it/s]
 75%|███████▌  | 116/154 [00:27<00:08,  4.35it/s]
 76%|███████▌  | 117/154 [00:27<00:08,  4.40it/s]
 77%|███████▋  | 118/154 [00:27<00:08,  4.36it/s]
 77%|███████▋  | 119/154 [00:27<00:07,  4.42it/s]
 78%|███████▊  | 120/154 [00:28<00:07,  4.55it/s]
 79%|███████▊  | 121/154 [00:28<00:07,  4.54it/s]
 79%|███████▉  | 122/154 [00:28<00:07,  4.55it/s]
 80%|███████▉  | 123/154 [00:28<00:07,  4.34it/s]
 81%|████████  | 124/154 [00:29<00:06,  4.32it/s]
 81%|████████  | 125/154 [00:29<00:06,  4.40it/s]
 82%|████████▏ | 126/154 [00:29<00:06,  4.25it/s]
 82%|████████▏ | 127/154 [00:29<00:06,  4.28it/s]
 83%|████████▎ | 128/154 [00:29<00:06,  4.05it/s]
 84%|████████▍ | 129/154 [00:30<00:06,  4.14it/s]
 84%|████████▍ | 130/154 [00:30<00:05,  4.18it/s]
 85%|████████▌ | 131/154 [00:30<00:05,  4.22it/s]
 86%|████████▌ | 132/154 [00:30<00:05,  4.33it/s]
 86%|████████▋ | 133/154 [00:31<00:04,  4.26it/s]
 87%|████████▋ | 134/154 [00:31<00:04,  4.09it/s]
 88%|████████▊ | 135/154 [00:31<00:04,  4.17it/s]
 88%|████████▊ | 136/154 [00:31<00:04,  4.33it/s]
 89%|████████▉ | 137/154 [00:32<00:03,  4.37it/s]
 90%|████████▉ | 138/154 [00:32<00:03,  4.49it/s]
 90%|█████████ | 139/154 [00:32<00:03,  4.51it/s]
 91%|█████████ | 140/154 [00:32<00:03,  4.39it/s]
 92%|█████████▏| 141/154 [00:32<00:03,  4.32it/s]
 92%|█████████▏| 142/154 [00:33<00:02,  4.32it/s]
 93%|█████████▎| 143/154 [00:33<00:02,  4.34it/s]
 94%|█████████▎| 144/154 [00:33<00:02,  4.26it/s]
 94%|█████████▍| 145/154 [00:33<00:02,  4.42it/s]
 95%|█████████▍| 146/154 [00:34<00:01,  4.39it/s]
 95%|█████████▌| 147/154 [00:34<00:01,  4.26it/s]
 96%|█████████▌| 148/154 [00:34<00:01,  4.17it/s]
 97%|█████████▋| 149/154 [00:34<00:01,  4.31it/s]
 97%|█████████▋| 150/154 [00:35<00:00,  4.33it/s]
 98%|█████████▊| 151/154 [00:35<00:00,  4.21it/s]
 99%|█████████▊| 152/154 [00:35<00:00,  4.40it/s]
 99%|█████████▉| 153/154 [00:35<00:00,  4.27it/s]
100%|██████████| 154/154 [00:35<00:00,  4.29it/s]
+-------+------------------------+---------------------+-------------+-------------+-----------+----------+
| epoch |           lr           |      train_loss     | val_top1acc | val_top3acc | val_ndcg1 | val_mrr3 |
+-------+------------------------+---------------------+-------------+-------------+-----------+----------+
|   0   | 1.0000000000000023e-05 |  2.2853724935689868 |    43.42    |    76.27    |   67.87   |  57.81   |
|   1   |  9.99112027792722e-06  |  1.5891911364018136 |    52.55    |    82.72    |   74.75   |  66.10   |
|   2   | 9.964516155915175e-06  |  1.2577084753190586 |    58.79    |    87.16    |   78.59   |  71.44   |
|   3   | 9.920292628279128e-06  |  1.0084300179148344 |    61.43    |    88.79    |   80.23   |  73.58   |
|   4   | 9.858624225078883e-06  |  0.793933470176297  |    63.23    |    88.79    |   81.15   |  74.64   |
|   5   | 9.779754323328173e-06  |  0.6315311710126535 |    63.55    |    89.32    |   81.46   |  75.15   |
|   6   | 9.683994186497118e-06  |  0.5157908185600714 |    63.80    |    89.20    |   81.63   |  75.24   |
|   7   | 9.571721736097036e-06  | 0.40289456732408446 |    63.31    |    89.32    |   81.43   |  74.94   |
|   8   | 9.443380060197365e-06  | 0.33164142270666025 |    63.84    |    89.40    |   81.70   |  75.28   |
|   9   | 9.299475664759066e-06  |  0.2792239639924343 |    64.41    |    89.44    |   81.95   |  75.58   |
|   10  |  9.14057647468731e-06  | 0.22005202779017682 |    64.82    |    89.56    |   82.09   |  75.90   |
|   11  | 8.967309592491076e-06  | 0.19639288333110413 |    63.92    |    89.60    |   81.69   |  75.39   |
|   12  | 8.780358823396401e-06  | 0.17164708528358602 |    63.76    |    89.32    |   81.75   |  75.18   |
+-------+------------------------+---------------------+-------------+-------------+-----------+----------+
/ceph/hpc/home/eujongc/anaconda3/envs/latentops/lib/python3.9/site-packages/torch/utils/data/dataloader.py:554: UserWarning: This DataLoader will create 4 worker processes in total. Our suggested max number of worker in current system is 2, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(_create_warning_msg(
Train Epoch: [13]  [  0/229]  eta: 0:05:22  lr: 0.000009  loss: 0.1234  time: 1.4089  data: 0.0899  max mem: 30404
Train Epoch: [13]  [ 50/229]  eta: 0:03:25  lr: 0.000009  loss: 0.0594  time: 1.1163  data: 0.0001  max mem: 30455
Train Epoch: [13]  [100/229]  eta: 0:02:28  lr: 0.000009  loss: 0.0935  time: 1.1435  data: 0.0001  max mem: 30455
Train Epoch: [13]  [150/229]  eta: 0:01:30  lr: 0.000009  loss: 0.2327  time: 1.1532  data: 0.0001  max mem: 30455
Train Epoch: [13]  [200/229]  eta: 0:00:33  lr: 0.000009  loss: 0.1266  time: 1.1396  data: 0.0001  max mem: 30455
Train Epoch: [13]  [228/229]  eta: 0:00:01  lr: 0.000009  loss: 0.1550  time: 1.1420  data: 0.0001  max mem: 30455
2023-07-10 17:26:17,834 Train Epoch: [13] Total time: 0:04:22 (1.1473 s / it)
2023-07-10 17:26:17,837 Computing features for evaluation...

  0%|          | 0/154 [00:00<?, ?it/s]
  1%|          | 1/154 [00:00<00:51,  2.96it/s]
  1%|▏         | 2/154 [00:00<00:41,  3.71it/s]
  2%|▏         | 3/154 [00:00<00:37,  3.98it/s]
  3%|▎         | 4/154 [00:01<00:36,  4.15it/s]
  3%|▎         | 5/154 [00:01<00:36,  4.09it/s]
  4%|▍         | 6/154 [00:01<00:34,  4.24it/s]
  5%|▍         | 7/154 [00:01<00:32,  4.46it/s]
  5%|▌         | 8/154 [00:01<00:33,  4.36it/s]
  6%|▌         | 9/154 [00:02<00:33,  4.28it/s]
  6%|▋         | 10/154 [00:02<00:32,  4.38it/s]
  7%|▋         | 11/154 [00:02<00:33,  4.22it/s]
  8%|▊         | 12/154 [00:02<00:33,  4.20it/s]
  8%|▊         | 13/154 [00:03<00:33,  4.24it/s]
  9%|▉         | 14/154 [00:03<00:33,  4.20it/s]
 10%|▉         | 15/154 [00:03<00:32,  4.23it/s]
 10%|█         | 16/154 [00:03<00:31,  4.34it/s]
 11%|█         | 17/154 [00:04<00:31,  4.33it/s]
 12%|█▏        | 18/154 [00:04<00:31,  4.33it/s]
 12%|█▏        | 19/154 [00:04<00:32,  4.19it/s]
 13%|█▎        | 20/154 [00:04<00:32,  4.17it/s]
 14%|█▎        | 21/154 [00:04<00:30,  4.30it/s]
 14%|█▍        | 22/154 [00:05<00:29,  4.43it/s]
 15%|█▍        | 23/154 [00:05<00:29,  4.48it/s]
 16%|█▌        | 24/154 [00:05<00:29,  4.45it/s]
 16%|█▌        | 25/154 [00:05<00:29,  4.43it/s]
 17%|█▋        | 26/154 [00:06<00:29,  4.39it/s]
 18%|█▊        | 27/154 [00:06<00:28,  4.46it/s]
 18%|█▊        | 28/154 [00:06<00:28,  4.36it/s]
 19%|█▉        | 29/154 [00:06<00:28,  4.43it/s]
 19%|█▉        | 30/154 [00:06<00:27,  4.48it/s]
 20%|██        | 31/154 [00:07<00:27,  4.43it/s]
 21%|██        | 32/154 [00:07<00:27,  4.47it/s]
 21%|██▏       | 33/154 [00:07<00:27,  4.43it/s]
 22%|██▏       | 34/154 [00:07<00:27,  4.32it/s]
 23%|██▎       | 35/154 [00:08<00:27,  4.39it/s]
 23%|██▎       | 36/154 [00:08<00:26,  4.37it/s]
 24%|██▍       | 37/154 [00:08<00:26,  4.33it/s]
 25%|██▍       | 38/154 [00:08<00:26,  4.39it/s]
 25%|██▌       | 39/154 [00:09<00:25,  4.45it/s]
 26%|██▌       | 40/154 [00:09<00:25,  4.42it/s]
 27%|██▋       | 41/154 [00:09<00:26,  4.26it/s]
 27%|██▋       | 42/154 [00:09<00:26,  4.21it/s]
 28%|██▊       | 43/154 [00:10<00:26,  4.19it/s]
 29%|██▊       | 44/154 [00:10<00:25,  4.38it/s]
 29%|██▉       | 45/154 [00:10<00:25,  4.29it/s]
 30%|██▉       | 46/154 [00:10<00:24,  4.38it/s]
 31%|███       | 47/154 [00:10<00:24,  4.38it/s]
 31%|███       | 48/154 [00:11<00:24,  4.42it/s]
 32%|███▏      | 49/154 [00:11<00:23,  4.38it/s]
 32%|███▏      | 50/154 [00:11<00:24,  4.31it/s]
 33%|███▎      | 51/154 [00:11<00:23,  4.38it/s]
 34%|███▍      | 52/154 [00:12<00:23,  4.28it/s]
 34%|███▍      | 53/154 [00:12<00:23,  4.26it/s]
 35%|███▌      | 54/154 [00:12<00:22,  4.35it/s]
 36%|███▌      | 55/154 [00:12<00:23,  4.29it/s]
 36%|███▋      | 56/154 [00:13<00:23,  4.25it/s]
 37%|███▋      | 57/154 [00:13<00:22,  4.36it/s]
 38%|███▊      | 58/154 [00:13<00:22,  4.34it/s]
 38%|███▊      | 59/154 [00:13<00:21,  4.38it/s]
 39%|███▉      | 60/154 [00:13<00:22,  4.24it/s]
 40%|███▉      | 61/154 [00:14<00:21,  4.25it/s]
 40%|████      | 62/154 [00:14<00:21,  4.29it/s]
 41%|████      | 63/154 [00:14<00:21,  4.30it/s]
 42%|████▏     | 64/154 [00:14<00:20,  4.38it/s]
 42%|████▏     | 65/154 [00:15<00:21,  4.19it/s]
 43%|████▎     | 66/154 [00:15<00:21,  4.10it/s]
 44%|████▎     | 67/154 [00:15<00:21,  4.10it/s]
 44%|████▍     | 68/154 [00:15<00:20,  4.23it/s]
 45%|████▍     | 69/154 [00:16<00:19,  4.26it/s]
 45%|████▌     | 70/154 [00:16<00:19,  4.35it/s]
 46%|████▌     | 71/154 [00:16<00:19,  4.32it/s]
 47%|████▋     | 72/154 [00:16<00:19,  4.26it/s]
 47%|████▋     | 73/154 [00:16<00:18,  4.27it/s]
 48%|████▊     | 74/154 [00:17<00:18,  4.28it/s]
 49%|████▊     | 75/154 [00:17<00:18,  4.28it/s]
 49%|████▉     | 76/154 [00:17<00:18,  4.14it/s]
 50%|█████     | 77/154 [00:18<00:21,  3.55it/s]
 51%|█████     | 78/154 [00:18<00:20,  3.70it/s]
 51%|█████▏    | 79/154 [00:18<00:19,  3.90it/s]
 52%|█████▏    | 80/154 [00:18<00:19,  3.87it/s]
 53%|█████▎    | 81/154 [00:19<00:17,  4.11it/s]
 53%|█████▎    | 82/154 [00:19<00:16,  4.24it/s]
 54%|█████▍    | 83/154 [00:19<00:17,  4.14it/s]
 55%|█████▍    | 84/154 [00:19<00:16,  4.21it/s]
 55%|█████▌    | 85/154 [00:19<00:15,  4.38it/s]
 56%|█████▌    | 86/154 [00:20<00:15,  4.30it/s]
 56%|█████▋    | 87/154 [00:20<00:15,  4.31it/s]
 57%|█████▋    | 88/154 [00:20<00:15,  4.19it/s]
 58%|█████▊    | 89/154 [00:20<00:15,  4.20it/s]
 58%|█████▊    | 90/154 [00:21<00:14,  4.31it/s]
 59%|█████▉    | 91/154 [00:21<00:14,  4.32it/s]
 60%|█████▉    | 92/154 [00:21<00:15,  3.94it/s]
 60%|██████    | 93/154 [00:21<00:15,  3.98it/s]
 61%|██████    | 94/154 [00:22<00:15,  3.91it/s]
 62%|██████▏   | 95/154 [00:22<00:15,  3.92it/s]
 62%|██████▏   | 96/154 [00:22<00:14,  3.93it/s]
 63%|██████▎   | 97/154 [00:22<00:14,  4.00it/s]
 64%|██████▎   | 98/154 [00:23<00:13,  4.17it/s]
 64%|██████▍   | 99/154 [00:23<00:13,  4.11it/s]
 65%|██████▍   | 100/154 [00:23<00:13,  4.07it/s]
 66%|██████▌   | 101/154 [00:23<00:12,  4.16it/s]
 66%|██████▌   | 102/154 [00:24<00:12,  4.29it/s]
 67%|██████▋   | 103/154 [00:24<00:11,  4.29it/s]
 68%|██████▊   | 104/154 [00:24<00:11,  4.29it/s]
 68%|██████▊   | 105/154 [00:24<00:11,  4.29it/s]
 69%|██████▉   | 106/154 [00:24<00:11,  4.36it/s]
 69%|██████▉   | 107/154 [00:25<00:10,  4.32it/s]
 70%|███████   | 108/154 [00:25<00:11,  4.18it/s]
 71%|███████   | 109/154 [00:25<00:10,  4.30it/s]
 71%|███████▏  | 110/154 [00:25<00:10,  4.18it/s]
 72%|███████▏  | 111/154 [00:26<00:10,  4.27it/s]
 73%|███████▎  | 112/154 [00:26<00:09,  4.23it/s]
 73%|███████▎  | 113/154 [00:26<00:09,  4.26it/s]
 74%|███████▍  | 114/154 [00:26<00:09,  4.34it/s]
 75%|███████▍  | 115/154 [00:27<00:08,  4.34it/s]
 75%|███████▌  | 116/154 [00:27<00:08,  4.36it/s]
 76%|███████▌  | 117/154 [00:27<00:08,  4.41it/s]
 77%|███████▋  | 118/154 [00:27<00:08,  4.38it/s]
 77%|███████▋  | 119/154 [00:27<00:07,  4.43it/s]
 78%|███████▊  | 120/154 [00:28<00:07,  4.56it/s]
 79%|███████▊  | 121/154 [00:28<00:07,  4.55it/s]
 79%|███████▉  | 122/154 [00:28<00:07,  4.56it/s]
 80%|███████▉  | 123/154 [00:28<00:07,  4.34it/s]
 81%|████████  | 124/154 [00:29<00:06,  4.32it/s]
 81%|████████  | 125/154 [00:29<00:06,  4.40it/s]
 82%|████████▏ | 126/154 [00:29<00:06,  4.25it/s]
 82%|████████▏ | 127/154 [00:29<00:06,  4.28it/s]
 83%|████████▎ | 128/154 [00:30<00:06,  4.05it/s]
 84%|████████▍ | 129/154 [00:30<00:06,  4.14it/s]
 84%|████████▍ | 130/154 [00:30<00:05,  4.18it/s]
 85%|████████▌ | 131/154 [00:30<00:05,  4.22it/s]
 86%|████████▌ | 132/154 [00:31<00:05,  4.33it/s]
 86%|████████▋ | 133/154 [00:31<00:04,  4.27it/s]
 87%|████████▋ | 134/154 [00:31<00:04,  4.09it/s]
 88%|████████▊ | 135/154 [00:31<00:04,  4.17it/s]
 88%|████████▊ | 136/154 [00:31<00:04,  4.33it/s]
 89%|████████▉ | 137/154 [00:32<00:03,  4.38it/s]
 90%|████████▉ | 138/154 [00:32<00:03,  4.51it/s]
 90%|█████████ | 139/154 [00:32<00:03,  4.52it/s]
 91%|█████████ | 140/154 [00:32<00:03,  4.40it/s]
 92%|█████████▏| 141/154 [00:33<00:03,  4.33it/s]
 92%|█████████▏| 142/154 [00:33<00:02,  4.33it/s]
 93%|█████████▎| 143/154 [00:33<00:02,  4.34it/s]
 94%|█████████▎| 144/154 [00:33<00:02,  4.26it/s]
 94%|█████████▍| 145/154 [00:34<00:02,  4.42it/s]
 95%|█████████▍| 146/154 [00:34<00:01,  4.40it/s]
 95%|█████████▌| 147/154 [00:34<00:01,  4.26it/s]
 96%|█████████▌| 148/154 [00:34<00:01,  4.17it/s]
 97%|█████████▋| 149/154 [00:34<00:01,  4.31it/s]
 97%|█████████▋| 150/154 [00:35<00:00,  4.33it/s]
 98%|█████████▊| 151/154 [00:35<00:00,  4.21it/s]
 99%|█████████▊| 152/154 [00:35<00:00,  4.40it/s]
 99%|█████████▉| 153/154 [00:35<00:00,  4.27it/s]
100%|██████████| 154/154 [00:36<00:00,  4.27it/s]
2023-07-10 17:26:54,357 Early stopping at epoch 13
2023-07-10 17:26:54,357 Training time 1:16:17
+-------+------------------------+---------------------+-------------+-------------+-----------+----------+
| epoch |           lr           |      train_loss     | val_top1acc | val_top3acc | val_ndcg1 | val_mrr3 |
+-------+------------------------+---------------------+-------------+-------------+-----------+----------+
|   0   | 1.0000000000000023e-05 |  2.2853724935689868 |    43.42    |    76.27    |   67.87   |  57.81   |
|   1   |  9.99112027792722e-06  |  1.5891911364018136 |    52.55    |    82.72    |   74.75   |  66.10   |
|   2   | 9.964516155915175e-06  |  1.2577084753190586 |    58.79    |    87.16    |   78.59   |  71.44   |
|   3   | 9.920292628279128e-06  |  1.0084300179148344 |    61.43    |    88.79    |   80.23   |  73.58   |
|   4   | 9.858624225078883e-06  |  0.793933470176297  |    63.23    |    88.79    |   81.15   |  74.64   |
|   5   | 9.779754323328173e-06  |  0.6315311710126535 |    63.55    |    89.32    |   81.46   |  75.15   |
|   6   | 9.683994186497118e-06  |  0.5157908185600714 |    63.80    |    89.20    |   81.63   |  75.24   |
|   7   | 9.571721736097036e-06  | 0.40289456732408446 |    63.31    |    89.32    |   81.43   |  74.94   |
|   8   | 9.443380060197365e-06  | 0.33164142270666025 |    63.84    |    89.40    |   81.70   |  75.28   |
|   9   | 9.299475664759066e-06  |  0.2792239639924343 |    64.41    |    89.44    |   81.95   |  75.58   |
|   10  |  9.14057647468731e-06  | 0.22005202779017682 |    64.82    |    89.56    |   82.09   |  75.90   |
|   11  | 8.967309592491076e-06  | 0.19639288333110413 |    63.92    |    89.60    |   81.69   |  75.39   |
|   12  | 8.780358823396401e-06  | 0.17164708528358602 |    63.76    |    89.32    |   81.75   |  75.18   |
|   13  | 8.580461976679124e-06  |  0.1437009646675212 |    64.49    |    89.03    |   82.09   |  75.53   |
+-------+------------------------+---------------------+-------------+-------------+-----------+----------+
+-------+--------------+--------------+------------+-----------+
| epoch | test_top1acc | test_top3acc | test_ndcg1 | test_mrr3 |
+-------+--------------+--------------+------------+-----------+
|   0   |    42.04     |    75.82     |   67.75    |   56.99   |
|   1   |    52.86     |    84.73     |   75.44    |   66.91   |
|   2   |    59.34     |    87.36     |   79.13    |   71.70   |
|   3   |    62.37     |    88.90     |   81.14    |   74.29   |
|   4   |    62.17     |    89.10     |   81.13    |   74.17   |
|   6   |    63.63     |    88.70     |   81.62    |   74.81   |
|   8   |    63.63     |    89.15     |   81.77    |   75.04   |
|   9   |    63.63     |    88.58     |   81.88    |   74.85   |
|   10  |    63.63     |    89.79     |   82.03    |   75.44   |
+-------+--------------+--------------+------------+-----------+
